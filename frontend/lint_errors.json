[{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\AIAnalyticsDashboard.tsx","messages":[{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 20 to the 15 allowed.","line":102,"column":17,"nodeType":null,"messageId":"refactorFunction","endLine":102,"endColumn":37}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useState } from 'react';\nimport { useAuth } from '../hooks/AuthContext';\nimport {\n  TrendingUp,\n  Activity,\n  Brain,\n  Target,\n  Zap,\n  Eye,\n  Lightbulb,\n  ArrowUpRight,\n  ArrowDownRight,\n  BarChart3,\n  RefreshCw,\n  Download,\n  Users,\n  DollarSign,\n  Sprout,\n  Package,\n  Clock,\n  Wind,\n  Thermometer,\n  Gauge,\n  Trophy,\n  Shield,\n  Leaf,\n  Timer,\n  CloudRain,\n  CheckCircle,\n  MapPin,\n} from 'lucide-react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Badge } from './ui/badge';\n\ninterface ModuleOverviewObject {\n  health_status?: string;\n  total_animals?: number;\n  production_rate?: number;\n  active_crops?: number;\n  growth_stage?: string;\n  net_profit?: number;\n  revenue?: number;\n  expenses?: number;\n  tax_deductible_amount?: number;\n  avg_temperature?: number;\n  total_precipitation?: number;\n  avg_humidity?: number;\n}\n\ninterface ModuleOverviewArrayItem {\n  mature_crops?: number;\n}\n\ninterface ModulePerformance {\n  performance_score?: number;\n  overview?: ModuleOverviewObject | ModuleOverviewArrayItem[];\n  yield_performance?: Array<{\n    yield_efficiency?: number;\n  }>;\n}\n\ninterface Recommendation {\n  title?: string;\n  description?: string;\n  impact?: string;\n  suggestion?: string;\n}\n\ninterface ComprehensiveAnalytics {\n  summary: {\n    overall_score: number;\n    performance_trend: string;\n    efficiency_rating: number;\n    sustainability_score: number;\n  };\n  modules: {\n    animals: ModulePerformance;\n    crops: ModulePerformance;\n    fields: ModulePerformance;\n    inventory: ModulePerformance;\n    tasks: ModulePerformance;\n    finance: ModulePerformance;\n    weather: ModulePerformance;\n  };\n  insights: any[];\n  benchmarks: any;\n  recommendations: Recommendation[];\n  trends: any;\n}\n\ninterface PredictiveAnalytics {\n  yield_predictions: any;\n  demand_forecasting: any;\n  risk_assessment: any;\n  maintenance_predictions: any;\n  financial_projections: any;\n  weather_impact_analysis: any;\n}\n\nexport function AIAnalyticsDashboard() {\n  const { getAuthHeaders, isAuthenticated } = useAuth();\n  const queryClient = useQueryClient();\n  const [selectedFarm, setSelectedFarm] = useState<number>(1);\n  const [viewMode, setViewMode] = useState<\n    | 'comprehensive'\n    | 'predictive'\n    | 'optimization'\n    | 'trends'\n    | 'roi'\n    | 'efficiency'\n    | 'performance'\n    | 'predictions'\n    | 'recommendations'\n  >('comprehensive');\n  const [timeframe] = useState<'6months' | '12months' | '24months'>('12months');\n  const [autoRefresh, setAutoRefresh] = useState(true);\n\n  // Get comprehensive analytics\n  const {\n    data: comprehensiveData,\n    isLoading,\n    error,\n    refetch,\n  } = useQuery({\n    queryKey: ['analytics', 'comprehensive', selectedFarm, timeframe],\n    queryFn: async () => {\n      const response = await fetch(\n        `/api/analytics-engine?farm_id=${selectedFarm}&type=comprehensive&timeframe=${timeframe}`,\n        {\n          method: 'GET',\n          headers: getAuthHeaders(),\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch comprehensive analytics');\n      }\n\n      return response.json() as Promise<ComprehensiveAnalytics>;\n    },\n    enabled: isAuthenticated(),\n    refetchInterval: autoRefresh ? 60000 : false, // Auto-refresh every minute\n  });\n\n  // Get predictive analytics\n  const { data: predictiveData } = useQuery({\n    queryKey: ['analytics', 'predictive', selectedFarm],\n    queryFn: async () => {\n      const response = await fetch(\n        `/api/analytics-engine?farm_id=${selectedFarm}&type=predictive`,\n        {\n          method: 'GET',\n          headers: getAuthHeaders(),\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch predictive analytics');\n      }\n\n      return response.json() as Promise<PredictiveAnalytics>;\n    },\n    enabled: isAuthenticated() && viewMode === 'predictive',\n  });\n\n  // Get optimization recommendations\n  const { data: optimizationData } = useQuery({\n    queryKey: ['analytics', 'optimization', selectedFarm],\n    queryFn: async () => {\n      const response = await fetch(\n        `/api/analytics-engine?farm_id=${selectedFarm}&type=optimization`,\n        {\n          method: 'GET',\n          headers: getAuthHeaders(),\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch optimization data');\n      }\n\n      return response.json();\n    },\n    enabled: isAuthenticated() && viewMode === 'optimization',\n  });\n\n  const generateReportMutation = useMutation({\n    mutationFn: async (reportType: string) => {\n      const response = await fetch('/api/analytics-engine', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          farm_id: selectedFarm,\n          analysis_type: reportType,\n          parameters: { timeframe },\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to generate ${reportType} report`);\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['analytics'] });\n    },\n  });\n\n  if (!isAuthenticated()) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Please log in</h2>\n          <p className=\"text-gray-600\">You need to be logged in to access analytics.</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (isLoading)\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading AI analytics...</p>\n          <p className=\"text-sm text-gray-500\">Analyzing farm data and generating insights</p>\n        </div>\n      </div>\n    );\n\n  if (error)\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-red-600 mb-4\">Error loading analytics</h2>\n          <p className=\"text-gray-600\">{error.message}</p>\n          <Button onClick={() => refetch()} className=\"mt-4\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Retry\n          </Button>\n        </div>\n      </div>\n    );\n\n  const getScoreColor = (score: number) => {\n    if (score >= 80) return 'text-green-600';\n    if (score >= 60) return 'text-yellow-600';\n    return 'text-red-600';\n  };\n\n  const getScoreGradient = (score: number) => {\n    if (score >= 80) return 'from-green-500 to-emerald-500';\n    if (score >= 60) return 'from-yellow-500 to-orange-500';\n    return 'from-red-500 to-pink-500';\n  };\n\n  const getTrendIcon = (trend: string) => {\n    if (trend === 'up' || trend === 'improving')\n      return <ArrowUpRight className=\"h-4 w-4 text-green-500\" />;\n    if (trend === 'down' || trend === 'declining')\n      return <ArrowDownRight className=\"h-4 w-4 text-red-500\" />;\n    return <Activity className=\"h-4 w-4 text-blue-500\" />;\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg flex items-center justify-center\">\n                <Brain className=\"h-6 w-6 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-3xl font-bold text-gray-900\">AI Analytics Dashboard</h1>\n                <p className=\"text-gray-600 mt-1\">\n                  Advanced insights and optimization powered by machine learning\n                </p>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-4 mt-3\">\n              <Badge className=\"bg-gradient-to-r from-purple-100 to-blue-100 text-purple-800 border-purple-200\">\n                ≡ƒñû AI-Powered\n              </Badge>\n              <Badge className=\"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 border-green-200\">\n                ≡ƒôè Real-time\n              </Badge>\n              <div className=\"flex items-center gap-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => setAutoRefresh(!autoRefresh)}\n                  className={autoRefresh ? 'bg-green-50 border-green-200' : ''}\n                >\n                  {autoRefresh ? (\n                    <Timer className=\"h-3 w-3 mr-1\" />\n                  ) : (\n                    <Clock className=\"h-3 w-3 mr-1\" />\n                  )}\n                  {autoRefresh ? 'Live Mode' : 'Manual'}\n                </Button>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <select\n              value={selectedFarm}\n              onChange={e => setSelectedFarm(parseInt(e.target.value))}\n              className=\"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500\"\n            >\n              <option value={1}>Main Farm</option>\n            </select>\n            <Button variant=\"outline\" onClick={() => refetch()}>\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\n              Refresh\n            </Button>\n          </div>\n        </div>\n\n        {/* Navigation Tabs */}\n        <div className=\"bg-white/80 backdrop-blur-sm border-b mb-8 rounded-lg shadow-sm\">\n          <nav className=\"-mb-px flex space-x-8 px-6\">\n            {[\n              {\n                key: 'comprehensive',\n                label: 'Comprehensive',\n                icon: BarChart3,\n                description: 'Overall performance',\n              },\n              {\n                key: 'predictive',\n                label: 'Predictive',\n                icon: Brain,\n                description: 'AI predictions',\n              },\n              {\n                key: 'optimization',\n                label: 'Optimization',\n                icon: Target,\n                description: 'Improvement suggestions',\n              },\n              {\n                key: 'trends',\n                label: 'Trends',\n                icon: TrendingUp,\n                description: 'Historical patterns',\n              },\n              {\n                key: 'roi',\n                label: 'ROI Analysis',\n                icon: DollarSign,\n                description: 'Return on investment',\n              },\n              {\n                key: 'efficiency',\n                label: 'Efficiency',\n                icon: Zap,\n                description: 'Operational efficiency',\n              },\n            ].map(({ key, label, icon: Icon, description }) => (\n              <button\n                key={key}\n                onClick={() =>\n                  setViewMode(\n                    key as\n                      | 'comprehensive'\n                      | 'performance'\n                      | 'efficiency'\n                      | 'predictions'\n                      | 'recommendations'\n                      | 'predictive'\n                      | 'optimization'\n                      | 'trends'\n                      | 'roi'\n                  )\n                }\n                className={`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${\n                  viewMode === key\n                    ? 'border-purple-500 text-purple-600'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                }`}\n              >\n                <Icon className=\"h-4 w-4\" />\n                <div className=\"text-left\">\n                  <div>{label}</div>\n                  <div className=\"text-xs text-gray-400\">{description}</div>\n                </div>\n              </button>\n            ))}\n          </nav>\n        </div>\n\n        {/* Comprehensive Analytics Tab */}\n        {viewMode === 'comprehensive' && comprehensiveData && (\n          <div className=\"space-y-8\">\n            {/* Performance Overview */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-blue-50\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-sm font-medium text-gray-600\">\n                      Overall Score\n                    </CardTitle>\n                    <Trophy className=\"h-4 w-4 text-yellow-500\" />\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div\n                    className={`text-3xl font-bold ${getScoreColor(comprehensiveData.summary.overall_score)}`}\n                  >\n                    {comprehensiveData.summary.overall_score}/100\n                  </div>\n                  <div className=\"flex items-center gap-1 mt-2\">\n                    {getTrendIcon(comprehensiveData.summary.performance_trend)}\n                    <span className=\"text-sm text-gray-600\">\n                      {comprehensiveData.summary.performance_trend}\n                    </span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 rounded-full h-2 mt-3\">\n                    <div\n                      className={`bg-gradient-to-r ${getScoreGradient(comprehensiveData.summary.overall_score)} h-2 rounded-full transition-all duration-500`}\n                      style={{ width: `${comprehensiveData.summary.overall_score}%` }}\n                    ></div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-green-50\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-sm font-medium text-gray-600\">\n                      Efficiency Rating\n                    </CardTitle>\n                    <Zap className=\"h-4 w-4 text-green-500\" />\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div\n                    className={`text-3xl font-bold ${getScoreColor(comprehensiveData.summary.efficiency_rating)}`}\n                  >\n                    {comprehensiveData.summary.efficiency_rating}/100\n                  </div>\n                  <div className=\"flex items-center gap-1 mt-2\">\n                    <Activity className=\"h-4 w-4 text-blue-500\" />\n                    <span className=\"text-sm text-gray-600\">High performance</span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 rounded-full h-2 mt-3\">\n                    <div\n                      className={`bg-gradient-to-r ${getScoreGradient(comprehensiveData.summary.efficiency_rating)} h-2 rounded-full transition-all duration-500`}\n                      style={{ width: `${comprehensiveData.summary.efficiency_rating}%` }}\n                    ></div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-purple-50\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-sm font-medium text-gray-600\">\n                      Sustainability\n                    </CardTitle>\n                    <Leaf className=\"h-4 w-4 text-green-600\" />\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div\n                    className={`text-3xl font-bold ${getScoreColor(comprehensiveData.summary.sustainability_score)}`}\n                  >\n                    {comprehensiveData.summary.sustainability_score}/100\n                  </div>\n                  <div className=\"flex items-center gap-1 mt-2\">\n                    <Shield className=\"h-4 w-4 text-green-500\" />\n                    <span className=\"text-sm text-gray-600\">Eco-friendly</span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 rounded-full h-2 mt-3\">\n                    <div\n                      className={`bg-gradient-to-r ${getScoreGradient(comprehensiveData.summary.sustainability_score)} h-2 rounded-full transition-all duration-500`}\n                      style={{ width: `${comprehensiveData.summary.sustainability_score}%` }}\n                    ></div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-orange-50\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-sm font-medium text-gray-600\">AI Insights</CardTitle>\n                    <Lightbulb className=\"h-4 w-4 text-yellow-500\" />\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold text-purple-600\">\n                    {comprehensiveData.recommendations?.length || 0}\n                  </div>\n                  <div className=\"flex items-center gap-1 mt-2\">\n                    <Brain className=\"h-4 w-4 text-purple-500\" />\n                    <span className=\"text-sm text-gray-600\">Active recommendations</span>\n                  </div>\n                  <div className=\"mt-3\">\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      ≡ƒñû Generated by AI\n                    </Badge>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Module Performance Breakdown */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {/* Animals Performance */}\n              {comprehensiveData.modules.animals && (\n                <Card className=\"border-0 shadow-lg\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <Users className=\"h-5 w-5 text-blue-500\" />\n                      Animal Management\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-4\">\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Performance Score</span>\n                        <span className=\"font-medium\">\n                          {(comprehensiveData.modules.animals as ModulePerformance)\n                            .performance_score || 0}\n                          /100\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Health Status</span>\n                        <span className=\"font-medium\">\n                          {(\n                            (comprehensiveData.modules.animals as ModulePerformance)\n                              .overview as ModuleOverviewObject\n                          )?.health_status || 'Unknown'}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Total Animals</span>\n                        <span className=\"font-medium\">\n                          {(\n                            (comprehensiveData.modules.animals as ModulePerformance)\n                              .overview as ModuleOverviewObject\n                          )?.total_animals || 0}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Production Rate</span>\n                        <span className=\"font-medium\">\n                          {(\n                            (comprehensiveData.modules.animals as ModulePerformance)\n                              .overview as ModuleOverviewObject\n                          )?.production_rate || 0}\n                          %\n                        </span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Crop Performance */}\n              {comprehensiveData.modules.crops && (\n                <Card className=\"border-0 shadow-lg\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <Sprout className=\"h-5 w-5 text-green-500\" />\n                      Crop Management\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-4\">\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Growth Score</span>\n                        <span\n                          className={`font-bold ${getScoreColor((comprehensiveData.modules.crops as ModulePerformance).performance_score || 0)}`}\n                        >\n                          {(comprehensiveData.modules.crops as ModulePerformance)\n                            .performance_score || 0}\n                          /100\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Mature Crops</span>\n                        <span className=\"font-medium\">\n                          {(\n                            (comprehensiveData.modules.crops as ModulePerformance)\n                              .overview as ModuleOverviewArrayItem[]\n                          )?.reduce(\n                            (sum: number, c: { mature_crops?: number }) =>\n                              sum + (c.mature_crops || 0),\n                            0\n                          ) || 0}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Yield Efficiency</span>\n                        <span className=\"font-medium\">\n                          {Math.round(\n                            ((\n                              comprehensiveData.modules.crops as ModulePerformance\n                            ).yield_performance?.reduce(\n                              (sum: number, y: { yield_efficiency?: number }) =>\n                                sum + (y.yield_efficiency || 0),\n                              0\n                            ) || 0) /\n                              ((comprehensiveData.modules.crops as ModulePerformance)\n                                .yield_performance?.length || 1)\n                          ) || 0}\n                          %\n                        </span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Financial Performance */}\n              {comprehensiveData.modules.finance && (\n                <Card className=\"border-0 shadow-lg\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <DollarSign className=\"h-5 w-5 text-green-600\" />\n                      Financial Health\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-4\">\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Profitability</span>\n                        <span\n                          className={`font-bold ${getScoreColor((comprehensiveData.modules.finance as ModulePerformance).performance_score || 0)}`}\n                        >\n                          {(comprehensiveData.modules.finance as ModulePerformance)\n                            .performance_score || 0}\n                          /100\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Net Profit</span>\n                        <span\n                          className={`font-medium ${\n                            ((\n                              (comprehensiveData.modules.finance as ModulePerformance)\n                                .overview as ModuleOverviewObject\n                            )?.net_profit || 0) >= 0\n                              ? 'text-green-600'\n                              : 'text-red-600'\n                          }`}\n                        >\n                          $\n                          {(\n                            (\n                              (comprehensiveData.modules.finance as ModulePerformance)\n                                .overview as ModuleOverviewObject\n                            )?.net_profit || 0\n                          ).toLocaleString()}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm text-gray-600\">Tax Deductions</span>\n                        <span className=\"font-medium\">\n                          $\n                          {(\n                            (\n                              (comprehensiveData.modules.finance as ModulePerformance)\n                                .overview as ModuleOverviewObject\n                            )?.tax_deductible_amount || 0\n                          ).toLocaleString()}\n                        </span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n            </div>\n\n            {/* AI Recommendations */}\n            <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-purple-50\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Brain className=\"h-5 w-5 text-purple-500\" />\n                  AI Recommendations & Insights\n                </CardTitle>\n                <CardDescription>\n                  Machine learning-powered suggestions to optimize your farm operations\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  {comprehensiveData.recommendations?.map((rec: Recommendation, index: number) => (\n                    <div\n                      key={index}\n                      className=\"p-4 bg-white/60 backdrop-blur-sm rounded-lg border border-purple-100\"\n                    >\n                      <div className=\"flex items-start gap-3\">\n                        <div className=\"w-8 h-8 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center\">\n                          <Lightbulb className=\"h-4 w-4 text-white\" />\n                        </div>\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-semibold text-gray-900 mb-1\">\n                            {rec.title || 'Recommendation'}\n                          </h4>\n                          <p className=\"text-sm text-gray-600 mb-2\">\n                            {rec.description || 'No description available'}\n                          </p>\n                          <div className=\"flex items-center gap-2\">\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              {rec.impact || 'Medium'} impact\n                            </Badge>\n                            <span className=\"text-xs text-blue-600\">\n                              ≡ƒÆí {rec.suggestion || 'No suggestion available'}\n                            </span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  )) || (\n                    <div className=\"col-span-full text-center py-8\">\n                      <Brain className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                      <p className=\"text-gray-600\">\n                        AI is analyzing your data to generate recommendations...\n                      </p>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Cross-Module Insights */}\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Eye className=\"h-5 w-5 text-blue-500\" />\n                  Cross-Module Intelligence\n                </CardTitle>\n                <CardDescription>\n                  Advanced insights combining data from all farm modules\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-6\">\n                  {/* Weather Impact on Operations */}\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                    <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n                      <Thermometer className=\"h-8 w-8 text-blue-500 mx-auto mb-2\" />\n                      <div className=\"text-lg font-bold\">\n                        {Math.round(\n                          (\n                            (comprehensiveData.modules.weather as ModulePerformance)\n                              ?.overview as ModuleOverviewObject\n                          )?.avg_temperature || 0\n                        )}\n                        ┬░C\n                      </div>\n                      <div className=\"text-sm text-gray-600\">Avg Temperature</div>\n                    </div>\n                    <div className=\"text-center p-4 bg-green-50 rounded-lg\">\n                      <CloudRain className=\"h-8 w-8 text-green-500 mx-auto mb-2\" />\n                      <div className=\"text-lg font-bold\">\n                        {Math.round(\n                          (\n                            (comprehensiveData.modules.weather as ModulePerformance)\n                              ?.overview as ModuleOverviewObject\n                          )?.total_precipitation || 0\n                        )}\n                        mm\n                      </div>\n                      <div className=\"text-sm text-gray-600\">Total Rainfall</div>\n                    </div>\n                    <div className=\"text-center p-4 bg-purple-50 rounded-lg\">\n                      <Wind className=\"h-8 w-8 text-purple-500 mx-auto mb-2\" />\n                      <div className=\"text-lg font-bold\">\n                        {Math.round(\n                          (\n                            (comprehensiveData.modules.weather as ModulePerformance)\n                              ?.overview as ModuleOverviewObject\n                          )?.avg_humidity || 0\n                        )}\n                        %\n                      </div>\n                      <div className=\"text-sm text-gray-600\">Humidity</div>\n                    </div>\n                  </div>\n\n                  {/* Operational Efficiency */}\n                  <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                    <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n                      <Package className=\"h-6 w-6 text-orange-500 mx-auto mb-1\" />\n                      <div className=\"text-sm font-bold\">\n                        {(comprehensiveData.modules.inventory as ModulePerformance)\n                          ?.performance_score || 0}\n                        /100\n                      </div>\n                      <div className=\"text-xs text-gray-600\">Inventory Health</div>\n                    </div>\n                    <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n                      <CheckCircle className=\"h-6 w-6 text-green-500 mx-auto mb-1\" />\n                      <div className=\"text-sm font-bold\">\n                        {(comprehensiveData.modules.tasks as ModulePerformance)\n                          ?.performance_score || 0}\n                        /100\n                      </div>\n                      <div className=\"text-xs text-gray-600\">Task Efficiency</div>\n                    </div>\n                    <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n                      <MapPin className=\"h-6 w-6 text-blue-500 mx-auto mb-1\" />\n                      <div className=\"text-sm font-bold\">\n                        {(comprehensiveData.modules.fields as ModulePerformance)\n                          ?.performance_score || 0}\n                        /100\n                      </div>\n                      <div className=\"text-xs text-gray-600\">Field Utilization</div>\n                    </div>\n                    <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n                      <Gauge className=\"h-6 w-6 text-purple-500 mx-auto mb-1\" />\n                      <div className=\"text-sm font-bold\">\n                        {comprehensiveData.summary.overall_score}/100\n                      </div>\n                      <div className=\"text-xs text-gray-600\">Overall Rating</div>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Predictive Analytics Tab */}\n        {viewMode === 'predictive' && predictiveData && (\n          <div className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {Object.entries(predictiveData).map(([key, _value]) => (\n                <Card key={key} className=\"border-0 shadow-lg\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <Brain className=\"h-5 w-5 text-purple-500\" />\n                      {key.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-center py-4\">\n                      <div className=\"text-2xl font-bold text-purple-600 mb-2\">AI Prediction</div>\n                      <p className=\"text-sm text-gray-600\">\n                        Machine learning analysis in progress...\n                      </p>\n                      <div className=\"mt-4\">\n                        <Badge variant=\"outline\">≡ƒñû AI Generated</Badge>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Optimization Tab */}\n        {viewMode === 'optimization' && optimizationData && (\n          <div className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {Object.entries(optimizationData).map(([key, _value]) => (\n                <Card\n                  key={key}\n                  className=\"border-0 shadow-lg bg-gradient-to-br from-white to-green-50\"\n                >\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <Target className=\"h-5 w-5 text-green-500\" />\n                      {key.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-center py-4\">\n                      <div className=\"text-2xl font-bold text-green-600 mb-2\">Optimization</div>\n                      <p className=\"text-sm text-gray-600\">\n                        AI-powered optimization recommendations...\n                      </p>\n                      <div className=\"mt-4\">\n                        <Badge variant=\"outline\" className=\"bg-green-100 text-green-800\">\n                          ≡ƒÄ» Optimization Ready\n                        </Badge>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Generate Report Section */}\n        <Card className=\"border-0 shadow-lg mt-8\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Download className=\"h-5 w-5 text-blue-500\" />\n              Generate AI Reports\n            </CardTitle>\n            <CardDescription>\n              Create comprehensive reports powered by machine learning insights\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              {[\n                {\n                  type: 'comprehensive',\n                  label: 'Comprehensive Report',\n                  icon: BarChart3,\n                  description: 'Complete farm analysis',\n                },\n                {\n                  type: 'performance',\n                  label: 'Performance Report',\n                  icon: TrendingUp,\n                  description: 'KPI and metrics analysis',\n                },\n                {\n                  type: 'predictive',\n                  label: 'Predictive Report',\n                  icon: Brain,\n                  description: 'AI forecasting',\n                },\n                {\n                  type: 'optimization',\n                  label: 'Optimization Report',\n                  icon: Target,\n                  description: 'Improvement recommendations',\n                },\n              ].map(({ type, label, icon: Icon, description }) => (\n                <Button\n                  key={type}\n                  variant=\"outline\"\n                  onClick={() => generateReportMutation.mutate(type)}\n                  disabled={generateReportMutation.isPending}\n                  className=\"h-auto p-4 flex flex-col gap-2 hover:bg-blue-50\"\n                >\n                  <Icon className=\"h-6 w-6 text-blue-500\" />\n                  <div className=\"text-center\">\n                    <div className=\"font-medium text-sm\">{label}</div>\n                    <div className=\"text-xs text-gray-500\">{description}</div>\n                  </div>\n                </Button>\n              ))}\n            </div>\n            {generateReportMutation.isPending && (\n              <div className=\"flex items-center justify-center mt-6 p-4 bg-blue-50 rounded-lg\">\n                <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\n                <span className=\"ml-2 text-sm text-blue-600\">Generating AI-powered report...</span>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n\nexport default AIAnalyticsDashboard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\AdvancedManagementDashboard.tsx","messages":[{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 29 to the 15 allowed.","line":130,"column":17,"nodeType":null,"messageId":"refactorFunction","endLine":130,"endColumn":44}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useState, useEffect, useCallback } from 'react';\nimport { useAuth } from '../hooks/AuthContext';\nimport { useWebSocket } from '../hooks/useWebSocket';\nimport {\n  Activity,\n  TrendingUp,\n  AlertCircle,\n  CheckCircle,\n  DollarSign,\n  Users,\n  Settings,\n  Zap,\n  BarChart3,\n  Target,\n  Brain,\n  ArrowUpRight,\n  RefreshCw,\n  Play,\n  Pause,\n  Bell,\n  AlertTriangle,\n  Info,\n  Sprout,\n  Package,\n  Truck,\n  Lightbulb,\n  Wifi,\n  WifiOff,\n} from 'lucide-react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Badge } from './ui/badge';\n\ninterface SystemDashboard {\n  farm: {\n    id?: string;\n    name?: string;\n    location?: string;\n    animal_count?: number;\n    crop_count?: number;\n    field_count?: number;\n    task_count?: number;\n    total_revenue?: number;\n    total_expenses?: number;\n  } | null;\n  animals: Array<{\n    species: string;\n    count: number;\n    healthy_count: number;\n    avg_weight: number;\n  }>;\n  crops: Array<{\n    crop_type: string;\n    count: number;\n    avg_yield: number;\n    mature_count: number;\n  }>;\n  fields: {\n    total_fields: number;\n    avg_area: number;\n    cultivated_fields: number;\n  } | null;\n  inventory: {\n    total_items: number;\n    low_stock_items: number;\n    total_value: number;\n  } | null;\n  tasks: {\n    total_tasks: number;\n    completed_tasks: number;\n    active_tasks: number;\n    overdue_tasks: number;\n  } | null;\n  finance: {\n    revenue: number;\n    expenses: number;\n    net_profit: number;\n  } | null;\n  alerts: Alert[];\n  insights: Insight[];\n}\n\ninterface Alert {\n  type: 'error' | 'warning' | 'info' | 'success';\n  category: string;\n  message: string;\n  count: number;\n  timestamp?: number;\n}\n\ninterface Insight {\n  type: 'improvement' | 'efficiency' | 'optimization' | 'warning';\n  category: string;\n  title: string;\n  description: string;\n  impact: 'low' | 'medium' | 'high';\n  suggestion: string;\n  timestamp?: number;\n}\n\ninterface IntegrationData {\n  relationships: Array<{\n    module: string;\n    related_module: string;\n    relationship_count: number;\n  }>;\n  data_flows: unknown[];\n  integration_points: Array<{\n    from: string;\n    to: string;\n    type: string;\n  }>;\n}\n\ninterface WorkflowData {\n  workflows: Array<{\n    workflow_name: string;\n    trigger_type: string;\n    status: string;\n    execution_count: number;\n    last_execution: string | null;\n  }>;\n  process_automation: unknown;\n  efficiency_metrics: unknown;\n}\n\ntype ViewMode = 'dashboard' | 'integrations' | 'workflows' | 'optimization' | 'insights';\n\nexport function AdvancedManagementDashboard() {\n  const { getAuthHeaders, isAuthenticated } = useAuth();\n  const queryClient = useQueryClient();\n\n  // WebSocket integration for real-time updates\n  const {\n    isConnected: isWebSocketConnected,\n    connectionStatus: wsStatus,\n    lastMessage: wsMessage,\n    connect: connectWebSocket,\n    subscribeToFarm,\n    // requestDashboardData,\n    // isAuthenticated: isWsAuthenticated,\n  } = useWebSocket();\n\n  const [selectedFarm, setSelectedFarm] = useState<number>(1);\n  const [viewMode, setViewMode] = useState<ViewMode>('dashboard');\n  const [autoRefresh, setAutoRefresh] = useState(true);\n  const [lastUpdated, setLastUpdated] = useState<Date>(new Date());\n  const [realtimeData, setRealtimeData] = useState<SystemDashboard | null>(null);\n  const [connectionIndicator, setConnectionIndicator] = useState<\n    'online' | 'offline' | 'connecting'\n  >('connecting');\n\n  // Get system dashboard data\n  const {\n    data: dashboard,\n    isLoading,\n    error,\n    refetch,\n  } = useQuery({\n    queryKey: ['system', 'dashboard', selectedFarm],\n    queryFn: async () => {\n      const response = await fetch(\n        `/api/system-integration?farm_id=${selectedFarm}&type=dashboard`,\n        {\n          method: 'GET',\n          headers: getAuthHeaders(),\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch dashboard data');\n      }\n\n      return response.json() as Promise<SystemDashboard>;\n    },\n    enabled: isAuthenticated(),\n    refetchInterval: autoRefresh ? 30000 : false, // Auto-refresh every 30 seconds\n  });\n\n  // Get integration data\n  const { data: integrations } = useQuery({\n    queryKey: ['system', 'integrations', selectedFarm],\n    queryFn: async () => {\n      const response = await fetch(\n        `/api/system-integration?farm_id=${selectedFarm}&type=integration`,\n        {\n          method: 'GET',\n          headers: getAuthHeaders(),\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch integration data');\n      }\n\n      return response.json() as Promise<IntegrationData>;\n    },\n    enabled: isAuthenticated() && viewMode === 'integrations',\n  });\n\n  // Get workflow data\n  const { data: workflows } = useQuery({\n    queryKey: ['system', 'workflows', selectedFarm],\n    queryFn: async () => {\n      const response = await fetch(\n        `/api/system-integration?farm_id=${selectedFarm}&type=workflow`,\n        {\n          method: 'GET',\n          headers: getAuthHeaders(),\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch workflow data');\n      }\n\n      return response.json() as Promise<WorkflowData>;\n    },\n    enabled: isAuthenticated() && viewMode === 'workflows',\n  });\n\n  // Auto-refresh effect\n  useEffect(() => {\n    if (autoRefresh && dashboard) {\n      const interval = setInterval(() => {\n        setLastUpdated(new Date());\n        queryClient.invalidateQueries({ queryKey: ['system', 'dashboard'] });\n      }, 30000);\n\n      return () => clearInterval(interval);\n    }\n    return undefined;\n  }, [autoRefresh, queryClient, dashboard, setLastUpdated]);\n\n  // WebSocket connection and farm subscription\n  useEffect(() => {\n    if (isAuthenticated() && !isWebSocketConnected) {\n      connectWebSocket();\n    }\n  }, [isAuthenticated, isWebSocketConnected, connectWebSocket]);\n\n  useEffect(() => {\n    if (isWebSocketConnected && selectedFarm) {\n      subscribeToFarm(selectedFarm.toString());\n    }\n  }, [isWebSocketConnected, selectedFarm, subscribeToFarm]);\n\n  const handleFarmBroadcast = useCallback(\n    (broadcastData: { type: string }) => {\n      const REFRESH_TYPES = ['new_task', 'task_update', 'inventory_alert', 'animal_health_alert'];\n\n      if (REFRESH_TYPES.includes(broadcastData.type)) {\n        setRealtimeData(prev => (prev ? { ...prev } : null));\n        setLastUpdated(new Date());\n      } else {\n        queryClient.invalidateQueries({ queryKey: ['system', 'dashboard'] });\n      }\n    },\n    [queryClient]\n  );\n\n  // Handle WebSocket messages for real-time updates\n  useEffect(() => {\n    if (!wsMessage) return;\n\n    if (wsMessage.type === 'initial_data' || wsMessage.type === 'heartbeat') {\n      setConnectionIndicator('online');\n      return;\n    }\n\n    if (wsMessage.type === 'error') {\n      setConnectionIndicator('offline');\n      return;\n    }\n\n    if (wsMessage.farm_id !== selectedFarm.toString()) return;\n\n    if (wsMessage.type === 'dashboard_update' && wsMessage.data) {\n      setRealtimeData(wsMessage.data as SystemDashboard);\n      setLastUpdated(new Date());\n    } else if (wsMessage.type === 'farm_broadcast' && wsMessage.data) {\n      handleFarmBroadcast(wsMessage.data as { type: string });\n    }\n  }, [wsMessage, selectedFarm, queryClient, handleFarmBroadcast]);\n\n  // Connection status indicator\n  useEffect(() => {\n    if (isWebSocketConnected) {\n      setConnectionIndicator('online');\n    } else if (wsStatus === 'connecting') {\n      setConnectionIndicator('connecting');\n    } else {\n      setConnectionIndicator('offline');\n    }\n  }, [isWebSocketConnected, wsStatus]);\n\n  const triggerWorkflowMutation = useMutation({\n    mutationFn: async (action: string) => {\n      const response = await fetch('/api/system-integration', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          action,\n          farm_id: selectedFarm,\n          data: {},\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to ${action}`);\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['system'] });\n    },\n  });\n\n  if (!isAuthenticated()) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Please log in</h2>\n          <p className=\"text-gray-600\">\n            You need to be logged in to access the management dashboard.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (isLoading)\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p>Loading management dashboard...</p>\n        </div>\n      </div>\n    );\n\n  if (error)\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-red-600 mb-4\">Error loading dashboard</h2>\n          <p className=\"text-gray-600\">{error.message}</p>\n          <Button onClick={() => refetch()} className=\"mt-4\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Retry\n          </Button>\n        </div>\n      </div>\n    );\n\n  const getAlertIcon = (type: string) => {\n    switch (type) {\n      case 'error':\n        return <AlertCircle className=\"h-4 w-4 text-red-500\" />;\n      case 'warning':\n        return <AlertTriangle className=\"h-4 w-4 text-yellow-500\" />;\n      case 'success':\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\n      default:\n        return <Info className=\"h-4 w-4 text-blue-500\" />;\n    }\n  };\n\n  const getInsightIcon = (type: string) => {\n    switch (type) {\n      case 'improvement':\n        return <Target className=\"h-4 w-4 text-purple-500\" />;\n      case 'efficiency':\n        return <Zap className=\"h-4 w-4 text-blue-500\" />;\n      case 'optimization':\n        return <Brain className=\"h-4 w-4 text-green-500\" />;\n      case 'warning':\n        return <AlertTriangle className=\"h-4 w-4 text-orange-500\" />;\n      default:\n        return <Info className=\"h-4 w-4 text-gray-500\" />;\n    }\n  };\n\n  const getConnectionIcon = () => {\n    switch (connectionIndicator) {\n      case 'online':\n        return <Wifi className=\"h-4 w-4 text-green-500\" />;\n      case 'offline':\n        return <WifiOff className=\"h-4 w-4 text-red-500\" />;\n      default:\n        return <div className=\"h-4 w-4 rounded-full bg-yellow-500 animate-pulse\" />;\n    }\n  };\n\n  // Use real-time data if available, otherwise fall back to cached data\n  const currentData = realtimeData || dashboard;\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Advanced Management Dashboard</h1>\n            <p className=\"text-gray-600 mt-1\">\n              Comprehensive farm management with real-time updates and AI-powered insights\n            </p>\n            <div className=\"flex items-center gap-4 mt-2\">\n              <div className=\"flex items-center gap-2\">\n                {getConnectionIcon()}\n                <span className=\"text-sm text-gray-600\">\n                  {connectionIndicator === 'online'\n                    ? 'Live updates'\n                    : connectionIndicator === 'connecting'\n                      ? 'Connecting...'\n                      : 'Offline mode'}\n                </span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Activity className=\"h-4 w-4 text-green-500\" />\n                <span className=\"text-sm text-gray-600\">\n                  Last updated: {lastUpdated.toLocaleTimeString()}\n                </span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => setAutoRefresh(!autoRefresh)}\n                  className={autoRefresh ? 'bg-green-50 border-green-200' : ''}\n                >\n                  {autoRefresh ? (\n                    <Pause className=\"h-3 w-3 mr-1\" />\n                  ) : (\n                    <Play className=\"h-3 w-3 mr-1\" />\n                  )}\n                  {autoRefresh ? 'Auto-refresh ON' : 'Auto-refresh OFF'}\n                </Button>\n                <Button variant=\"outline\" size=\"sm\" onClick={() => refetch()}>\n                  <RefreshCw className=\"h-3 w-3 mr-1\" />\n                  Refresh\n                </Button>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <select\n              title=\"Select Farm\"\n              value={selectedFarm}\n              onChange={e => setSelectedFarm(parseInt(e.target.value))}\n              className=\"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value={1}>Main Farm</option>\n              {/* Add more farms as needed */}\n            </select>\n          </div>\n        </div>\n\n        {/* Navigation Tabs */}\n        <div className=\"bg-white border-b mb-8\">\n          <nav className=\"-mb-px flex space-x-8\">\n            {[\n              { key: 'dashboard', label: 'Dashboard', icon: BarChart3 },\n              { key: 'integrations', label: 'Integrations', icon: Settings },\n              { key: 'workflows', label: 'Workflows', icon: Zap },\n              { key: 'optimization', label: 'Optimization', icon: Brain },\n              { key: 'insights', label: 'Insights', icon: Lightbulb },\n            ].map(({ key, label, icon: Icon }) => (\n              <button\n                key={key}\n                onClick={() => setViewMode(key as ViewMode)}\n                className={`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${\n                  viewMode === key\n                    ? 'border-blue-500 text-blue-600'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                }`}\n              >\n                <Icon className=\"h-4 w-4\" />\n                {label}\n                {key === 'dashboard' && currentData?.alerts && currentData.alerts.length > 0 && (\n                  <Badge className=\"bg-red-100 text-red-800\">{currentData.alerts.length}</Badge>\n                )}\n              </button>\n            ))}\n          </nav>\n        </div>\n\n        {/* Dashboard Tab */}\n        {viewMode === 'dashboard' && currentData && (\n          <div className=\"space-y-8\">\n            {/* System Status Overview */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <Card>\n                <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">Farm Performance</CardTitle>\n                  <TrendingUp className=\"h-4 w-4 text-green-500\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold text-green-600\">\n                    {currentData.farm?.animal_count || 0} Animals\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {currentData.fields?.total_fields || 0} fields managed\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">Task Efficiency</CardTitle>\n                  <CheckCircle className=\"h-4 w-4 text-blue-500\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold text-blue-600\">\n                    {Math.round(\n                      ((currentData.tasks?.completed_tasks || 0) /\n                        (currentData.tasks?.total_tasks || 1)) *\n                        100\n                    )}\n                    %\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">Completion rate</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">Financial Health</CardTitle>\n                  <DollarSign className=\"h-4 w-4 text-purple-500\" />\n                </CardHeader>\n                <CardContent>\n                  <div\n                    className={`text-2xl font-bold ${\n                      (currentData.finance?.net_profit || 0) >= 0\n                        ? 'text-green-600'\n                        : 'text-red-600'\n                    }`}\n                  >\n                    ${(currentData.finance?.net_profit || 0).toLocaleString()}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">30-day net profit</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">Inventory Status</CardTitle>\n                  <Package className=\"h-4 w-4 text-orange-500\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold text-orange-600\">\n                    {currentData.inventory?.low_stock_items || 0}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">Low stock alerts</p>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Cross-Module Integration Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sprout className=\"h-5 w-5 text-green-500\" />\n                    Crop Performance\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-gray-600\">Active Crops:</span>\n                      <span className=\"text-sm font-medium\">{currentData.crops?.length || 0}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-gray-600\">Mature Plants:</span>\n                      <span className=\"text-sm font-medium\">\n                        {currentData.crops?.reduce(\n                          (sum, crop) => sum + (crop.mature_count || 0),\n                          0\n                        ) || 0}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-gray-600\">Avg Yield:</span>\n                      <span className=\"text-sm font-medium\">\n                        {Math.round(\n                          currentData.crops?.reduce((sum, crop) => sum + (crop.avg_yield || 0), 0) /\n                            (currentData.crops?.length || 1) || 0\n                        )}{' '}\n                        units\n                      </span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Users className=\"h-5 w-5 text-blue-500\" />\n                    Animal Management\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-gray-600\">Total Animals:</span>\n                      <span className=\"text-sm font-medium\">\n                        {currentData.animals?.reduce((sum, animal) => sum + animal.count, 0) || 0}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-gray-600\">Healthy:</span>\n                      <span className=\"text-sm font-medium\">\n                        {currentData.animals?.reduce(\n                          (sum, animal) => sum + animal.healthy_count,\n                          0\n                        ) || 0}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-gray-600\">Avg Weight:</span>\n                      <span className=\"text-sm font-medium\">\n                        {Math.round(\n                          currentData.animals?.reduce(\n                            (sum, animal) => sum + (animal.avg_weight || 0),\n                            0\n                          ) / (currentData.animals?.length || 1) || 0\n                        )}{' '}\n                        kg\n                      </span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Truck className=\"h-5 w-5 text-purple-500\" />\n                    Logistics & Supply\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-gray-600\">Total Items:</span>\n                      <span className=\"text-sm font-medium\">\n                        {currentData.inventory?.total_items || 0}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-gray-600\">Stock Value:</span>\n                      <span className=\"text-sm font-medium\">\n                        ${(currentData.inventory?.total_value || 0).toLocaleString()}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-gray-600\">Utilization:</span>\n                      <span className=\"text-sm font-medium\">\n                        {Math.round(\n                          (1 -\n                            (currentData.inventory?.low_stock_items || 0) /\n                              (currentData.inventory?.total_items || 1)) *\n                            100\n                        )}\n                        %\n                      </span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Alerts and Insights */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Bell className=\"h-5 w-5 text-red-500\" />\n                    System Alerts\n                    {realtimeData && (\n                      <Badge variant=\"outline\" className=\"ml-2 text-xs\">\n                        LIVE\n                      </Badge>\n                    )}\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    {currentData.alerts && currentData.alerts.length > 0 ? (\n                      currentData.alerts.map((alert, index) => (\n                        <div\n                          key={index}\n                          className=\"flex items-start gap-3 p-3 bg-gray-50 rounded-lg\"\n                        >\n                          {getAlertIcon(alert.type)}\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium\">{alert.message}</p>\n                            <p className=\"text-xs text-gray-600 capitalize\">{alert.category}</p>\n                          </div>\n                          <Badge variant={alert.type === 'error' ? 'destructive' : 'secondary'}>\n                            {alert.count}\n                          </Badge>\n                        </div>\n                      ))\n                    ) : (\n                      <div className=\"text-center py-4\">\n                        <CheckCircle className=\"h-8 w-8 text-green-500 mx-auto mb-2\" />\n                        <p className=\"text-sm text-gray-600\">All systems running smoothly</p>\n                        {realtimeData && (\n                          <p className=\"text-xs text-green-600 mt-1\">Real-time monitoring active</p>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Brain className=\"h-5 w-5 text-purple-500\" />\n                    AI Insights & Recommendations\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    {currentData.insights && currentData.insights.length > 0 ? (\n                      currentData.insights.map((insight, index) => (\n                        <div\n                          key={index}\n                          className=\"p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-100\"\n                        >\n                          <div className=\"flex items-start gap-3\">\n                            {getInsightIcon(insight.type)}\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center gap-2 mb-1\">\n                                <h4 className=\"text-sm font-medium\">{insight.title}</h4>\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  {insight.impact} impact\n                                </Badge>\n                              </div>\n                              <p className=\"text-xs text-gray-600 mb-2\">{insight.description}</p>\n                              <p className=\"text-xs text-blue-600 font-medium\">\n                                ≡ƒÆí {insight.suggestion}\n                              </p>\n                            </div>\n                          </div>\n                        </div>\n                      ))\n                    ) : (\n                      <div className=\"text-center py-4\">\n                        <Target className=\"h-8 w-8 text-gray-400 mx-auto mb-2\" />\n                        <p className=\"text-sm text-gray-600\">No insights available yet</p>\n                        <p className=\"text-xs text-gray-500\">System is analyzing your data...</p>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Quick Actions */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Zap className=\"h-5 w-5 text-yellow-500\" />\n                  Quick Actions & Automation\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => triggerWorkflowMutation.mutate('sync_inventory')}\n                    disabled={triggerWorkflowMutation.isPending}\n                    className=\"h-auto p-4 flex flex-col gap-2\"\n                  >\n                    <Package className=\"h-6 w-6 text-blue-500\" />\n                    <span className=\"text-sm font-medium\">Sync Inventory</span>\n                    <span className=\"text-xs text-gray-500\">Update stock levels</span>\n                  </Button>\n\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => triggerWorkflowMutation.mutate('auto_task_creation')}\n                    disabled={triggerWorkflowMutation.isPending}\n                    className=\"h-auto p-4 flex flex-col gap-2\"\n                  >\n                    <CheckCircle className=\"h-6 w-6 text-green-500\" />\n                    <span className=\"text-sm font-medium\">Auto Tasks</span>\n                    <span className=\"text-xs text-gray-500\">Generate routine tasks</span>\n                  </Button>\n\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => triggerWorkflowMutation.mutate('financial_insights')}\n                    disabled={triggerWorkflowMutation.isPending}\n                    className=\"h-auto p-4 flex flex-col gap-2\"\n                  >\n                    <DollarSign className=\"h-6 w-6 text-purple-500\" />\n                    <span className=\"text-sm font-medium\">Financial AI</span>\n                    <span className=\"text-xs text-gray-500\">Analyze finances</span>\n                  </Button>\n\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => triggerWorkflowMutation.mutate('resource_optimization')}\n                    disabled={triggerWorkflowMutation.isPending}\n                    className=\"h-auto p-4 flex flex-col gap-2\"\n                  >\n                    <Brain className=\"h-6 w-6 text-orange-500\" />\n                    <span className=\"text-sm font-medium\">Optimize</span>\n                    <span className=\"text-xs text-gray-500\">Resource allocation</span>\n                  </Button>\n                </div>\n                {triggerWorkflowMutation.isPending && (\n                  <div className=\"flex items-center justify-center mt-4 p-4\">\n                    <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\n                    <span className=\"ml-2 text-sm text-gray-600\">Processing automation...</span>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Other tabs would be implemented similarly... */}\n        {viewMode === 'integrations' && integrations && (\n          <div className=\"space-y-6\">\n            <h2 className=\"text-xl font-semibold\">Module Integrations</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Data Relationships</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    {integrations.relationships?.map((rel, index) => (\n                      <div\n                        key={index}\n                        className=\"flex items-center justify-between p-2 bg-gray-50 rounded\"\n                      >\n                        <span className=\"text-sm\">\n                          {rel.module} ΓåÆ {rel.related_module}\n                        </span>\n                        <Badge>{rel.relationship_count}</Badge>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Integration Points</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    {integrations.integration_points?.map((point, index) => (\n                      <div key={index} className=\"p-2 bg-blue-50 rounded\">\n                        <div className=\"flex items-center gap-2\">\n                          <ArrowUpRight className=\"h-4 w-4 text-blue-500\" />\n                          <span className=\"text-sm font-medium\">\n                            {point.from} ΓåÆ {point.to}\n                          </span>\n                        </div>\n                        <p className=\"text-xs text-gray-600\">{point.type}</p>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        )}\n\n        {/* Additional tabs would be implemented here */}\n        {viewMode === 'workflows' && workflows && (\n          <div className=\"space-y-6\">\n            <h2 className=\"text-xl font-semibold\">Workflow Management</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {workflows.workflows?.map((workflow, index) => (\n                <Card key={index}>\n                  <CardHeader>\n                    <CardTitle className=\"text-lg\">{workflow.workflow_name}</CardTitle>\n                    <CardDescription>{workflow.trigger_type}</CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-2\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm\">Status:</span>\n                        <Badge variant={workflow.status === 'active' ? 'default' : 'secondary'}>\n                          {workflow.status}\n                        </Badge>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm\">Executions:</span>\n                        <span className=\"text-sm font-medium\">{workflow.execution_count}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm\">Last run:</span>\n                        <span className=\"text-sm font-medium\">\n                          {workflow.last_execution\n                            ? new Date(workflow.last_execution).toLocaleDateString()\n                            : 'Never'}\n                        </span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default AdvancedManagementDashboard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\AdvancedReportingSystem.tsx","messages":[{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 3 times.","line":125,"column":23,"nodeType":"Literal","messageId":"defineConstant","endLine":125,"endColumn":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport {\n  FileText,\n  Download,\n  // Filter,\n  // Calendar,\n  BarChart3,\n  // PieChart,\n  // LineChart,\n  TrendingUp,\n  // Users,\n  DollarSign,\n  // Package,\n  // Sprout,\n  Activity,\n  Clock,\n  Target,\n  // Award,\n  Eye,\n  Settings,\n  RefreshCw,\n  Share,\n  // Printer,\n  // Mail,\n  // Calendar as CalendarIcon,\n  // FileSpreadsheet,\n  // FileImage,\n  CheckCircle,\n  // AlertTriangle,\n  // Info,\n  // Zap,\n  // Star,\n} from 'lucide-react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Badge } from './ui/badge';\nimport { Input } from './ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './ui/select';\n\nconst CATEGORY_OPERATIONAL = 'operational';\nconst CATEGORY_FINANCIAL = 'financial';\nconst CATEGORY_COMPLIANCE = 'compliance';\nconst CATEGORY_PERFORMANCE = 'performance';\nconst CATEGORY_CUSTOM = 'custom';\n\nconst TYPE_PDF = 'pdf';\nconst TYPE_EXCEL = 'excel';\nconst TYPE_CSV = 'csv';\n\nconst FREQ_MONTHLY = 'monthly';\nconst FREQ_WEEKLY = 'weekly';\nconst FREQ_QUARTERLY = 'quarterly';\nconst FREQ_ON_DEMAND = 'on_demand';\n\ninterface ReportTemplate {\n  id: string;\n  name: string;\n  description: string;\n  category: 'financial' | 'operational' | 'performance' | 'compliance' | 'custom';\n  type: 'pdf' | 'excel' | 'csv' | 'json';\n  frequency: 'on_demand' | 'daily' | 'weekly' | 'monthly' | 'quarterly' | 'yearly';\n  estimated_time: string;\n  sections: string[];\n  preview_available: boolean;\n  download_count: number;\n  last_generated?: string;\n}\n\ninterface ReportData {\n  financial_summary: {\n    total_revenue: number;\n    total_expenses: number;\n    net_profit: number;\n    profit_margin: number;\n    top_income_sources: { source: string; amount: number; percentage: number }[];\n    major_expenses: { category: string; amount: number; percentage: number }[];\n  };\n  operational_metrics: {\n    total_crops: number;\n    active_fields: number;\n    total_animals: number;\n    inventory_items: number;\n    pending_tasks: number;\n    completed_tasks: number;\n  };\n  performance_indicators: {\n    crop_yield_efficiency: number;\n    animal_health_score: number;\n    inventory_turnover: number;\n    task_completion_rate: number;\n    overall_efficiency: number;\n  };\n  trends: {\n    revenue_trend: 'up' | 'down' | 'stable';\n    expense_trend: 'up' | 'down' | 'stable';\n    productivity_trend: 'up' | 'down' | 'stable';\n    efficiency_trend: 'up' | 'down' | 'stable';\n  };\n}\n\nexport default function AdvancedReportingSystem() {\n  const [activeTab, setActiveTab] = useState<'templates' | 'generate' | 'history' | 'analytics'>(\n    'templates'\n  );\n  const [reportTemplates] = useState<ReportTemplate[]>([\n    {\n      id: 'financial-overview',\n      name: 'Financial Overview Report',\n      description:\n        'Comprehensive financial analysis with profit/loss, cash flow, and budget performance',\n      category: CATEGORY_FINANCIAL,\n      type: TYPE_PDF,\n      frequency: FREQ_MONTHLY,\n      estimated_time: '2-3 minutes',\n      sections: [\n        'Executive Summary',\n        'Revenue Analysis',\n        'Expense Breakdown',\n        'Cash Flow',\n        'Budget Performance',\n        'Recommendations',\n      ],\n      preview_available: true,\n      download_count: 45,\n      last_generated: '2024-11-01',\n    },\n    {\n      id: 'operational-performance',\n      name: 'Operational Performance Report',\n      description:\n        'Detailed operational metrics including crop yields, animal health, and task efficiency',\n      category: CATEGORY_OPERATIONAL,\n      type: TYPE_EXCEL,\n      frequency: FREQ_WEEKLY,\n      estimated_time: '3-5 minutes',\n      sections: [\n        'Performance Overview',\n        'Crop Management',\n        'Animal Care',\n        'Task Efficiency',\n        'Resource Utilization',\n      ],\n      preview_available: true,\n      download_count: 32,\n      last_generated: '2024-11-05',\n    },\n    {\n      id: 'compliance-audit',\n      name: 'Compliance & Audit Report',\n      description: 'Regulatory compliance tracking and audit trail documentation',\n      category: CATEGORY_COMPLIANCE,\n      type: TYPE_PDF,\n      frequency: FREQ_QUARTERLY,\n      estimated_time: '5-7 minutes',\n      sections: [\n        'Compliance Status',\n        'Regulatory Requirements',\n        'Audit Trail',\n        'Documentation Review',\n        'Action Items',\n      ],\n      preview_available: false,\n      download_count: 18,\n      last_generated: '2024-10-15',\n    },\n    {\n      id: 'custom-dashboard',\n      name: 'Custom Dashboard Report',\n      description:\n        'Tailored report with custom metrics and visualizations based on your specifications',\n      category: CATEGORY_CUSTOM,\n      type: TYPE_PDF,\n      frequency: FREQ_ON_DEMAND,\n      estimated_time: '1-2 minutes',\n      sections: ['Custom Metrics', 'Data Visualization', 'Key Insights', 'Action Recommendations'],\n      preview_available: true,\n      download_count: 67,\n      last_generated: '2024-11-03',\n    },\n    {\n      id: 'inventory-analysis',\n      name: 'Inventory Analysis Report',\n      description:\n        'Comprehensive inventory management with stock levels, turnover rates, and optimization suggestions',\n      category: CATEGORY_OPERATIONAL,\n      type: TYPE_EXCEL,\n      frequency: FREQ_MONTHLY,\n      estimated_time: '2-4 minutes',\n      sections: [\n        'Inventory Overview',\n        'Stock Levels',\n        'Turnover Analysis',\n        'Cost Analysis',\n        'Optimization Opportunities',\n      ],\n      preview_available: true,\n      download_count: 29,\n      last_generated: '2024-11-02',\n    },\n    {\n      id: 'yield-prediction',\n      name: 'Yield Prediction Report',\n      description:\n        'AI-powered yield forecasting with historical analysis and improvement recommendations',\n      category: 'performance',\n      type: 'pdf',\n      frequency: 'monthly',\n      estimated_time: '4-6 minutes',\n      sections: [\n        'Yield Forecasts',\n        'Historical Analysis',\n        'Weather Impact',\n        'Optimization Strategies',\n        'Risk Assessment',\n      ],\n      preview_available: true,\n      download_count: 41,\n      last_generated: '2024-11-01',\n    },\n  ]);\n\n  const [reportData, setReportData] = useState<ReportData | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [selectedTemplate, setSelectedTemplate] = useState<string>('');\n  const [dateRange, setDateRange] = useState({ start: '2024-01-01', end: '2024-12-31' });\n  const [format, setFormat] = useState<'pdf' | 'excel' | 'csv'>('pdf');\n\n  useEffect(() => {\n    // TODO: Fetch real report data from API\n    const mockData: ReportData = {\n      financial_summary: {\n        total_revenue: 0,\n        total_expenses: 0,\n        net_profit: 0,\n        profit_margin: 0,\n        top_income_sources: [],\n        major_expenses: [],\n      },\n      operational_metrics: {\n        total_crops: 0,\n        active_fields: 0,\n        total_animals: 0,\n        inventory_items: 0,\n        pending_tasks: 0,\n        completed_tasks: 0,\n      },\n      performance_indicators: {\n        crop_yield_efficiency: 0,\n        animal_health_score: 0,\n        inventory_turnover: 0,\n        task_completion_rate: 0,\n        overall_efficiency: 0,\n      },\n      trends: {\n        revenue_trend: 'stable',\n        expense_trend: 'stable',\n        productivity_trend: 'stable',\n        efficiency_trend: 'stable',\n      },\n    };\n    setReportData(mockData);\n  }, []);\n\n  const getCategoryIcon = (category: string) => {\n    switch (category) {\n      case 'financial':\n        return DollarSign;\n      case CATEGORY_OPERATIONAL:\n        return Activity;\n      case 'performance':\n        return TrendingUp;\n      case 'compliance':\n        return CheckCircle;\n      case 'custom':\n        return Settings;\n      default:\n        return FileText;\n    }\n  };\n\n  const getCategoryColor = (category: string) => {\n    switch (category) {\n      case 'financial':\n        return 'text-green-600 bg-green-100';\n      case CATEGORY_OPERATIONAL:\n        return 'text-blue-600 bg-blue-100';\n      case 'performance':\n        return 'text-purple-600 bg-purple-100';\n      case 'compliance':\n        return 'text-orange-600 bg-orange-100';\n      case 'custom':\n        return 'text-gray-600 bg-gray-100';\n      default:\n        return 'text-gray-600 bg-gray-100';\n    }\n  };\n\n  const getTrendIcon = (trend: string) => {\n    switch (trend) {\n      case 'up':\n        return <TrendingUp className=\"h-4 w-4 text-green-500\" />;\n      case 'down':\n        return <TrendingUp className=\"h-4 w-4 text-red-500 transform rotate-180\" />;\n      default:\n        return <Target className=\"h-4 w-4 text-gray-500\" />;\n    }\n  };\n\n  const generateReport = async (templateId: string) => {\n    setLoading(true);\n    setSelectedTemplate(templateId);\n\n    try {\n      // TODO: Implement actual report generation API call\n      // await apiClient.post('/api/reports/generate', { templateId });\n\n      alert(\n        `Report \"${reportTemplates.find(t => t.id === templateId)?.name}\" generation initiated.`\n      );\n    } catch (error) {\n      console.error('Failed to generate report:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const downloadReport = (templateId: string, format: string) => {\n    // In a real implementation, this would download the actual report\n    const template = reportTemplates.find(t => t.id === templateId);\n    alert(`Downloading ${template?.name} as ${format.toUpperCase()} file...`);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center\">\n                <FileText className=\"h-6 w-6 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-3xl font-bold text-gray-900\">Advanced Reporting System</h1>\n                <p className=\"text-gray-600 mt-1\">Generate comprehensive reports and analytics</p>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <Button variant=\"outline\">\n              <Settings className=\"h-4 w-4 mr-2\" />\n              Settings\n            </Button>\n            <Button\n              onClick={() => setActiveTab('generate')}\n              className=\"bg-gradient-to-r from-blue-600 to-purple-600\"\n            >\n              <FileText className=\"h-4 w-4 mr-2\" />\n              Generate Report\n            </Button>\n          </div>\n        </div>\n\n        {/* Navigation Tabs */}\n        <div className=\"bg-white/80 backdrop-blur-sm border-b mb-8 rounded-lg shadow-sm\">\n          <nav className=\"-mb-px flex space-x-8 px-6\">\n            {[\n              { key: 'templates', label: 'Report Templates', icon: FileText },\n              { key: 'generate', label: 'Generate Reports', icon: Download },\n              { key: 'history', label: 'Report History', icon: Clock },\n              { key: 'analytics', label: 'Analytics', icon: BarChart3 },\n            ].map(({ key, label, icon: Icon }) => (\n              <button\n                key={key}\n                onClick={() =>\n                  setActiveTab(key as 'templates' | 'generate' | 'history' | 'analytics')\n                }\n                className={`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${\n                  activeTab === key\n                    ? 'border-blue-500 text-blue-600'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                }`}\n              >\n                <Icon className=\"h-4 w-4\" />\n                {label}\n              </button>\n            ))}\n          </nav>\n        </div>\n\n        {/* Templates Tab */}\n        {activeTab === 'templates' && (\n          <div className=\"space-y-6\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-xl font-semibold text-gray-900\">Available Report Templates</h2>\n              <div className=\"flex items-center space-x-4\">\n                <Select defaultValue=\"all\">\n                  <SelectTrigger className=\"w-40\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Categories</SelectItem>\n                    <SelectItem value=\"financial\">Financial</SelectItem>\n                    <SelectItem value=\"operational\">Operational</SelectItem>\n                    <SelectItem value=\"performance\">Performance</SelectItem>\n                    <SelectItem value=\"compliance\">Compliance</SelectItem>\n                    <SelectItem value=\"custom\">Custom</SelectItem>\n                  </SelectContent>\n                </Select>\n                <Input placeholder=\"Search templates...\" className=\"w-64\" />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {reportTemplates.map(template => {\n                const IconComponent = getCategoryIcon(template.category);\n                return (\n                  <Card\n                    key={template.id}\n                    className=\"border-0 shadow-lg hover:shadow-xl transition-shadow\"\n                  >\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-10 h-10 bg-gradient-to-r from-blue-100 to-purple-100 rounded-lg flex items-center justify-center\">\n                            <IconComponent className=\"h-5 w-5 text-blue-600\" />\n                          </div>\n                          <div>\n                            <CardTitle className=\"text-lg\">{template.name}</CardTitle>\n                            <CardDescription className=\"text-sm text-gray-600\">\n                              {template.description}\n                            </CardDescription>\n                          </div>\n                        </div>\n                        <Badge className={getCategoryColor(template.category)}>\n                          {template.category}\n                        </Badge>\n                      </div>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-4\">\n                        <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                          <div>\n                            <span className=\"text-gray-600\">Format:</span>\n                            <span className=\"ml-2 font-medium\">{template.type.toUpperCase()}</span>\n                          </div>\n                          <div>\n                            <span className=\"text-gray-600\">Frequency:</span>\n                            <span className=\"ml-2 font-medium\">\n                              {template.frequency.replace('_', ' ')}\n                            </span>\n                          </div>\n                          <div>\n                            <span className=\"text-gray-600\">Time:</span>\n                            <span className=\"ml-2 font-medium\">{template.estimated_time}</span>\n                          </div>\n                          <div>\n                            <span className=\"text-gray-600\">Downloads:</span>\n                            <span className=\"ml-2 font-medium\">{template.download_count}</span>\n                          </div>\n                        </div>\n\n                        <div>\n                          <span className=\"text-sm text-gray-600\">Sections:</span>\n                          <div className=\"flex flex-wrap gap-1 mt-1\">\n                            {template.sections.slice(0, 3).map((section, index) => (\n                              <Badge key={index} variant=\"outline\" className=\"text-xs\">\n                                {section}\n                              </Badge>\n                            ))}\n                            {template.sections.length > 3 && (\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                +{template.sections.length - 3} more\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n\n                        <div className=\"flex items-center justify-between pt-3 border-t\">\n                          <div className=\"flex items-center gap-2\">\n                            {template.preview_available && (\n                              <Button variant=\"outline\" size=\"sm\">\n                                <Eye className=\"h-3 w-3 mr-1\" />\n                                Preview\n                              </Button>\n                            )}\n                            <Button\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => generateReport(template.id)}\n                              disabled={loading && selectedTemplate === template.id}\n                            >\n                              {loading && selectedTemplate === template.id ? (\n                                <>\n                                  <RefreshCw className=\"h-3 w-3 mr-1 animate-spin\" />\n                                  Generating...\n                                </>\n                              ) : (\n                                <>\n                                  <Download className=\"h-3 w-3 mr-1\" />\n                                  Generate\n                                </>\n                              )}\n                            </Button>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <Select\n                              defaultValue=\"pdf\"\n                              onValueChange={value =>\n                                downloadReport(template.id, value as 'pdf' | 'excel' | 'csv')\n                              }\n                            >\n                              <SelectTrigger className=\"w-20 h-8\">\n                                <SelectValue />\n                              </SelectTrigger>\n                              <SelectContent>\n                                <SelectItem value=\"pdf\">PDF</SelectItem>\n                                <SelectItem value=\"excel\">Excel</SelectItem>\n                                <SelectItem value=\"csv\">CSV</SelectItem>\n                              </SelectContent>\n                            </Select>\n                          </div>\n                        </div>\n\n                        {template.last_generated && (\n                          <p className=\"text-xs text-gray-500\">\n                            Last generated: {template.last_generated}\n                          </p>\n                        )}\n                      </div>\n                    </CardContent>\n                  </Card>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Generate Reports Tab */}\n        {activeTab === 'generate' && (\n          <div className=\"space-y-8\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <FileText className=\"h-5 w-5 text-blue-500\" />\n                  Custom Report Generator\n                </CardTitle>\n                <CardDescription>\n                  Create customized reports with your preferred parameters and format\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label\n                        htmlFor=\"report-template\"\n                        className=\"block text-sm font-medium text-gray-700 mb-2\"\n                      >\n                        Report Template\n                      </label>\n                      <Select value={selectedTemplate} onValueChange={setSelectedTemplate}>\n                        <SelectTrigger id=\"report-template\">\n                          <SelectValue placeholder=\"Select a template...\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {reportTemplates.map(template => (\n                            <SelectItem key={template.id} value={template.id}>\n                              {template.name}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div>\n                      <div className=\"block text-sm font-medium text-gray-700 mb-2\">Date Range</div>\n                      <div className=\"grid grid-cols-2 gap-2\">\n                        <Input\n                          type=\"date\"\n                          aria-label=\"Start Date\"\n                          value={dateRange.start}\n                          onChange={e => setDateRange(prev => ({ ...prev, start: e.target.value }))}\n                        />\n                        <Input\n                          type=\"date\"\n                          aria-label=\"End Date\"\n                          value={dateRange.end}\n                          onChange={e => setDateRange(prev => ({ ...prev, end: e.target.value }))}\n                        />\n                      </div>\n                    </div>\n\n                    <div>\n                      <label\n                        htmlFor=\"output-format\"\n                        className=\"block text-sm font-medium text-gray-700 mb-2\"\n                      >\n                        Output Format\n                      </label>\n                      <Select\n                        value={format}\n                        onValueChange={value => setFormat(value as 'pdf' | 'excel' | 'csv')}\n                      >\n                        <SelectTrigger id=\"output-format\">\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"pdf\">PDF Document</SelectItem>\n                          <SelectItem value=\"excel\">Excel Spreadsheet</SelectItem>\n                          <SelectItem value=\"csv\">CSV Data</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-4\">\n                    <div>\n                      <div className=\"block text-sm font-medium text-gray-700 mb-2\">\n                        Additional Options\n                      </div>\n                      <div className=\"space-y-2\">\n                        <div className=\"flex items-center\">\n                          <input\n                            type=\"checkbox\"\n                            id=\"include-charts\"\n                            className=\"mr-2\"\n                            defaultChecked\n                          />\n                          <label htmlFor=\"include-charts\" className=\"text-sm\">\n                            Include charts and visualizations\n                          </label>\n                        </div>\n                        <div className=\"flex items-center\">\n                          <input type=\"checkbox\" id=\"add-summary\" className=\"mr-2\" defaultChecked />\n                          <label htmlFor=\"add-summary\" className=\"text-sm\">\n                            Add executive summary\n                          </label>\n                        </div>\n                        <div className=\"flex items-center\">\n                          <input type=\"checkbox\" id=\"include-raw-data\" className=\"mr-2\" />\n                          <label htmlFor=\"include-raw-data\" className=\"text-sm\">\n                            Include raw data appendix\n                          </label>\n                        </div>\n                        <div className=\"flex items-center\">\n                          <input type=\"checkbox\" id=\"email-report\" className=\"mr-2\" />\n                          <label htmlFor=\"email-report\" className=\"text-sm\">\n                            Email report upon completion\n                          </label>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"pt-4\">\n                      <Button\n                        className=\"w-full bg-gradient-to-r from-blue-600 to-purple-600\"\n                        onClick={() => selectedTemplate && generateReport(selectedTemplate)}\n                        disabled={!selectedTemplate || loading}\n                      >\n                        {loading ? (\n                          <>\n                            <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n                            Generating Report...\n                          </>\n                        ) : (\n                          <>\n                            <Download className=\"h-4 w-4 mr-2\" />\n                            Generate Report\n                          </>\n                        )}\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Report Preview */}\n            {reportData && selectedTemplate && (\n              <Card className=\"border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle>Report Preview</CardTitle>\n                  <CardDescription>Sample data from your farm</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                    <div className=\"text-center p-4 bg-green-50 rounded-lg\">\n                      <DollarSign className=\"h-8 w-8 text-green-600 mx-auto mb-2\" />\n                      <div className=\"text-2xl font-bold text-green-600\">\n                        ${reportData.financial_summary.total_revenue.toLocaleString()}\n                      </div>\n                      <div className=\"text-sm text-gray-600\">Total Revenue</div>\n                      {getTrendIcon(reportData.trends.revenue_trend)}\n                    </div>\n                    <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n                      <Activity className=\"h-8 w-8 text-blue-600 mx-auto mb-2\" />\n                      <div className=\"text-2xl font-bold text-blue-600\">\n                        {reportData.operational_metrics.total_crops}\n                      </div>\n                      <div className=\"text-sm text-gray-600\">Active Crops</div>\n                      {getTrendIcon(reportData.trends.productivity_trend)}\n                    </div>\n                    <div className=\"text-center p-4 bg-purple-50 rounded-lg\">\n                      <TrendingUp className=\"h-8 w-8 text-purple-600 mx-auto mb-2\" />\n                      <div className=\"text-2xl font-bold text-purple-600\">\n                        {reportData.performance_indicators.overall_efficiency}%\n                      </div>\n                      <div className=\"text-sm text-gray-600\">Efficiency Score</div>\n                      {getTrendIcon(reportData.trends.efficiency_trend)}\n                    </div>\n                    <div className=\"text-center p-4 bg-orange-50 rounded-lg\">\n                      <Target className=\"h-8 w-8 text-orange-600 mx-auto mb-2\" />\n                      <div className=\"text-2xl font-bold text-orange-600\">\n                        {reportData.performance_indicators.task_completion_rate}%\n                      </div>\n                      <div className=\"text-sm text-gray-600\">Task Completion</div>\n                      {getTrendIcon('up')}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        )}\n\n        {/* History Tab */}\n        {activeTab === 'history' && (\n          <div className=\"space-y-6\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-xl font-semibold text-gray-900\">Generated Reports</h2>\n              <div className=\"flex items-center space-x-4\">\n                <Input placeholder=\"Search reports...\" className=\"w-64\" />\n                <Select defaultValue=\"all\">\n                  <SelectTrigger className=\"w-40\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Types</SelectItem>\n                    <SelectItem value=\"pdf\">PDF</SelectItem>\n                    <SelectItem value=\"excel\">Excel</SelectItem>\n                    <SelectItem value=\"csv\">CSV</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div className=\"space-y-4\">\n              {[\n                {\n                  name: 'Financial Overview Report',\n                  type: 'PDF',\n                  date: '2024-11-01',\n                  size: '2.3 MB',\n                  status: 'completed',\n                },\n                {\n                  name: 'Operational Performance Report',\n                  type: 'Excel',\n                  date: '2024-11-05',\n                  size: '1.8 MB',\n                  status: 'completed',\n                },\n                {\n                  name: 'Custom Dashboard Report',\n                  type: 'PDF',\n                  date: '2024-11-03',\n                  size: '3.1 MB',\n                  status: 'completed',\n                },\n                {\n                  name: 'Inventory Analysis Report',\n                  type: 'Excel',\n                  date: '2024-11-02',\n                  size: '1.5 MB',\n                  status: 'completed',\n                },\n              ].map((report, index) => (\n                <Card key={index} className=\"border-0 shadow-sm\">\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-4\">\n                        <FileText className=\"h-8 w-8 text-blue-500\" />\n                        <div>\n                          <h3 className=\"font-medium text-gray-900\">{report.name}</h3>\n                          <p className=\"text-sm text-gray-600\">\n                            Generated on {report.date} ΓÇó {report.size}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-3\">\n                        <Badge className=\"bg-green-100 text-green-800\">{report.status}</Badge>\n                        <div className=\"flex items-center gap-2\">\n                          <Button variant=\"outline\" size=\"sm\">\n                            <Download className=\"h-3 w-3 mr-1\" />\n                            Download\n                          </Button>\n                          <Button variant=\"outline\" size=\"sm\">\n                            <Share className=\"h-3 w-3 mr-1\" />\n                            Share\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Analytics Tab */}\n        {activeTab === 'analytics' && reportData && (\n          <div className=\"space-y-8\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-green-50\">\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-sm font-medium text-gray-600\">\n                    Report Generation\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold text-green-600\">247</div>\n                  <p className=\"text-sm text-gray-600 mt-2\">Reports this year</p>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-blue-50\">\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-sm font-medium text-gray-600\">Download Rate</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold text-blue-600\">94%</div>\n                  <p className=\"text-sm text-gray-600 mt-2\">Successful downloads</p>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-purple-50\">\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-sm font-medium text-gray-600\">Average Time</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold text-purple-600\">2.8m</div>\n                  <p className=\"text-sm text-gray-600 mt-2\">Generation time</p>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg bg-gradient-to-br from-white to-orange-50\">\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-sm font-medium text-gray-600\">\n                    Popular Format\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold text-orange-600\">PDF</div>\n                  <p className=\"text-sm text-gray-600 mt-2\">67% of reports</p>\n                </CardContent>\n              </Card>\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card className=\"border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle>Report Usage Trends</CardTitle>\n                  <CardDescription>Monthly report generation and download patterns</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-64 flex items-center justify-center bg-gray-50 rounded-lg\">\n                    <p className=\"text-gray-500\">\n                      Report usage chart visualization would appear here\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle>Template Performance</CardTitle>\n                  <CardDescription>\n                    Most popular report templates and their usage rates\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {reportTemplates.slice(0, 4).map((template, _index) => (\n                      <div key={template.id} className=\"flex items-center justify-between\">\n                        <span className=\"text-sm text-gray-600\">{template.name}</span>\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"w-24 bg-gray-200 rounded-full h-2\">\n                            <div\n                              className=\"bg-blue-600 h-2 rounded-full\"\n                              style={{ width: `${(template.download_count / 67) * 100}%` }}\n                            ></div>\n                          </div>\n                          <span className=\"text-sm font-medium w-8\">{template.download_count}</span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\GlobalSearch.tsx","messages":[{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 3 times.","line":216,"column":21,"nodeType":"Literal","messageId":"defineConstant","endLine":216,"endColumn":34}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef, useCallback } from 'react';\nimport { useAuth } from '../hooks/AuthContext';\nimport { useWebSocket } from '../hooks/useWebSocket';\nimport {\n  Search,\n  X,\n  Clock,\n  Filter,\n  TrendingUp,\n  Users,\n  Sprout,\n  Package,\n  CheckSquare,\n  DollarSign,\n  MapPin,\n  ArrowRight,\n  Loader,\n  AlertCircle,\n} from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Badge } from './ui/badge';\n\nconst POST_METHOD = 'POST';\nconst GET_METHOD = 'GET';\nconst CONTENT_TYPE_JSON = 'application/json';\nconst FILTER_ALL = 'all';\n\ninterface SearchResult {\n  type: 'animal' | 'crop' | 'task' | 'inventory' | 'farm' | 'finance';\n  id: string;\n  name: string;\n  title?: string;\n  description?: string;\n  species?: string;\n  crop_type?: string;\n  category?: string;\n  supplier?: string;\n  location?: string;\n  priority?: string;\n  status?: string;\n  entry_type?: string;\n  health_status?: string;\n  growth_stage?: string;\n  farm_id: string;\n  created_at: string;\n}\n\ninterface SearchSuggestion {\n  type: 'recent_search' | 'entity' | 'suggestion';\n  text: string;\n  score: number;\n}\n\ninterface SearchResults {\n  animals: SearchResult[];\n  crops: SearchResult[];\n  tasks: SearchResult[];\n  inventory: SearchResult[];\n  farms: SearchResult[];\n  finance: SearchResult[];\n  total_results: number;\n}\n\nconst getTypeIcon = (type: string) => {\n  switch (type) {\n    case 'animal':\n      return <Users className=\"h-4 w-4 text-blue-500\" />;\n    case 'crop':\n      return <Sprout className=\"h-4 w-4 text-green-500\" />;\n    case 'task':\n      return <CheckSquare className=\"h-4 w-4 text-purple-500\" />;\n    case 'inventory':\n      return <Package className=\"h-4 w-4 text-orange-500\" />;\n    case 'farm':\n      return <MapPin className=\"h-4 w-4 text-red-500\" />;\n    case 'finance':\n      return <DollarSign className=\"h-4 w-4 text-green-600\" />;\n    default:\n      return <Search className=\"h-4 w-4 text-gray-500\" />;\n  }\n};\n\nconst getTypeLabel = (type: string) => {\n  return type.charAt(0).toUpperCase() + type.slice(1) + 's';\n};\n\ninterface GlobalSearchProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onResultSelect?: (result: SearchResult) => void;\n  currentFarmId?: number;\n}\n\nexport function GlobalSearch({\n  isOpen,\n  onClose,\n  onResultSelect,\n  currentFarmId,\n}: GlobalSearchProps) {\n  const { getAuthHeaders } = useAuth();\n  const { isConnected: isWebSocketConnected, lastMessage: wsMessage } = useWebSocket();\n\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState<SearchResults | null>(null);\n  const [suggestions, setSuggestions] = useState<SearchSuggestion[]>([]);\n  const [recentSearches, setRecentSearches] = useState<SearchSuggestion[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedFilter, setSelectedFilter] = useState<string>(FILTER_ALL);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n\n  const searchInputRef = useRef<HTMLInputElement>(null);\n  const searchTimeoutRef = useRef<number | null>(null);\n\n  // Focus input when search opens\n  useEffect(() => {\n    if (isOpen && searchInputRef.current) {\n      searchInputRef.current.focus();\n    }\n  }, [isOpen]);\n\n  // Handle keyboard navigation\n  useEffect(() => {\n    const allResults = getAllResults();\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (!isOpen) return;\n\n      switch (e.key) {\n        case 'ArrowDown':\n          e.preventDefault();\n          setSelectedIndex(prev => (prev < allResults.length - 1 ? prev + 1 : 0));\n          break;\n        case 'ArrowUp':\n          e.preventDefault();\n          setSelectedIndex(prev => (prev > 0 ? prev - 1 : allResults.length - 1));\n          break;\n        case 'Enter':\n          e.preventDefault();\n          if (selectedIndex >= 0 && allResults[selectedIndex]) {\n            handleResultSelect(allResults[selectedIndex]);\n          }\n          break;\n        case 'Escape':\n          e.preventDefault();\n          onClose();\n          break;\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [isOpen, selectedIndex, results, getAllResults, onClose, handleResultSelect]);\n\n  // WebSocket message handling for live search updates\n  useEffect(() => {\n    if (\n      wsMessage?.type === 'search_results' &&\n      typeof wsMessage.data === 'object' &&\n      wsMessage.data &&\n      'query' in wsMessage.data &&\n      'results' in wsMessage.data &&\n      wsMessage.data.query === query\n    ) {\n      setResults(wsMessage.data.results as SearchResults);\n      setLoading(false);\n    }\n  }, [wsMessage, query]);\n\n  // Get all results as flat array for navigation\n  const getAllResults = useCallback((): SearchResult[] => {\n    if (!results) return [];\n\n    return [\n      ...results.animals,\n      ...results.crops,\n      ...results.tasks,\n      ...results.inventory,\n      ...results.farms,\n      ...results.finance,\n    ];\n  }, [results]);\n\n  // Debounced search\n  const performSearch = useCallback(\n    async (searchQuery: string, filter: string = FILTER_ALL) => {\n      if (!searchQuery.trim()) {\n        setResults(null);\n        setLoading(false);\n        return;\n      }\n\n      setLoading(true);\n      setError(null);\n\n      try {\n        const params = new URLSearchParams({\n          q: searchQuery,\n          type: filter,\n          ...(currentFarmId ? { farm_id: currentFarmId.toString() } : {}),\n        });\n\n        const response = await fetch(`/api/search?${params}`, {\n          method: GET_METHOD,\n          headers: getAuthHeaders(),\n        });\n\n        if (!response.ok) {\n          throw new Error('Search failed');\n        }\n\n        const searchResults = await response.json();\n        setResults(searchResults.data);\n\n        // Save search to history\n        await fetch('/api/search', {\n          method: POST_METHOD,\n          headers: {\n            'Content-Type': CONTENT_TYPE_JSON,\n            ...getAuthHeaders(),\n          },\n          body: JSON.stringify({\n            action: 'save_search',\n            data: { query: searchQuery, type: filter },\n          }),\n        });\n      } catch (err) {\n        setError('Search failed. Please try again.');\n        console.error('Search error:', err);\n      } finally {\n        setLoading(false);\n      }\n    },\n    [getAuthHeaders, currentFarmId]\n  );\n\n  // Debounce search input\n  useEffect(() => {\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n\n    searchTimeoutRef.current = window.setTimeout(() => {\n      performSearch(query, selectedFilter);\n    }, 300);\n\n    return () => {\n      if (searchTimeoutRef.current) {\n        clearTimeout(searchTimeoutRef.current);\n      }\n    };\n  }, [query, selectedFilter, performSearch]);\n\n  // Load suggestions and recent searches\n  useEffect(() => {\n    if (isOpen) {\n      loadSuggestions();\n      loadRecentSearches();\n    }\n  }, [isOpen, loadSuggestions, loadRecentSearches]);\n\n  const loadSuggestions = useCallback(async () => {\n    try {\n      const response = await fetch('/api/search', {\n        method: POST_METHOD,\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          action: 'get_suggestions',\n          data: { query },\n        }),\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        setSuggestions(data.data.suggestions);\n      }\n    } catch (error) {\n      console.error('Failed to load suggestions:', error);\n    }\n  }, [getAuthHeaders, query]);\n\n  const loadRecentSearches = useCallback(async () => {\n    try {\n      const response = await fetch('/api/search', {\n        method: POST_METHOD,\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          action: 'get_recent_searches',\n        }),\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        setRecentSearches(\n          data.data.recent.map((search: { query: string }) => ({\n            type: 'recent_search' as const,\n            text: search.query,\n            score: 0.5,\n          }))\n        );\n      }\n    } catch (error) {\n      console.error('Failed to load recent searches:', error);\n    }\n  }, [getAuthHeaders]);\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setQuery(value);\n    setSelectedIndex(-1);\n\n    if (value.length > 0) {\n      loadSuggestions();\n    } else {\n      setSuggestions([]);\n    }\n  };\n\n  const handleFilterChange = (filter: string) => {\n    setSelectedFilter(filter);\n    setSelectedIndex(-1);\n  };\n\n  const handleResultSelect = useCallback(\n    (result: SearchResult) => {\n      onResultSelect?.(result);\n      onClose();\n    },\n    [onResultSelect, onClose]\n  );\n\n  const handleSuggestionClick = useCallback(\n    (suggestion: SearchSuggestion) => {\n      setQuery(suggestion.text);\n      performSearch(suggestion.text, selectedFilter);\n    },\n    [performSearch, selectedFilter]\n  );\n\n  const clearSearch = useCallback(() => {\n    setQuery('');\n    setResults(null);\n    setSuggestions([]);\n    setSelectedIndex(-1);\n    searchInputRef.current?.focus();\n  }, []);\n\n  if (!isOpen) return null;\n\n  const allResults = getAllResults();\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-start justify-center pt-20\">\n      <Card className=\"w-full max-w-2xl mx-4 max-h-[80vh] overflow-hidden\">\n        <CardHeader className=\"pb-4\">\n          <div className=\"flex items-center justify-between\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <Search className=\"h-5 w-5\" />\n              Global Search\n              {isWebSocketConnected && (\n                <Badge variant=\"outline\" className=\"text-xs\">\n                  <div className=\"h-2 w-2 bg-green-500 rounded-full mr-1\"></div>\n                  Live\n                </Badge>\n              )}\n            </CardTitle>\n            <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n\n          {/* Search Input */}\n          <div className=\"relative\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n              <input\n                ref={searchInputRef}\n                type=\"text\"\n                value={query}\n                onChange={handleInputChange}\n                placeholder=\"Search animals, crops, tasks, inventory...\"\n                className=\"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n              {query && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={clearSearch}\n                  className=\"absolute right-1 top-1/2 transform -translate-y-1/2\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              )}\n            </div>\n          </div>\n\n          {/* Filter Buttons */}\n          <div className=\"flex gap-2 flex-wrap\">\n            {['all', 'animals', 'crops', 'tasks', 'inventory', 'farms', 'finance'].map(filter => (\n              <Button\n                key={filter}\n                variant={selectedFilter === filter ? 'default' : 'outline'}\n                size=\"sm\"\n                onClick={() => handleFilterChange(filter)}\n                className=\"text-xs\"\n              >\n                {getTypeLabel(filter)}\n              </Button>\n            ))}\n          </div>\n        </CardHeader>\n\n        <CardContent className=\"pt-0 max-h-96 overflow-y-auto\">\n          {/* Loading State */}\n          {loading && (\n            <div className=\"flex items-center justify-center py-8\">\n              <Loader className=\"h-6 w-6 animate-spin mr-2\" />\n              <span>Searching...</span>\n            </div>\n          )}\n\n          {/* Error State */}\n          {error && (\n            <div className=\"flex items-center justify-center py-8 text-red-600\">\n              <AlertCircle className=\"h-5 w-5 mr-2\" />\n              <span>{error}</span>\n            </div>\n          )}\n\n          {/* Search Results */}\n          {!loading && !error && allResults.length > 0 && (\n            <div className=\"space-y-4\">\n              {['animals', 'crops', 'tasks', 'inventory', 'farms', 'finance'].map(type => {\n                const typeResults =\n                  (results?.[type as keyof SearchResults] as SearchResult[]) || [];\n                if (typeResults.length === 0) return null;\n\n                return (\n                  <div key={type}>\n                    <h3 className=\"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2\">\n                      {getTypeIcon(type)}\n                      {getTypeLabel(type)} ({typeResults.length})\n                    </h3>\n                    <div className=\"space-y-2\">\n                      {typeResults.map((result, _index) => (\n                        <div\n                          key={`${result.type}-${result.id}`}\n                          role=\"button\"\n                          tabIndex={0}\n                          className={`p-3 rounded-lg border cursor-pointer transition-colors ${\n                            selectedIndex === allResults.indexOf(result)\n                              ? 'bg-blue-50 border-blue-200'\n                              : 'hover:bg-gray-50 border-gray-200'\n                          }`}\n                          onClick={() => handleResultSelect(result)}\n                          onKeyDown={e => {\n                            if (e.key === 'Enter' || e.key === ' ') {\n                              e.preventDefault();\n                              handleResultSelect(result);\n                            }\n                          }}\n                        >\n                          <div className=\"flex items-center justify-between\">\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center gap-2\">\n                                {getTypeIcon(result.type)}\n                                <h4 className=\"font-medium text-sm\">\n                                  {result.name || result.title}\n                                </h4>\n                                {result.priority && (\n                                  <Badge variant=\"outline\" className=\"text-xs\">\n                                    {result.priority}\n                                  </Badge>\n                                )}\n                                {result.status && (\n                                  <Badge\n                                    variant={\n                                      result.status === 'completed' ? 'default' : 'secondary'\n                                    }\n                                    className=\"text-xs\"\n                                  >\n                                    {result.status}\n                                  </Badge>\n                                )}\n                              </div>\n                              <p className=\"text-xs text-gray-600 mt-1\">\n                                {result.description ||\n                                  result.species ||\n                                  result.crop_type ||\n                                  result.category ||\n                                  result.location}\n                              </p>\n                            </div>\n                            <ArrowRight className=\"h-4 w-4 text-gray-400\" />\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n\n          {/* No Results */}\n          {!loading && !error && query && allResults.length === 0 && (\n            <div className=\"text-center py-8 text-gray-500\">\n              <Search className=\"h-8 w-8 mx-auto mb-2\" />\n              <p>No results found for \"{query}\"</p>\n              <p className=\"text-sm\">Try adjusting your search terms or filters</p>\n            </div>\n          )}\n\n          {/* Suggestions and Recent Searches */}\n          {!loading && !query && (\n            <div className=\"space-y-6\">\n              {/* Recent Searches */}\n              {recentSearches.length > 0 && (\n                <div>\n                  <h3 className=\"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2\">\n                    <Clock className=\"h-4 w-4\" />\n                    Recent Searches\n                  </h3>\n                  <div className=\"space-y-2\">\n                    {recentSearches.slice(0, 5).map((search, index) => (\n                      <div\n                        key={index}\n                        role=\"button\"\n                        tabIndex={0}\n                        className=\"p-2 rounded-lg border border-gray-200 cursor-pointer hover:bg-gray-50\"\n                        onClick={() => handleSuggestionClick(search)}\n                        onKeyDown={e => {\n                          if (e.key === 'Enter' || e.key === ' ') {\n                            e.preventDefault();\n                            handleSuggestionClick(search);\n                          }\n                        }}\n                      >\n                        <div className=\"flex items-center gap-2\">\n                          <Clock className=\"h-3 w-3 text-gray-400\" />\n                          <span className=\"text-sm\">{search.text}</span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Popular Searches */}\n              <div>\n                <h3 className=\"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2\">\n                  <TrendingUp className=\"h-4 w-4\" />\n                  Popular Searches\n                </h3>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  {[\n                    'Livestock',\n                    'Crop rotation',\n                    'Inventory',\n                    'Tasks',\n                    'Financial',\n                    'Animals health',\n                  ].map(term => (\n                    <Button\n                      key={term}\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() =>\n                        handleSuggestionClick({ type: 'suggestion', text: term, score: 0.7 })\n                      }\n                      className=\"text-xs justify-start\"\n                    >\n                      <Search className=\"h-3 w-3 mr-1\" />\n                      {term}\n                    </Button>\n                  ))}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Auto-complete Suggestions */}\n          {!loading && query && suggestions.length > 0 && allResults.length === 0 && (\n            <div>\n              <h3 className=\"text-sm font-medium text-gray-700 mb-3\">Suggestions</h3>\n              <div className=\"space-y-2\">\n                {suggestions.slice(0, 5).map((suggestion, index) => (\n                  <div\n                    key={index}\n                    role=\"button\"\n                    tabIndex={0}\n                    className=\"p-2 rounded-lg border border-gray-200 cursor-pointer hover:bg-gray-50\"\n                    onClick={() => handleSuggestionClick(suggestion)}\n                    onKeyDown={e => {\n                      if (e.key === 'Enter' || e.key === ' ') {\n                        e.preventDefault();\n                        handleSuggestionClick(suggestion);\n                      }\n                    }}\n                  >\n                    <div className=\"flex items-center gap-2\">\n                      <Search className=\"h-3 w-3 text-gray-400\" />\n                      <span className=\"text-sm\">{suggestion.text}</span>\n                      <Badge variant=\"secondary\" className=\"text-xs ml-auto\">\n                        {suggestion.type}\n                      </Badge>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nexport default GlobalSearch;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\mui\\theme-new.ts","messages":[{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 3 times.","line":104,"column":22,"nodeType":"Literal","messageId":"defineConstant","endLine":104,"endColumn":49},{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 3 times.","line":116,"column":19,"nodeType":"Literal","messageId":"defineConstant","endLine":116,"endColumn":47}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\nimport { CssBaseline } from '@mui/material';\n\n// Farm Management App Theme\nexport const farmTheme = createTheme({\n  palette: {\n    mode: 'light',\n    primary: {\n      main: '#2e7d32', // Deep green for farming\n      light: '#4caf50',\n      dark: '#1b5e20',\n      contrastText: '#ffffff',\n    },\n    secondary: {\n      main: '#ff9800', // Orange for harvest/energy\n      light: '#ffb74d',\n      dark: '#f57c00',\n      contrastText: '#000000',\n    },\n    success: {\n      main: '#4caf50',\n      light: '#81c784',\n      dark: '#388e3c',\n    },\n    warning: {\n      main: '#ff9800',\n      light: '#ffb74d',\n      dark: '#f57c00',\n    },\n    error: {\n      main: '#f44336',\n      light: '#e57373',\n      dark: '#d32f2f',\n    },\n    info: {\n      main: '#2196f3',\n      light: '#64b5f6',\n      dark: '#1976d2',\n    },\n    background: {\n      default: '#fafafa',\n      paper: '#ffffff',\n    },\n    text: {\n      primary: '#212121',\n      secondary: '#757575',\n    },\n  },\n  typography: {\n    fontFamily: '\"Inter\", \"Roboto\", \"Helvetica\", \"Arial\", sans-serif',\n    h1: {\n      fontSize: '2.5rem',\n      fontWeight: 600,\n      lineHeight: 1.2,\n    },\n    h2: {\n      fontSize: '2rem',\n      fontWeight: 600,\n      lineHeight: 1.3,\n    },\n    h3: {\n      fontSize: '1.75rem',\n      fontWeight: 600,\n      lineHeight: 1.4,\n    },\n    h4: {\n      fontSize: '1.5rem',\n      fontWeight: 600,\n      lineHeight: 1.4,\n    },\n    h5: {\n      fontSize: '1.25rem',\n      fontWeight: 600,\n      lineHeight: 1.5,\n    },\n    h6: {\n      fontSize: '1rem',\n      fontWeight: 600,\n      lineHeight: 1.6,\n    },\n    body1: {\n      fontSize: '1rem',\n      lineHeight: 1.6,\n    },\n    body2: {\n      fontSize: '0.875rem',\n      lineHeight: 1.5,\n    },\n  },\n  shape: {\n    borderRadius: 12,\n  },\n  components: {\n    MuiButton: {\n      styleOverrides: {\n        root: {\n          textTransform: 'none',\n          fontWeight: 500,\n          borderRadius: 8,\n          padding: '8px 16px',\n        },\n        contained: {\n          boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n          '&:hover': {\n            boxShadow: '0 4px 8px rgba(0,0,0,0.15)',\n          },\n        },\n      },\n    },\n    MuiCard: {\n      styleOverrides: {\n        root: {\n          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n          borderRadius: 12,\n          border: '1px solid rgba(0,0,0,0.08)',\n        },\n      },\n    },\n    MuiPaper: {\n      styleOverrides: {\n        root: {\n          backgroundImage: 'none',\n        },\n        elevation1: {\n          boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n        },\n        elevation2: {\n          boxShadow: '0 4px 8px rgba(0,0,0,0.12)',\n        },\n        elevation3: {\n          boxShadow: '0 6px 12px rgba(0,0,0,0.15)',\n        },\n      },\n    },\n    MuiAppBar: {\n      styleOverrides: {\n        root: {\n          backgroundColor: '#ffffff',\n          color: '#212121',\n          boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n        },\n      },\n    },\n    MuiDrawer: {\n      styleOverrides: {\n        paper: {\n          borderRight: '1px solid rgba(0,0,0,0.08)',\n        },\n      },\n    },\n    MuiChip: {\n      styleOverrides: {\n        root: {\n          borderRadius: 16,\n          fontWeight: 500,\n        },\n      },\n    },\n    MuiTextField: {\n      styleOverrides: {\n        root: {\n          '& .MuiOutlinedInput-root': {\n            borderRadius: 8,\n          },\n        },\n      },\n    },\n    MuiTableCell: {\n      styleOverrides: {\n        root: {\n          borderBottom: '1px solid rgba(0,0,0,0.08)',\n        },\n        head: {\n          fontWeight: 600,\n          backgroundColor: '#fafafa',\n        },\n      },\n    },\n  },\n});\n\n// Dark theme variant\nexport const darkFarmTheme = createTheme({\n  palette: {\n    mode: 'dark',\n    primary: {\n      main: '#4caf50',\n      light: '#81c784',\n      dark: '#388e3c',\n      contrastText: '#ffffff',\n    },\n    secondary: {\n      main: '#ff9800',\n      light: '#ffb74d',\n      dark: '#f57c00',\n      contrastText: '#000000',\n    },\n    background: {\n      default: '#121212',\n      paper: '#1e1e1e',\n    },\n    text: {\n      primary: '#ffffff',\n      secondary: '#b0b0b0',\n    },\n  },\n  typography: farmTheme.typography,\n  shape: farmTheme.shape,\n  components: farmTheme.components,\n});\n\n// Theme provider wrapper\ninterface FarmThemeProviderProps {\n  children: React.ReactNode;\n  darkMode?: boolean;\n}\n\nexport const FarmThemeProvider: React.FC<FarmThemeProviderProps> = ({\n  children,\n  darkMode = false,\n}) => {\n  return React.createElement(\n    ThemeProvider,\n    { theme: darkMode ? darkFarmTheme : farmTheme },\n    React.createElement(CssBaseline, null),\n    children\n  );\n};\n\nexport default farmTheme;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\mui\\theme.tsx","messages":[{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 3 times.","line":104,"column":22,"nodeType":"Literal","messageId":"defineConstant","endLine":104,"endColumn":49},{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 3 times.","line":116,"column":19,"nodeType":"Literal","messageId":"defineConstant","endLine":116,"endColumn":47}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\nimport { CssBaseline } from '@mui/material';\n\n// Farm Management App Theme\nexport const farmTheme = createTheme({\n  palette: {\n    mode: 'light',\n    primary: {\n      main: '#2e7d32', // Deep green for farming\n      light: '#4caf50',\n      dark: '#1b5e20',\n      contrastText: '#ffffff',\n    },\n    secondary: {\n      main: '#ff9800', // Orange for harvest/energy\n      light: '#ffb74d',\n      dark: '#f57c00',\n      contrastText: '#000000',\n    },\n    success: {\n      main: '#4caf50',\n      light: '#81c784',\n      dark: '#388e3c',\n    },\n    warning: {\n      main: '#ff9800',\n      light: '#ffb74d',\n      dark: '#f57c00',\n    },\n    error: {\n      main: '#f44336',\n      light: '#e57373',\n      dark: '#d32f2f',\n    },\n    info: {\n      main: '#2196f3',\n      light: '#64b5f6',\n      dark: '#1976d2',\n    },\n    background: {\n      default: '#fafafa',\n      paper: '#ffffff',\n    },\n    text: {\n      primary: '#212121',\n      secondary: '#757575',\n    },\n  },\n  typography: {\n    fontFamily: '\"Inter\", \"Roboto\", \"Helvetica\", \"Arial\", sans-serif',\n    h1: {\n      fontSize: '2.5rem',\n      fontWeight: 600,\n      lineHeight: 1.2,\n    },\n    h2: {\n      fontSize: '2rem',\n      fontWeight: 600,\n      lineHeight: 1.3,\n    },\n    h3: {\n      fontSize: '1.75rem',\n      fontWeight: 600,\n      lineHeight: 1.4,\n    },\n    h4: {\n      fontSize: '1.5rem',\n      fontWeight: 600,\n      lineHeight: 1.4,\n    },\n    h5: {\n      fontSize: '1.25rem',\n      fontWeight: 600,\n      lineHeight: 1.5,\n    },\n    h6: {\n      fontSize: '1rem',\n      fontWeight: 600,\n      lineHeight: 1.6,\n    },\n    body1: {\n      fontSize: '1rem',\n      lineHeight: 1.6,\n    },\n    body2: {\n      fontSize: '0.875rem',\n      lineHeight: 1.5,\n    },\n  },\n  shape: {\n    borderRadius: 12,\n  },\n  components: {\n    MuiButton: {\n      styleOverrides: {\n        root: {\n          textTransform: 'none',\n          fontWeight: 500,\n          borderRadius: 8,\n          padding: '8px 16px',\n        },\n        contained: {\n          boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n          '&:hover': {\n            boxShadow: '0 4px 8px rgba(0,0,0,0.15)',\n          },\n        },\n      },\n    },\n    MuiCard: {\n      styleOverrides: {\n        root: {\n          boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n          borderRadius: 12,\n          border: '1px solid rgba(0,0,0,0.08)',\n        },\n      },\n    },\n    MuiPaper: {\n      styleOverrides: {\n        root: {\n          backgroundImage: 'none',\n        },\n        elevation1: {\n          boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n        },\n        elevation2: {\n          boxShadow: '0 4px 8px rgba(0,0,0,0.12)',\n        },\n        elevation3: {\n          boxShadow: '0 6px 12px rgba(0,0,0,0.15)',\n        },\n      },\n    },\n    MuiAppBar: {\n      styleOverrides: {\n        root: {\n          backgroundColor: '#ffffff',\n          color: '#212121',\n          boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n        },\n      },\n    },\n    MuiDrawer: {\n      styleOverrides: {\n        paper: {\n          borderRight: '1px solid rgba(0,0,0,0.08)',\n        },\n      },\n    },\n    MuiChip: {\n      styleOverrides: {\n        root: {\n          borderRadius: 16,\n          fontWeight: 500,\n        },\n      },\n    },\n    MuiTextField: {\n      styleOverrides: {\n        root: {\n          '& .MuiOutlinedInput-root': {\n            borderRadius: 8,\n          },\n        },\n      },\n    },\n    MuiTableCell: {\n      styleOverrides: {\n        root: {\n          borderBottom: '1px solid rgba(0,0,0,0.08)',\n        },\n        head: {\n          fontWeight: 600,\n          backgroundColor: '#fafafa',\n        },\n      },\n    },\n  },\n});\n\n// Dark theme variant\nexport const darkFarmTheme = createTheme({\n  palette: {\n    mode: 'dark',\n    primary: {\n      main: '#4caf50',\n      light: '#81c784',\n      dark: '#388e3c',\n      contrastText: '#ffffff',\n    },\n    secondary: {\n      main: '#ff9800',\n      light: '#ffb74d',\n      dark: '#f57c00',\n      contrastText: '#000000',\n    },\n    background: {\n      default: '#121212',\n      paper: '#1e1e1e',\n    },\n    text: {\n      primary: '#ffffff',\n      secondary: '#b0b0b0',\n    },\n  },\n  typography: farmTheme.typography,\n  shape: farmTheme.shape,\n  components: farmTheme.components,\n});\n\n// Theme provider wrapper\ninterface FarmThemeProviderProps {\n  children: React.ReactNode;\n  darkMode?: boolean;\n}\n\nexport const FarmThemeProvider: React.FC<FarmThemeProviderProps> = ({\n  children,\n  darkMode = false,\n}) => {\n  return (\n    <ThemeProvider theme={darkMode ? darkFarmTheme : farmTheme}>\n      <CssBaseline />\n      {children}\n    </ThemeProvider>\n  );\n};\n\nexport default farmTheme;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\tasks\\TaskModal.tsx","messages":[{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed.","line":106,"column":16,"nodeType":null,"messageId":"refactorFunction","endLine":106,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '../ui/dialog';\nimport { Button } from '../ui/button';\nimport { Input } from '../ui/input';\nimport { Label } from '../ui/label';\nimport { Textarea } from '../ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../ui/select';\nimport { Plus, Trash2, DollarSign } from 'lucide-react';\nimport type { ExtendedTask } from './types';\nimport type { Farm, User } from '../../api/types';\n\ninterface TaskModalProps {\n  task: ExtendedTask | null;\n  farms: Farm[];\n  users: User[];\n  onSave: (data: any) => void;\n  onClose: () => void;\n  isLoading: boolean;\n}\n\ninterface CostItem {\n  description: string;\n  amount: number;\n  currency: string;\n}\n\ninterface CostFormProps {\n  costs: CostItem[];\n  onAdd: () => void;\n  onRemove: (index: number) => void;\n  onChange: (index: number, field: keyof CostItem, value: any) => void;\n}\n\nconst CostForm = ({ costs, onAdd, onRemove, onChange }: CostFormProps) => (\n  <div className=\"border-t pt-4\">\n    <div className=\"flex items-center justify-between mb-4\">\n      <Label className=\"text-base font-semibold flex items-center gap-2\">\n        <DollarSign className=\"h-4 w-4\" />\n        Cost Components\n      </Label>\n      <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={onAdd}>\n        <Plus className=\"h-4 w-4 mr-1\" />\n        Add Cost\n      </Button>\n    </div>\n\n    {costs.length === 0 && (\n      <p className=\"text-sm text-gray-500 italic\">No cost components added.</p>\n    )}\n\n    <div className=\"space-y-3\">\n      {costs.map((cost, index) => (\n        <div key={index} className=\"flex items-end gap-3 bg-gray-50 p-3 rounded-md\">\n          <div className=\"flex-1 space-y-1\">\n            <Label className=\"text-xs\">Description</Label>\n            <Input\n              value={cost.description}\n              onChange={e => onChange(index, 'description', e.target.value)}\n              placeholder=\"e.g. Fertilizer, Labor\"\n            />\n          </div>\n          <div className=\"w-32 space-y-1\">\n            <Label className=\"text-xs\">Amount</Label>\n            <Input\n              type=\"number\"\n              value={cost.amount}\n              onChange={e => onChange(index, 'amount', parseFloat(e.target.value))}\n              min=\"0\"\n              step=\"0.01\"\n            />\n          </div>\n          <Button\n            type=\"button\"\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"text-red-500 hover:text-red-700 hover:bg-red-50\"\n            onClick={() => onRemove(index)}\n          >\n            <Trash2 className=\"h-4 w-4\" />\n          </Button>\n        </div>\n      ))}\n    </div>\n\n    {costs.length > 0 && (\n      <div className=\"mt-4 text-right font-medium\">\n        Total Estimated Cost: ${costs.reduce((sum, c) => sum + (c.amount || 0), 0).toFixed(2)}\n      </div>\n    )}\n  </div>\n);\n\nexport function TaskModal({ task, farms, users, onSave, onClose, isLoading }: TaskModalProps) {\n  const [formData, setFormData] = useState<any>({\n    title: '',\n    description: '',\n    status: 'pending',\n    priority: 'medium',\n    due_date: '',\n    farm_id: '',\n    assigned_to_id: '',\n  });\n\n  const [costs, setCosts] = useState<CostItem[]>([]);\n\n  useEffect(() => {\n    if (task) {\n      setFormData({\n        title: task.title || '',\n        description: task.description || '',\n        status: task.status || 'pending',\n        priority: task.priority || 'medium',\n        due_date: task.due_date ? new Date(task.due_date).toISOString().split('T')[0] : '',\n        farm_id: task.farm_id?.toString() || '',\n        assigned_to_id: task.assigned_to || '',\n      });\n      if (task.costs && Array.isArray(task.costs)) {\n        setCosts(\n          task.costs.map((c: any) => ({\n            description: c.description,\n            amount: c.amount,\n            currency: c.currency || 'USD',\n          }))\n        );\n      }\n    } else {\n      setFormData({\n        title: '',\n        description: '',\n        status: 'pending',\n        priority: 'medium',\n        due_date: '',\n        farm_id: farms.length > 0 ? farms[0]?.id?.toString() || '' : '',\n        assigned_to_id: '',\n      });\n      setCosts([]);\n    }\n  }, [task, farms]);\n\n  const handleChange = (field: string, value: any) => {\n    setFormData((prev: any) => ({ ...prev, [field]: value }));\n  };\n\n  const handleAddCost = () => {\n    setCosts([...costs, { description: '', amount: 0, currency: 'USD' }]);\n  };\n\n  const handleRemoveCost = (index: number) => {\n    setCosts(costs.filter((_, i) => i !== index));\n  };\n\n  const handleCostChange = (index: number, field: keyof CostItem, value: any) => {\n    const newCosts = [...costs];\n    newCosts[index] = { ...newCosts[index], [field]: value } as CostItem;\n    setCosts(newCosts);\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSave({\n      ...formData,\n      id: task?.id,\n      costs: costs.filter(c => c.description && c.amount > 0),\n    });\n  };\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{task ? 'Edit Task' : 'Create Task'}</DialogTitle>\n        </DialogHeader>\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"title\">Title *</Label>\n              <Input\n                id=\"title\"\n                value={formData.title}\n                onChange={e => handleChange('title', e.target.value)}\n                required\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"farm_id\">Farm *</Label>\n              <Select value={formData.farm_id} onValueChange={val => handleChange('farm_id', val)}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Select Farm\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {farms.map(f => (\n                    <SelectItem key={f.id} value={f.id.toString()}>\n                      {f.name}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"status\">Status *</Label>\n              <Select value={formData.status} onValueChange={val => handleChange('status', val)}>\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"pending\">Pending</SelectItem>\n                  <SelectItem value=\"in_progress\">In Progress</SelectItem>\n                  <SelectItem value=\"completed\">Completed</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"priority\">Priority *</Label>\n              <Select\n                value={formData.priority}\n                onValueChange={val => handleChange('priority', val)}\n              >\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"low\">Low</SelectItem>\n                  <SelectItem value=\"medium\">Medium</SelectItem>\n                  <SelectItem value=\"high\">High</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"due_date\">Due Date *</Label>\n              <Input\n                id=\"due_date\"\n                type=\"date\"\n                value={formData.due_date}\n                onChange={e => handleChange('due_date', e.target.value)}\n                required\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"assigned_to\">Assign To</Label>\n              <Select\n                value={formData.assigned_to_id}\n                onValueChange={val => handleChange('assigned_to_id', val)}\n              >\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Unassigned\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {users.map(u => (\n                    <SelectItem key={u.id} value={u.id}>\n                      {u.name}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"description\">Description</Label>\n            <Textarea\n              id=\"description\"\n              value={formData.description}\n              onChange={e => handleChange('description', e.target.value)}\n              rows={3}\n            />\n          </div>\n\n          <CostForm\n            costs={costs}\n            onAdd={handleAddCost}\n            onRemove={handleRemoveCost}\n            onChange={handleCostChange}\n          />\n\n          <DialogFooter>\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n              Cancel\n            </Button>\n            <Button type=\"submit\" disabled={isLoading}>\n              {isLoading ? 'Saving...' : 'Save Task'}\n            </Button>\n          </DialogFooter>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\ui\\Validation.tsx","messages":[{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 36 to the 15 allowed.","line":137,"column":17,"nodeType":null,"messageId":"refactorFunction","endLine":137,"endColumn":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { AlertCircle, CheckCircle, Info, AlertTriangle } from 'lucide-react';\n\n// Validation Rules\nexport interface ValidationRule {\n  required?: boolean;\n  minLength?: number;\n  maxLength?: number;\n  pattern?: RegExp;\n  custom?: (value: any) => string | null;\n  email?: boolean;\n  url?: boolean;\n  number?: boolean;\n  min?: number;\n  max?: number;\n  match?: string; // Field name to match (for password confirmation)\n}\n\nexport interface ValidationSchema {\n  [fieldName: string]: ValidationRule;\n}\n\nexport interface ValidationErrors {\n  [fieldName: string]: string;\n}\n\n// Built-in validation functions\nexport const Validators = {\n  required:\n    (message = 'This field is required') =>\n    (value: any) => {\n      if (value === null || value === undefined || value === '') {\n        return message;\n      }\n      if (Array.isArray(value) && value.length === 0) {\n        return message;\n      }\n      return null;\n    },\n\n  email:\n    (message = 'Please enter a valid email address') =>\n    (value: string) => {\n      if (!value) return null;\n      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n      if (!emailRegex.test(value)) {\n        return message;\n      }\n      return null;\n    },\n\n  url:\n    (message = 'Please enter a valid URL') =>\n    (value: string) => {\n      if (!value) return null;\n      try {\n        new URL(value);\n        return null;\n      } catch {\n        return message;\n      }\n    },\n\n  minLength: (min: number, message?: string) => (value: string) => {\n    if (!value) return null;\n    if (value.length < min) {\n      return message || `Must be at least ${min} characters long`;\n    }\n    return null;\n  },\n\n  maxLength: (max: number, message?: string) => (value: string) => {\n    if (!value) return null;\n    if (value.length > max) {\n      return message || `Must be no more than ${max} characters long`;\n    }\n    return null;\n  },\n\n  pattern:\n    (pattern: RegExp, message = 'Invalid format') =>\n    (value: string) => {\n      if (!value) return null;\n      if (!pattern.test(value)) {\n        return message;\n      }\n      return null;\n    },\n\n  number:\n    (message = 'Please enter a valid number') =>\n    (value: any) => {\n      if (value === null || value === undefined || value === '') return null;\n      if (isNaN(Number(value))) {\n        return message;\n      }\n      return null;\n    },\n\n  min: (min: number, message?: string) => (value: any) => {\n    if (value === null || value === undefined || value === '') return null;\n    const numValue = Number(value);\n    if (isNaN(numValue)) return null;\n    if (numValue < min) {\n      return message || `Must be at least ${min}`;\n    }\n    return null;\n  },\n\n  max: (max: number, message?: string) => (value: any) => {\n    if (value === null || value === undefined || value === '') return null;\n    const numValue = Number(value);\n    if (isNaN(numValue)) return null;\n    if (numValue > max) {\n      return message || `Must be no more than ${max}`;\n    }\n    return null;\n  },\n\n  match:\n    (fieldName: string, message = 'Fields do not match') =>\n    (value: any, values: any) => {\n      if (value !== values[fieldName]) {\n        return message;\n      }\n      return null;\n    },\n\n  custom:\n    (validator: (value: any, values?: any) => string | null, message = 'Invalid value') =>\n    (value: any, values?: any) => {\n      return validator(value, values);\n    },\n};\n\n// Main validation function\nexport function validateField(\n  value: any,\n  fieldName: string,\n  rule: ValidationRule,\n  allValues?: any\n): string | null {\n  // Required validation\n  if (rule.required) {\n    const requiredError = Validators.required()(value);\n    if (requiredError) return requiredError;\n  }\n\n  // Skip other validations if field is empty and not required\n  if (!value && !rule.required) return null;\n\n  // Type-specific validations\n  if (rule.email) {\n    const emailError = Validators.email()(value);\n    if (emailError) return emailError;\n  }\n\n  if (rule.url) {\n    const urlError = Validators.url()(value);\n    if (urlError) return urlError;\n  }\n\n  if (rule.number) {\n    const numberError = Validators.number()(value);\n    if (numberError) return numberError;\n  }\n\n  // Length validations\n  if (rule.minLength) {\n    const minLengthError = Validators.minLength(rule.minLength)(value);\n    if (minLengthError) return minLengthError;\n  }\n\n  if (rule.maxLength) {\n    const maxLengthError = Validators.maxLength(rule.maxLength)(value);\n    if (maxLengthError) return maxLengthError;\n  }\n\n  // Pattern validation\n  if (rule.pattern) {\n    const patternError = Validators.pattern(rule.pattern)(value);\n    if (patternError) return patternError;\n  }\n\n  // Numeric range validations\n  if (rule.min !== undefined) {\n    const minError = Validators.min(rule.min)(value);\n    if (minError) return minError;\n  }\n\n  if (rule.max !== undefined) {\n    const maxError = Validators.max(rule.max)(value);\n    if (maxError) return maxError;\n  }\n\n  // Match validation\n  if (rule.match && allValues) {\n    const matchError = Validators.match(rule.match)(value, allValues);\n    if (matchError) return matchError;\n  }\n\n  // Custom validation\n  if (rule.custom) {\n    const customError = rule.custom(value);\n    if (customError) return customError;\n  }\n\n  return null;\n}\n\n// Validate entire form\nexport function validateForm(values: any, schema: ValidationSchema): ValidationErrors {\n  const errors: ValidationErrors = {};\n\n  for (const [fieldName, rule] of Object.entries(schema)) {\n    const error = validateField(values[fieldName], fieldName, rule, values);\n    if (error) {\n      errors[fieldName] = error;\n    }\n  }\n\n  return errors;\n}\n\n// Validation status component\ninterface ValidationStatusProps {\n  errors: ValidationErrors;\n  fieldName: string;\n  touched: boolean;\n  className?: string;\n}\n\nexport function ValidationStatus({\n  errors,\n  fieldName,\n  touched,\n  className = '',\n}: ValidationStatusProps) {\n  const hasError = touched && errors[fieldName];\n  const isValid = touched && !errors[fieldName];\n\n  if (!touched) return null;\n\n  return (\n    <div className={`flex items-center gap-1 text-sm ${className}`}>\n      {hasError && (\n        <>\n          <AlertCircle className=\"h-4 w-4 text-red-500\" />\n          <span className=\"text-red-600\">{errors[fieldName]}</span>\n        </>\n      )}\n      {isValid && (\n        <>\n          <CheckCircle className=\"h-4 w-4 text-green-500\" />\n          <span className=\"text-green-600\">Looks good!</span>\n        </>\n      )}\n    </div>\n  );\n}\n\n// Form validation hook\nexport function useFormValidation(initialValues: any, validationSchema: ValidationSchema) {\n  const [values, setValues] = React.useState(initialValues);\n  const [errors, setErrors] = React.useState<ValidationErrors>({});\n  const [touched, setTouchedFields] = React.useState<Record<string, boolean>>({});\n\n  const validateSingleField = React.useCallback(\n    (fieldName: string, value: any) => {\n      const rule = validationSchema[fieldName];\n      if (!rule) return null;\n\n      return validateField(value, fieldName, rule, values);\n    },\n    [validationSchema, values]\n  );\n\n  const validateAllFields = React.useCallback(() => {\n    const newErrors = validateForm(values, validationSchema);\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  }, [values, validationSchema]);\n\n  const setValue = React.useCallback(\n    (fieldName: string, value: any) => {\n      setValues((prev: any) => ({ ...prev, [fieldName]: value }));\n\n      // Clear error when user starts typing\n      if (errors[fieldName]) {\n        setErrors(prev => ({ ...prev, [fieldName]: '' }));\n      }\n    },\n    [errors]\n  );\n\n  const setFieldTouched = React.useCallback((fieldName: string) => {\n    setTouchedFields(prev => ({ ...prev, [fieldName]: true }));\n  }, []);\n\n  const setFieldError = React.useCallback((fieldName: string, error: string) => {\n    setErrors(prev => ({ ...prev, [fieldName]: error }));\n  }, []);\n\n  const clearError = React.useCallback((fieldName: string) => {\n    setErrors(prev => ({ ...prev, [fieldName]: '' }));\n  }, []);\n\n  const reset = React.useCallback(() => {\n    setValues(initialValues);\n    setErrors({});\n    setTouchedFields({});\n  }, [initialValues]);\n\n  const isValid = React.useMemo(() => {\n    return Object.keys(errors).length === 0;\n  }, [errors]);\n\n  return {\n    values,\n    errors,\n    touched,\n    isValid,\n    setValue,\n    setFieldTouched,\n    setFieldError,\n    clearError,\n    validateField: validateSingleField,\n    validateAllFields,\n    reset,\n  };\n}\n\n// Password strength validator\nexport function validatePasswordStrength(password: string): {\n  score: number;\n  feedback: string[];\n  isStrong: boolean;\n} {\n  const feedback: string[] = [];\n  let score = 0;\n\n  if (password.length >= 8) {\n    score += 1;\n  } else {\n    feedback.push('Use at least 8 characters');\n  }\n\n  if (/[a-z]/.test(password)) {\n    score += 1;\n  } else {\n    feedback.push('Add lowercase letters');\n  }\n\n  if (/[A-Z]/.test(password)) {\n    score += 1;\n  } else {\n    feedback.push('Add uppercase letters');\n  }\n\n  if (/\\d/.test(password)) {\n    score += 1;\n  } else {\n    feedback.push('Add numbers');\n  }\n\n  if (/[!@#$%^&*(),.?\":{}|<>]/.test(password)) {\n    score += 1;\n  } else {\n    feedback.push('Add special characters');\n  }\n\n  return {\n    score,\n    feedback,\n    isStrong: score >= 4,\n  };\n}\n\n// Password strength component\ninterface PasswordStrengthProps {\n  password: string;\n  className?: string;\n}\n\nexport function PasswordStrength({ password, className = '' }: PasswordStrengthProps) {\n  const { score, feedback, isStrong } = validatePasswordStrength(password);\n\n  if (!password) return null;\n\n  const getStrengthColor = () => {\n    if (score <= 1) return 'bg-red-500';\n    if (score <= 2) return 'bg-orange-500';\n    if (score <= 3) return 'bg-yellow-500';\n    return 'bg-green-500';\n  };\n\n  const getStrengthText = () => {\n    if (score <= 1) return 'Weak';\n    if (score <= 2) return 'Fair';\n    if (score <= 3) return 'Good';\n    return 'Strong';\n  };\n\n  return (\n    <div className={`space-y-2 ${className}`}>\n      <div className=\"flex items-center gap-2\">\n        <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n          <div\n            className={`h-2 rounded-full transition-all duration-300 ${getStrengthColor()}`}\n            style={{ width: `${(score / 5) * 100}%` }}\n          />\n        </div>\n        <span\n          className={`text-sm font-medium ${\n            isStrong ? 'text-green-600' : score <= 2 ? 'text-red-600' : 'text-orange-600'\n          }`}\n        >\n          {getStrengthText()}\n        </span>\n      </div>\n\n      {feedback.length > 0 && (\n        <div className=\"space-y-1\">\n          {feedback.map((item, index) => (\n            <div key={index} className=\"flex items-center gap-1 text-sm text-gray-600\">\n              <Info className=\"h-3 w-3\" />\n              {item}\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Phone number validator\nexport function validatePhoneNumber(phone: string): {\n  isValid: boolean;\n  formatted: string;\n  error?: string;\n} {\n  if (!phone) return { isValid: true, formatted: '' };\n\n  // Remove all non-digit characters\n  const digits = phone.replace(/\\D/g, '');\n\n  // Check if it's a valid length (10-15 digits)\n  if (digits.length < 10 || digits.length > 15) {\n    return {\n      isValid: false,\n      formatted: phone,\n      error: 'Phone number must be 10-15 digits',\n    };\n  }\n\n  // Format the phone number\n  let formatted = digits;\n  if (digits.length === 10) {\n    // US format: (XXX) XXX-XXXX\n    formatted = `(${digits.slice(0, 3)}) ${digits.slice(3, 6)}-${digits.slice(6)}`;\n  } else if (digits.length === 11 && digits.startsWith('1')) {\n    // US format with country code: +1 (XXX) XXX-XXXX\n    formatted = `+1 (${digits.slice(1, 4)}) ${digits.slice(4, 7)}-${digits.slice(7)}`;\n  }\n\n  return {\n    isValid: true,\n    formatted,\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\ui\\dialog.tsx","messages":[{"ruleId":"jsx-a11y/click-events-have-key-events","severity":2,"message":"Visible, non-interactive elements with click handlers must have at least one keyboard listener.","line":66,"column":7,"nodeType":"JSXOpeningElement","endLine":66,"endColumn":88},{"ruleId":"jsx-a11y/no-static-element-interactions","severity":2,"message":"Avoid non-native interactive elements. If using native HTML is not possible, add an appropriate role and support for tabbing, mouse, keyboard, and touch inputs to an interactive content element.","line":66,"column":7,"nodeType":"JSXOpeningElement","endLine":66,"endColumn":88}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { X } from 'lucide-react';\n\nimport { cn } from '../../lib/utils';\n\ninterface DialogProps {\n  open?: boolean;\n  onOpenChange?: (open: boolean) => void;\n  children: React.ReactNode;\n}\n\ninterface DialogContentProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\ninterface DialogHeaderProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\ninterface DialogTitleProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\ninterface DialogDescriptionProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\ninterface DialogTriggerProps {\n  asChild?: boolean;\n  children: React.ReactNode;\n}\n\nconst DialogContext = React.createContext<{\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}>({ open: false, onOpenChange: () => {} });\n\nconst Dialog = ({ open = false, onOpenChange = () => {}, children }: DialogProps) => {\n  return <DialogContext.Provider value={{ open, onOpenChange }}>{children}</DialogContext.Provider>;\n};\n\nconst DialogTrigger = ({ asChild, children }: DialogTriggerProps) => {\n  const { onOpenChange } = React.useContext(DialogContext);\n\n  if (asChild && React.isValidElement(children)) {\n    return React.cloneElement(children, {\n      onClick: () => onOpenChange(true),\n    });\n  }\n\n  return <button onClick={() => onOpenChange(true)}>{children}</button>;\n};\n\nconst DialogContent = ({ children, className }: DialogContentProps) => {\n  const { open, onOpenChange } = React.useContext(DialogContext);\n\n  if (!open) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\n      {/* Backdrop */}\n      <div className=\"fixed inset-0 bg-black/50\" onClick={() => onOpenChange(false)} />\n\n      {/* Content */}\n      <div\n        className={cn(\n          'relative z-50 w-full max-w-lg mx-4 bg-white rounded-lg shadow-lg p-6',\n          className\n        )}\n      >\n        <button\n          className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\"\n          onClick={() => onOpenChange(false)}\n        >\n          <X className=\"h-4 w-4\" />\n          <span className=\"sr-only\">Close</span>\n        </button>\n        {children}\n      </div>\n    </div>\n  );\n};\n\nconst DialogHeader = ({ children, className }: DialogHeaderProps) => {\n  return (\n    <div className={cn('flex flex-col space-y-1.5 text-center sm:text-left', className)}>\n      {children}\n    </div>\n  );\n};\n\nconst DialogTitle = ({ children, className }: DialogTitleProps) => {\n  return (\n    <h2 className={cn('text-lg font-semibold leading-none tracking-tight', className)}>\n      {children}\n    </h2>\n  );\n};\n\nconst DialogDescription = ({ children, className }: DialogDescriptionProps) => {\n  return <p className={cn('text-sm text-muted-foreground', className)}>{children}</p>;\n};\n\nconst DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => {\n  return (\n    <div\n      className={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}\n      {...props}\n    />\n  );\n};\n\nexport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\components\\ui\\select.tsx","messages":[{"ruleId":"jsx-a11y/click-events-have-key-events","severity":2,"message":"Visible, non-interactive elements with click handlers must have at least one keyboard listener.","line":124,"column":5,"nodeType":"JSXOpeningElement","endLine":130,"endColumn":6},{"ruleId":"jsx-a11y/no-static-element-interactions","severity":2,"message":"Avoid non-native interactive elements. If using native HTML is not possible, add an appropriate role and support for tabbing, mouse, keyboard, and touch inputs to an interactive content element.","line":124,"column":5,"nodeType":"JSXOpeningElement","endLine":130,"endColumn":6}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { ChevronDown } from 'lucide-react';\n\nimport { cn } from '../../lib/utils';\n\ninterface SelectProps {\n  value?: string;\n  defaultValue?: string;\n  onValueChange?: (value: string) => void;\n  children: React.ReactNode;\n  className?: string;\n}\n\ninterface SelectTriggerProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  className?: string;\n  children: React.ReactNode;\n}\n\ninterface SelectContentProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\ninterface SelectItemProps {\n  value: string;\n  children: React.ReactNode;\n  className?: string;\n}\n\ninterface SelectValueProps {\n  placeholder?: string;\n  className?: string;\n}\n\nconst SelectContext = React.createContext<{\n  value?: string;\n  onValueChange?: (value: string) => void;\n  isOpen: boolean;\n  setIsOpen: (open: boolean) => void;\n}>({ isOpen: false, setIsOpen: () => {} });\n\nconst Select = ({\n  value: controlledValue,\n  defaultValue,\n  onValueChange,\n  children,\n  className,\n}: SelectProps) => {\n  const [isOpen, setIsOpen] = React.useState(false);\n  const [internalValue, setInternalValue] = React.useState(defaultValue);\n\n  const isControlled = controlledValue !== undefined;\n  const value = isControlled ? controlledValue : internalValue;\n\n  const handleValueChange = (newValue: string) => {\n    if (!isControlled) {\n      setInternalValue(newValue);\n    }\n    onValueChange?.(newValue);\n  };\n\n  return (\n    <SelectContext.Provider value={{ value, onValueChange: handleValueChange, isOpen, setIsOpen }}>\n      <div className={cn('relative', className)}>{children}</div>\n    </SelectContext.Provider>\n  );\n};\n\nconst SelectTrigger = React.forwardRef<HTMLButtonElement, SelectTriggerProps>(\n  ({ className, children, ...props }, ref) => {\n    const { isOpen, setIsOpen } = React.useContext(SelectContext);\n\n    return (\n      <button\n        ref={ref}\n        type=\"button\"\n        className={cn(\n          'flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',\n          className\n        )}\n        onClick={() => setIsOpen(!isOpen)}\n        {...props}\n      >\n        {children}\n        <ChevronDown className=\"h-4 w-4 opacity-50\" />\n      </button>\n    );\n  }\n);\nSelectTrigger.displayName = 'SelectTrigger';\n\nconst SelectValue = ({ placeholder, className }: SelectValueProps) => {\n  const { value } = React.useContext(SelectContext);\n\n  return <span className={cn('block truncate', className)}>{value || placeholder}</span>;\n};\n\nconst SelectContent = ({ children, className }: SelectContentProps) => {\n  const { isOpen } = React.useContext(SelectContext);\n\n  if (!isOpen) return null;\n\n  return (\n    <div\n      className={cn(\n        'absolute top-full left-0 right-0 z-50 mt-1 max-h-60 overflow-auto rounded-md border bg-popover text-popover-foreground shadow-md',\n        className\n      )}\n    >\n      <div className=\"p-1\">{children}</div>\n    </div>\n  );\n};\n\nconst SelectItem = ({ value, children, className }: SelectItemProps) => {\n  const { onValueChange, setIsOpen } = React.useContext(SelectContext);\n\n  const handleClick = () => {\n    onValueChange?.(value);\n    setIsOpen(false);\n  };\n\n  return (\n    <div\n      className={cn(\n        'relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground cursor-pointer',\n        className\n      )}\n      onClick={handleClick}\n    >\n      {children}\n    </div>\n  );\n};\n\nexport { Select, SelectTrigger, SelectValue, SelectContent, SelectItem };\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\config\\index.ts","messages":[{"ruleId":"sonarjs/no-redundant-boolean","severity":2,"message":"Refactor the code to avoid using this boolean literal.","line":95,"column":40,"nodeType":"Literal","messageId":"removeUnnecessaryBoolean","endLine":95,"endColumn":45}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Unified Configuration System\n// Centralized configuration management for the entire application\n\nimport { featureFlags } from './featureFlags';\nimport { API_CONFIG } from '../api/config';\n\nconst DEFAULT_API_URL = API_CONFIG.baseUrl || '/api';\n\nexport interface AppConfig {\n  // App Information\n  appName: string;\n  appVersion: string;\n  environment: string;\n\n  // API Configuration\n  api: {\n    baseUrl: string;\n    timeout: number;\n    retryAttempts: number;\n    enableCaching: boolean;\n  };\n\n  // UI Configuration\n  ui: {\n    theme: 'light' | 'dark' | 'system';\n    language: string;\n    timezone: string;\n    dateFormat: string;\n    currency: string;\n  };\n\n  // Performance Configuration\n  performance: {\n    enablePerformanceMonitoring: boolean;\n    enableAnalytics: boolean;\n    cacheTimeout: number;\n    maxConcurrentRequests: number;\n  };\n\n  // Feature Flags\n  features: typeof featureFlags;\n\n  // Development Configuration\n  development: {\n    enableDebugMode: boolean;\n    enableHotReload: boolean;\n    enableMockData: boolean;\n  };\n}\n\nconst createAppConfig = (): AppConfig => {\n  const environment = import.meta.env.MODE || 'development';\n  const isDevelopment = environment === 'development';\n  const isProduction = environment === 'production';\n  const isTesting = environment === 'testing';\n\n  return {\n    // App Information\n    appName: 'Farmers Boot',\n    appVersion: '1.0.0',\n    environment,\n\n    // API Configuration\n    api: {\n      baseUrl: DEFAULT_API_URL,\n      timeout: isDevelopment ? 30000 : 45000,\n      retryAttempts: isDevelopment ? 3 : 5,\n      enableCaching: !isTesting,\n    },\n\n    // UI Configuration\n    ui: {\n      theme: (localStorage.getItem('theme') as 'light' | 'dark' | 'system') || 'system',\n      language: localStorage.getItem('language') || 'en',\n      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC',\n      dateFormat: 'YYYY-MM-DD',\n      currency: 'USD',\n    },\n\n    // Performance Configuration\n    performance: {\n      enablePerformanceMonitoring: featureFlags.enablePerformanceMonitoring && !isTesting,\n      enableAnalytics: featureFlags.enableAnalytics && !isTesting,\n      cacheTimeout: isDevelopment ? 300000 : 900000, // 5min dev, 15min prod\n      maxConcurrentRequests: 5,\n    },\n\n    // Feature Flags\n    features: featureFlags,\n\n    // Development Configuration\n    development: {\n      enableDebugMode: isDevelopment,\n      enableHotReload: isDevelopment,\n      enableMockData: isDevelopment && false, // Disabled for clean code\n    },\n  };\n};\n\n// Environment-specific overrides\nconst environmentOverrides: Record<string, Partial<AppConfig>> = {\n  development: {\n    api: {\n      baseUrl: DEFAULT_API_URL,\n      timeout: 30000,\n      retryAttempts: 3,\n      enableCaching: true,\n    },\n    performance: {\n      enablePerformanceMonitoring: true,\n      enableAnalytics: true,\n      cacheTimeout: 300000,\n      maxConcurrentRequests: 10,\n    },\n  },\n\n  production: {\n    api: {\n      baseUrl: DEFAULT_API_URL,\n      timeout: 45000,\n      retryAttempts: 5,\n      enableCaching: true,\n    },\n    performance: {\n      enablePerformanceMonitoring: true,\n      enableAnalytics: true,\n      cacheTimeout: 900000,\n      maxConcurrentRequests: 5,\n    },\n  },\n\n  testing: {\n    api: {\n      baseUrl: DEFAULT_API_URL,\n      timeout: 10000,\n      retryAttempts: 1,\n      enableCaching: false,\n    },\n    performance: {\n      enablePerformanceMonitoring: false,\n      enableAnalytics: false,\n      cacheTimeout: 0,\n      maxConcurrentRequests: 2,\n    },\n  },\n};\n\n// Merge base config with environment-specific overrides\nconst mergeConfigs = (base: AppConfig, override: Partial<AppConfig>): AppConfig => {\n  const merged = { ...base } as Record<string, unknown>;\n\n  for (const key in override) {\n    const overrideValue = override[key as keyof AppConfig];\n    if (\n      typeof overrideValue === 'object' &&\n      overrideValue !== null &&\n      !Array.isArray(overrideValue)\n    ) {\n      merged[key] = {\n        ...((merged[key] as Record<string, unknown>) || {}),\n        ...overrideValue,\n      };\n    } else {\n      merged[key] = overrideValue;\n    }\n  }\n\n  return merged as unknown as AppConfig;\n};\n\n// Configuration storage with localStorage persistence\nclass ConfigManager {\n  private config: AppConfig;\n  private subscribers: Set<(config: AppConfig) => void> = new Set();\n\n  constructor() {\n    const environment = import.meta.env.MODE || 'development';\n    const baseConfig = createAppConfig();\n    const override = environmentOverrides[environment] || {};\n\n    this.config = mergeConfigs(baseConfig, override);\n    this.loadPersistedValues();\n  }\n\n  private loadPersistedValues(): void {\n    // Load persisted UI settings\n    const theme = localStorage.getItem('theme');\n    if (theme && ['light', 'dark', 'system'].includes(theme)) {\n      this.config.ui.theme = theme as 'light' | 'dark' | 'system';\n    }\n\n    const language = localStorage.getItem('language');\n    if (language) {\n      this.config.ui.language = language;\n    }\n  }\n\n  getConfig(): AppConfig {\n    return { ...this.config };\n  }\n\n  updateConfig(updates: Partial<AppConfig>): void {\n    this.config = mergeConfigs(this.config, updates);\n    this.notifySubscribers();\n    this.persistValues();\n  }\n\n  updateUISettings(settings: Partial<AppConfig['ui']>): void {\n    this.config.ui = { ...this.config.ui, ...settings };\n    this.notifySubscribers();\n    this.persistValues();\n  }\n\n  private persistValues(): void {\n    localStorage.setItem('theme', this.config.ui.theme);\n    localStorage.setItem('language', this.config.ui.language);\n  }\n\n  private notifySubscribers(): void {\n    this.subscribers.forEach(subscriber => {\n      subscriber(this.config);\n    });\n  }\n\n  subscribe(subscriber: (config: AppConfig) => void): () => void {\n    this.subscribers.add(subscriber);\n    return () => {\n      this.subscribers.delete(subscriber);\n    };\n  }\n\n  // Helper methods\n  isDevelopment(): boolean {\n    return this.config.environment === 'development';\n  }\n\n  isProduction(): boolean {\n    return this.config.environment === 'production';\n  }\n\n  isTesting(): boolean {\n    return this.config.environment === 'testing';\n  }\n\n  getApiUrl(endpoint: string): string {\n    const baseUrl = this.config.api.baseUrl;\n    return endpoint.startsWith('http') ? endpoint : `${baseUrl}${endpoint}`;\n  }\n\n  isFeatureEnabled(featureFlag: keyof typeof featureFlags): boolean {\n    return this.config.features[featureFlag];\n  }\n}\n\n// Export singleton instance\nexport const config = new ConfigManager();\n\n// Configuration helpers\nexport const getConfig = () => config.getConfig();\nexport const updateConfig = (updates: Partial<AppConfig>) => config.updateConfig(updates);\nexport const updateUI = (settings: Partial<AppConfig['ui']>) => config.updateUISettings(settings);\nexport const isFeatureEnabled = (flag: keyof typeof featureFlags) => config.isFeatureEnabled(flag);\n\nexport const api = {\n  getUrl: (endpoint: string) => config.getApiUrl(endpoint),\n  getTimeout: () => getConfig().api.timeout,\n  getRetryAttempts: () => getConfig().api.retryAttempts,\n  shouldUseCaching: () => getConfig().api.enableCaching,\n};\n\nexport const ui = {\n  getTheme: () => getConfig().ui.theme,\n  getLanguage: () => getConfig().ui.language,\n  getTimezone: () => getConfig().ui.timezone,\n  getDateFormat: () => getConfig().ui.dateFormat,\n  getCurrency: () => getConfig().ui.currency,\n};\n\nexport const performance = {\n  shouldMonitor: () => getConfig().performance.enablePerformanceMonitoring,\n  shouldTrackAnalytics: () => getConfig().performance.enableAnalytics,\n  getCacheTimeout: () => getConfig().performance.cacheTimeout,\n  getMaxConcurrentRequests: () => getConfig().performance.maxConcurrentRequests,\n};\n\nexport const development = {\n  shouldDebug: () => getConfig().development.enableDebugMode,\n  shouldHotReload: () => getConfig().development.enableHotReload,\n  shouldUseMockData: () => getConfig().development.enableMockData,\n};\n\nexport default config;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\hooks\\useAdvancedAnalytics.ts","messages":[{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 17 to the 15 allowed.","line":314,"column":41,"nodeType":null,"messageId":"refactorFunction","endLine":314,"endColumn":43}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { useAuth } from './AuthContext';\n\nexport interface AnalyticsMetric {\n  id: string;\n  name: string;\n  value: number;\n  unit: string;\n  trend: 'up' | 'down' | 'stable';\n  trendPercentage: number;\n  category: 'financial' | 'operational' | 'production' | 'inventory' | 'livestock' | 'crops';\n  timeframe: 'daily' | 'weekly' | 'monthly' | 'quarterly' | 'yearly';\n  lastUpdated: Date;\n  target?: number;\n  benchmark?: number;\n}\n\nexport interface AnalyticsInsight {\n  id: string;\n  type: 'opportunity' | 'risk' | 'recommendation' | 'alert';\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  title: string;\n  description: string;\n  category: string;\n  metrics: string[];\n  suggestedActions: string[];\n  potentialImpact: {\n    financial?: number;\n    efficiency?: number;\n    risk?: number;\n  };\n  confidence: number;\n  createdAt: Date;\n  expiresAt?: Date;\n}\n\nexport interface PredictiveModel {\n  id: string;\n  name: string;\n  type: 'yield_prediction' | 'market_forecast' | 'resource_optimization' | 'risk_assessment';\n  accuracy: number;\n  predictions: Array<{\n    date: Date;\n    value: number;\n    confidence: number;\n    factors: Array<{\n      name: string;\n      impact: number;\n      weight: number;\n    }>;\n  }>;\n  lastTrained: Date;\n  nextTraining: Date;\n}\n\nexport interface PerformanceScore {\n  overall: number;\n  categories: {\n    financial: number;\n    operational: number;\n    production: number;\n    sustainability: number;\n    growth: number;\n  };\n  factors: Array<{\n    name: string;\n    score: number;\n    weight: number;\n    impact: 'positive' | 'negative' | 'neutral';\n  }>;\n  trend: 'improving' | 'declining' | 'stable';\n  period: string;\n}\n\nexport interface BenchmarkComparison {\n  metric: string;\n  yourValue: number;\n  industryAverage: number;\n  topQuartile: number;\n  percentile: number;\n  ranking: 'below_average' | 'average' | 'above_average' | 'top_performer';\n}\n\nexport function useAdvancedAnalytics(farmId: number) {\n  const { getAuthHeaders, isAuthenticated } = useAuth();\n  const queryClient = useQueryClient();\n  const [selectedTimeframe, setSelectedTimeframe] = useState<\n    'daily' | 'weekly' | 'monthly' | 'quarterly' | 'yearly'\n  >('monthly');\n  const [selectedCategories, setSelectedCategories] = useState<string[]>([\n    'financial',\n    'operational',\n    'production',\n  ]);\n  const [customDateRange, setCustomDateRange] = useState<{ start: Date; end: Date } | null>(null);\n\n  // Get analytics metrics\n  const {\n    data: metrics,\n    isLoading: metricsLoading,\n    error: metricsError,\n    refetch: refetchMetrics,\n  } = useQuery({\n    queryKey: ['analytics-metrics', farmId, selectedTimeframe, selectedCategories, customDateRange],\n    queryFn: async () => {\n      const params = new URLSearchParams({\n        farm_id: farmId.toString(),\n        timeframe: selectedTimeframe,\n        categories: selectedCategories.join(','),\n      });\n\n      if (customDateRange) {\n        params.append('start_date', customDateRange.start.toISOString());\n        params.append('end_date', customDateRange.end.toISOString());\n      }\n\n      const response = await fetch(`/api/analytics/metrics?${params}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch analytics metrics');\n      }\n\n      return response.json() as Promise<AnalyticsMetric[]>;\n    },\n    enabled: isAuthenticated(),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    refetchInterval: 10 * 60 * 1000, // 10 minutes\n  });\n\n  // Get AI insights\n  const {\n    data: insights,\n    isLoading: insightsLoading,\n    refetch: refetchInsights,\n  } = useQuery({\n    queryKey: ['analytics-insights', farmId, selectedCategories],\n    queryFn: async () => {\n      const params = new URLSearchParams({\n        farm_id: farmId.toString(),\n        categories: selectedCategories.join(','),\n      });\n\n      const response = await fetch(`/api/analytics/insights?${params}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch analytics insights');\n      }\n\n      return response.json() as Promise<AnalyticsInsight[]>;\n    },\n    enabled: isAuthenticated(),\n    staleTime: 15 * 60 * 1000, // 15 minutes\n    refetchInterval: 30 * 60 * 1000, // 30 minutes\n  });\n\n  // Get predictive models\n  const { data: predictiveModels, isLoading: predictiveLoading } = useQuery({\n    queryKey: ['predictive-models', farmId],\n    queryFn: async () => {\n      const response = await fetch(`/api/analytics/predictive-models?farm_id=${farmId}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch predictive models');\n      }\n\n      return response.json() as Promise<PredictiveModel[]>;\n    },\n    enabled: isAuthenticated(),\n    staleTime: 60 * 60 * 1000, // 1 hour\n    refetchInterval: 6 * 60 * 60 * 1000, // 6 hours\n  });\n\n  // Get performance scores\n  const { data: performanceScore, isLoading: performanceLoading } = useQuery({\n    queryKey: ['performance-score', farmId, selectedTimeframe],\n    queryFn: async () => {\n      const params = new URLSearchParams({\n        farm_id: farmId.toString(),\n        timeframe: selectedTimeframe,\n      });\n\n      const response = await fetch(`/api/analytics/performance-score?${params}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch performance score');\n      }\n\n      return response.json() as Promise<PerformanceScore>;\n    },\n    enabled: isAuthenticated(),\n    staleTime: 10 * 60 * 1000, // 10 minutes\n    refetchInterval: 30 * 60 * 1000, // 30 minutes\n  });\n\n  // Get benchmark comparisons\n  const { data: benchmarks, isLoading: benchmarksLoading } = useQuery({\n    queryKey: ['benchmarks', farmId, selectedCategories],\n    queryFn: async () => {\n      const params = new URLSearchParams({\n        farm_id: farmId.toString(),\n        categories: selectedCategories.join(','),\n      });\n\n      const response = await fetch(`/api/analytics/benchmarks?${params}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch benchmarks');\n      }\n\n      return response.json() as Promise<BenchmarkComparison[]>;\n    },\n    enabled: isAuthenticated(),\n    staleTime: 24 * 60 * 60 * 1000, // 24 hours\n    refetchInterval: 7 * 24 * 60 * 60 * 1000, // 7 days\n  });\n\n  // Generate custom report\n  const generateReport = useCallback(\n    async (reportConfig: {\n      title: string;\n      metrics: string[];\n      timeframe: string;\n      includeInsights: boolean;\n      includePredictions: boolean;\n      format: 'pdf' | 'excel' | 'json';\n    }) => {\n      const response = await fetch('/api/analytics/generate-report', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          farm_id: farmId,\n          ...reportConfig,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to generate report');\n      }\n\n      return response.json();\n    },\n    [farmId, getAuthHeaders]\n  );\n\n  // Calculate key performance indicators\n  const kpis = useMemo(() => {\n    if (!metrics) return {};\n\n    return metrics.reduce(\n      (acc, metric) => {\n        const key = `${metric.category}_${metric.name}`;\n        acc[key] = {\n          value: metric.value,\n          trend: metric.trend,\n          trendPercentage: metric.trendPercentage,\n          target: metric.target,\n          performance: metric.target ? (metric.value / metric.target) * 100 : null,\n        };\n        return acc;\n      },\n      {} as Record<string, any>\n    );\n  }, [metrics]);\n\n  // Get top insights by priority\n  const prioritizedInsights = useMemo(() => {\n    if (!insights) return [];\n\n    const priorityOrder = { critical: 4, high: 3, medium: 2, low: 1 };\n\n    return insights\n      .filter(insight => !insight.expiresAt || insight.expiresAt > new Date())\n      .sort((a, b) => {\n        const priorityDiff = priorityOrder[b.severity] - priorityOrder[a.severity];\n        if (priorityDiff !== 0) return priorityDiff;\n        return b.confidence - a.confidence;\n      });\n  }, [insights]);\n\n  // Calculate trend analysis\n  const trendAnalysis = useMemo(() => {\n    if (!metrics) return {};\n\n    return metrics.reduce(\n      (acc, metric) => {\n        const trend = {\n          direction: metric.trend,\n          magnitude: Math.abs(metric.trendPercentage),\n          significance:\n            metric.trendPercentage > 10 ? 'high' : metric.trendPercentage > 5 ? 'medium' : 'low',\n        };\n        acc[metric.id] = trend;\n        return acc;\n      },\n      {} as Record<string, any>\n    );\n  }, [metrics]);\n\n  // Get performance summary\n  const performanceSummary = useMemo(() => {\n    if (!performanceScore) return null;\n\n    const { overall, categories, trend } = performanceScore;\n\n    return {\n      overall,\n      categories,\n      trend,\n      grade:\n        overall >= 90 ? 'A' : overall >= 80 ? 'B' : overall >= 70 ? 'C' : overall >= 60 ? 'D' : 'F',\n      status:\n        overall >= 80 ? 'excellent' : overall >= 60 ? 'good' : overall >= 40 ? 'fair' : 'poor',\n    };\n  }, [performanceScore]);\n\n  // Benchmark analysis\n  const benchmarkAnalysis = useMemo(() => {\n    if (!benchmarks) return {};\n\n    return benchmarks.reduce(\n      (acc, benchmark) => {\n        acc[benchmark.metric] = {\n          performance: benchmark.percentile,\n          ranking: benchmark.ranking,\n          gap: benchmark.industryAverage - benchmark.yourValue,\n          opportunity: benchmark.topQuartile - benchmark.yourValue,\n        };\n        return acc;\n      },\n      {} as Record<string, any>\n    );\n  }, [benchmarks]);\n\n  // Refresh all analytics data\n  const refreshAllData = useCallback(() => {\n    queryClient.invalidateQueries({ queryKey: ['analytics-metrics'] });\n    queryClient.invalidateQueries({ queryKey: ['analytics-insights'] });\n    queryClient.invalidateQueries({ queryKey: ['predictive-models'] });\n    queryClient.invalidateQueries({ queryKey: ['performance-score'] });\n    queryClient.invalidateQueries({ queryKey: ['benchmarks'] });\n  }, [queryClient]);\n\n  // Export analytics data\n  const exportData = useCallback(\n    async (format: 'json' | 'csv' | 'excel') => {\n      const response = await fetch(`/api/analytics/export?format=${format}&farm_id=${farmId}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to export data');\n      }\n\n      return response.blob();\n    },\n    [farmId, getAuthHeaders]\n  );\n\n  return {\n    // Data\n    metrics: metrics || [],\n    insights: insights || [],\n    predictiveModels: predictiveModels || [],\n    performanceScore,\n    benchmarks: benchmarks || [],\n\n    // Loading states\n    isLoading:\n      metricsLoading ||\n      insightsLoading ||\n      predictiveLoading ||\n      performanceLoading ||\n      benchmarksLoading,\n    error: metricsError,\n\n    // Computed values\n    kpis,\n    prioritizedInsights,\n    trendAnalysis,\n    performanceSummary,\n    benchmarkAnalysis,\n\n    // State management\n    selectedTimeframe,\n    setSelectedTimeframe,\n    selectedCategories,\n    setSelectedCategories,\n    customDateRange,\n    setCustomDateRange,\n\n    // Actions\n    generateReport,\n    refreshAllData,\n    exportData,\n    refetchMetrics,\n    refetchInsights,\n  };\n}\n\n// Helper hook for real-time analytics updates\nexport function useRealTimeAnalytics(farmId: number) {\n  const [realTimeMetrics, setRealTimeMetrics] = useState<AnalyticsMetric[]>([]);\n  const [isConnected, setIsConnected] = useState(false);\n  const { getAuthHeaders } = useAuth();\n\n  useEffect(() => {\n    if (!farmId) return;\n\n    // WebSocket connection for real-time updates\n    const ws = new WebSocket(\n      `${window.location.protocol === 'https:' ? 'wss:' : 'ws:'}//${window.location.host}/api/analytics/realtime?farm_id=${farmId}`\n    );\n\n    ws.onopen = () => {\n      setIsConnected(true);\n      console.log('Real-time analytics connected');\n    };\n\n    ws.onmessage = event => {\n      const data = JSON.parse(event.data);\n      setRealTimeMetrics(prev => {\n        const existingIndex = prev.findIndex(m => m.id === data.id);\n        if (existingIndex >= 0) {\n          const updated = [...prev];\n          updated[existingIndex] = { ...updated[existingIndex], ...data };\n          return updated;\n        }\n        return [...prev, data];\n      });\n    };\n\n    ws.onclose = () => {\n      setIsConnected(false);\n      console.log('Real-time analytics disconnected');\n    };\n\n    ws.onerror = error => {\n      console.error('WebSocket error:', error);\n      setIsConnected(false);\n    };\n\n    return () => {\n      ws.close();\n    };\n  }, [farmId]);\n\n  return {\n    realTimeMetrics,\n    isConnected,\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\hooks\\useDashboardCustomization.ts","messages":[{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 12 times.","line":58,"column":11,"nodeType":"Literal","messageId":"defineConstant","endLine":58,"endColumn":24},{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 3 times.","line":93,"column":11,"nodeType":"Literal","messageId":"defineConstant","endLine":93,"endColumn":25},{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 3 times.","line":228,"column":16,"nodeType":"Literal","messageId":"defineConstant","endLine":228,"endColumn":35}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useAuth } from './AuthContext';\n\nexport interface DashboardWidget {\n  id: string;\n  type:\n    | 'metric-card'\n    | 'chart'\n    | 'table'\n    | 'map'\n    | 'alert'\n    | 'quick-action'\n    | 'weather'\n    | 'calendar';\n  title: string;\n  size: 'small' | 'medium' | 'large' | 'full';\n  position: { x: number; y: number };\n  data?: any;\n  config?: Record<string, any>;\n  isMinimized?: boolean;\n  isVisible?: boolean;\n  refreshInterval?: number;\n  lastUpdated?: Date;\n}\n\nexport interface DashboardLayout {\n  id: string;\n  name: string;\n  description?: string;\n  widgets: DashboardWidget[];\n  columns: number;\n  rowHeight: number;\n  isDefault: boolean;\n  isPublic: boolean;\n  role?: string;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface DashboardTemplate {\n  id: string;\n  name: string;\n  description: string;\n  category: 'farm' | 'livestock' | 'crops' | 'finance' | 'operations' | 'analytics';\n  role: 'owner' | 'manager' | 'worker' | 'accounting' | 'admin';\n  widgets: Omit<DashboardWidget, 'id' | 'position'>[];\n  layout: {\n    columns: number;\n    rowHeight: number;\n    defaultPositions: Array<{ type: string; x: number; y: number; w: number; h: number }>;\n  };\n}\n\nconst defaultWidgets: DashboardWidget[] = [\n  {\n    id: 'farm-overview',\n    type: 'metric-card',\n    title: 'Farm Overview',\n    size: 'medium',\n    position: { x: 0, y: 0 },\n    config: { metrics: ['animals', 'crops', 'fields', 'tasks'] },\n    refreshInterval: 30000,\n  },\n  {\n    id: 'financial-summary',\n    type: 'metric-card',\n    title: 'Financial Summary',\n    size: 'medium',\n    position: { x: 1, y: 0 },\n    config: { metrics: ['revenue', 'expenses', 'profit'] },\n    refreshInterval: 60000,\n  },\n  {\n    id: 'weather-widget',\n    type: 'weather',\n    title: 'Weather',\n    size: 'small',\n    position: { x: 2, y: 0 },\n    refreshInterval: 300000,\n  },\n  {\n    id: 'recent-alerts',\n    type: 'alert',\n    title: 'Recent Alerts',\n    size: 'medium',\n    position: { x: 0, y: 1 },\n    config: { maxItems: 5, severity: ['error', 'warning'] },\n    refreshInterval: 15000,\n  },\n  {\n    id: 'quick-actions',\n    type: 'quick-action',\n    title: 'Quick Actions',\n    size: 'medium',\n    position: { x: 1, y: 1 },\n    config: { actions: ['add-task', 'log-expense', 'update-inventory'] },\n  },\n  {\n    id: 'task-progress',\n    type: 'chart',\n    title: 'Task Progress',\n    size: 'large',\n    position: { x: 0, y: 2 },\n    config: { chartType: 'pie', timeRange: '7d' },\n    refreshInterval: 30000,\n  },\n];\n\nconst dashboardTemplates: DashboardTemplate[] = [\n  {\n    id: 'farm-owner',\n    name: 'Farm Owner Dashboard',\n    description: 'Comprehensive overview for farm owners',\n    category: 'farm',\n    role: 'owner',\n    widgets: [\n      {\n        type: 'metric-card',\n        title: 'Farm Performance',\n        size: 'large',\n        config: { metrics: ['overview'] },\n      },\n      {\n        type: 'metric-card',\n        title: 'Financial Health',\n        size: 'medium',\n        config: { metrics: ['financial'] },\n      },\n      { type: 'chart', title: 'Revenue Trends', size: 'large', config: { chartType: 'line' } },\n      { type: 'alert', title: 'Critical Alerts', size: 'medium', config: { severity: ['error'] } },\n      { type: 'quick-action', title: 'Management Actions', size: 'medium' },\n    ],\n    layout: {\n      columns: 3,\n      rowHeight: 100,\n      defaultPositions: [\n        { type: 'metric-card', x: 0, y: 0, w: 2, h: 2 },\n        { type: 'metric-card', x: 2, y: 0, w: 1, h: 1 },\n        { type: 'chart', x: 0, y: 2, w: 2, h: 2 },\n        { type: 'alert', x: 2, y: 1, w: 1, h: 1 },\n        { type: 'quick-action', x: 2, y: 2, w: 1, h: 1 },\n      ],\n    },\n  },\n  {\n    id: 'livestock-manager',\n    name: 'Livestock Manager',\n    description: 'Focused on animal health and production',\n    category: 'livestock',\n    role: 'manager',\n    widgets: [\n      {\n        type: 'metric-card',\n        title: 'Animal Health',\n        size: 'medium',\n        config: { metrics: ['health'] },\n      },\n      {\n        type: 'metric-card',\n        title: 'Production Metrics',\n        size: 'medium',\n        config: { metrics: ['production'] },\n      },\n      { type: 'chart', title: 'Weight Trends', size: 'large', config: { chartType: 'line' } },\n      {\n        type: 'alert',\n        title: 'Health Alerts',\n        size: 'small',\n        config: { severity: ['warning', 'error'] },\n      },\n      { type: 'table', title: 'Recent Treatments', size: 'medium', config: { limit: 10 } },\n    ],\n    layout: {\n      columns: 3,\n      rowHeight: 100,\n      defaultPositions: [\n        { type: 'metric-card', x: 0, y: 0, w: 1, h: 1 },\n        { type: 'metric-card', x: 1, y: 0, w: 1, h: 1 },\n        { type: 'chart', x: 0, y: 1, w: 2, h: 2 },\n        { type: 'alert', x: 2, y: 0, w: 1, h: 1 },\n        { type: 'table', x: 2, y: 1, w: 1, h: 2 },\n      ],\n    },\n  },\n  {\n    id: 'crop-specialist',\n    name: 'Crop Management',\n    description: 'Crop monitoring and planning',\n    category: 'crops',\n    role: 'manager',\n    widgets: [\n      { type: 'metric-card', title: 'Crop Status', size: 'medium', config: { metrics: ['crops'] } },\n      { type: 'chart', title: 'Yield Analysis', size: 'large', config: { chartType: 'bar' } },\n      { type: 'weather', title: 'Weather Forecast', size: 'small' },\n      { type: 'alert', title: 'Pest & Disease Alerts', size: 'medium' },\n      { type: 'calendar', title: 'Planting Schedule', size: 'medium' },\n    ],\n    layout: {\n      columns: 3,\n      rowHeight: 100,\n      defaultPositions: [\n        { type: 'metric-card', x: 0, y: 0, w: 1, h: 1 },\n        { type: 'chart', x: 0, y: 1, w: 2, h: 2 },\n        { type: 'weather', x: 1, y: 0, w: 1, h: 1 },\n        { type: 'alert', x: 2, y: 0, w: 1, h: 1 },\n        { type: 'calendar', x: 2, y: 1, w: 1, h: 2 },\n      ],\n    },\n  },\n];\n\nexport function useDashboardCustomization(farmId: number) {\n  const { getAuthHeaders } = useAuth();\n  const queryClient = useQueryClient();\n\n  const [currentLayout, setCurrentLayout] = useState<DashboardLayout | null>(null);\n  const [isEditing, setIsEditing] = useState(false);\n  const [selectedWidget, setSelectedWidget] = useState<string | null>(null);\n  const [draggedWidget, setDraggedWidget] = useState<string | null>(null);\n\n  // Get user's dashboard layouts\n  const {\n    data: layouts,\n    isLoading: layoutsLoading,\n    error: layoutsError,\n  } = useQuery({\n    queryKey: ['dashboard-layouts', farmId],\n    queryFn: async () => {\n      const response = await fetch(`/api/dashboard-layouts?farm_id=${farmId}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch dashboard layouts');\n      }\n\n      return response.json() as Promise<DashboardLayout[]>;\n    },\n    enabled: !!farmId,\n  });\n\n  // Save layout mutation\n  const saveLayoutMutation = useMutation({\n    mutationFn: async (layout: Partial<DashboardLayout>) => {\n      const response = await fetch('/api/dashboard-layouts', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          ...layout,\n          farm_id: farmId,\n          widgets: layout.widgets || currentLayout?.widgets || [],\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to save layout');\n      }\n\n      return response.json() as Promise<DashboardLayout>;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['dashboard-layouts', farmId] });\n    },\n  });\n\n  // Update widget mutation\n  const updateWidgetMutation = useMutation({\n    mutationFn: async ({\n      widgetId,\n      updates,\n    }: {\n      widgetId: string;\n      updates: Partial<DashboardWidget>;\n    }) => {\n      const response = await fetch(`/api/dashboard-layouts/widgets/${widgetId}`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify(updates),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to update widget');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['dashboard-layouts', farmId] });\n    },\n  });\n\n  const createLayoutFromTemplate = useCallback((template: DashboardTemplate, name: string) => {\n    const widgets: DashboardWidget[] = template.widgets.map((widget, index) => ({\n      ...widget,\n      id: `${template.id}-${index}-${Date.now()}`,\n      position: template.layout.defaultPositions[index] || { x: 0, y: index },\n      isVisible: true,\n      isMinimized: false,\n    }));\n\n    const newLayout: DashboardLayout = {\n      id: `layout-${Date.now()}`,\n      name,\n      description: template.description,\n      widgets,\n      columns: template.layout.columns,\n      rowHeight: template.layout.rowHeight,\n      isDefault: false,\n      isPublic: false,\n      role: template.role,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    return newLayout;\n  }, []);\n\n  const addWidget = useCallback(\n    (widget: Omit<DashboardWidget, 'id'>) => {\n      if (!currentLayout) return;\n\n      const newWidget: DashboardWidget = {\n        ...widget,\n        id: `widget-${Date.now()}`,\n        isVisible: true,\n        isMinimized: false,\n      };\n\n      const updatedLayout = {\n        ...currentLayout,\n        widgets: [...currentLayout.widgets, newWidget],\n        updatedAt: new Date(),\n      };\n\n      setCurrentLayout(updatedLayout);\n      saveLayoutMutation.mutate(updatedLayout);\n    },\n    [currentLayout, saveLayoutMutation]\n  );\n\n  const removeWidget = useCallback(\n    (widgetId: string) => {\n      if (!currentLayout) return;\n\n      const updatedLayout = {\n        ...currentLayout,\n        widgets: currentLayout.widgets.filter(w => w.id !== widgetId),\n        updatedAt: new Date(),\n      };\n\n      setCurrentLayout(updatedLayout);\n      saveLayoutMutation.mutate(updatedLayout);\n    },\n    [currentLayout, saveLayoutMutation]\n  );\n\n  const updateWidget = useCallback(\n    (widgetId: string, updates: Partial<DashboardWidget>) => {\n      if (!currentLayout) return;\n\n      const updatedLayout = {\n        ...currentLayout,\n        widgets: currentLayout.widgets.map(w =>\n          w.id === widgetId ? { ...w, ...updates, lastUpdated: new Date() } : w\n        ),\n        updatedAt: new Date(),\n      };\n\n      setCurrentLayout(updatedLayout);\n      updateWidgetMutation.mutate({ widgetId, updates });\n    },\n    [currentLayout, updateWidgetMutation]\n  );\n\n  const moveWidget = useCallback(\n    (widgetId: string, newPosition: { x: number; y: number }) => {\n      updateWidget(widgetId, { position: newPosition });\n    },\n    [updateWidget]\n  );\n\n  const resizeWidget = useCallback(\n    (widgetId: string, newSize: 'small' | 'medium' | 'large' | 'full') => {\n      updateWidget(widgetId, { size: newSize });\n    },\n    [updateWidget]\n  );\n\n  const toggleWidgetMinimized = useCallback(\n    (widgetId: string) => {\n      if (!currentLayout) return;\n\n      const widget = currentLayout.widgets.find(w => w.id === widgetId);\n      if (widget) {\n        updateWidget(widgetId, { isMinimized: !widget.isMinimized });\n      }\n    },\n    [currentLayout, updateWidget]\n  );\n\n  const toggleWidgetVisibility = useCallback(\n    (widgetId: string) => {\n      if (!currentLayout) return;\n\n      const widget = currentLayout.widgets.find(w => w.id === widgetId);\n      if (widget) {\n        updateWidget(widgetId, { isVisible: !widget.isVisible });\n      }\n    },\n    [currentLayout, updateWidget]\n  );\n\n  const duplicateWidget = useCallback(\n    (widgetId: string) => {\n      if (!currentLayout) return;\n\n      const widget = currentLayout.widgets.find(w => w.id === widgetId);\n      if (widget) {\n        const duplicatedWidget: DashboardWidget = {\n          ...widget,\n          id: `widget-${Date.now()}`,\n          title: `${widget.title} (Copy)`,\n          position: { x: widget.position.x + 1, y: widget.position.y },\n        };\n\n        addWidget(duplicatedWidget);\n      }\n    },\n    [currentLayout, addWidget]\n  );\n\n  const resetToDefault = useCallback(() => {\n    const defaultLayout: DashboardLayout = {\n      id: 'default-layout',\n      name: 'Default Dashboard',\n      widgets: defaultWidgets,\n      columns: 3,\n      rowHeight: 100,\n      isDefault: true,\n      isPublic: false,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    setCurrentLayout(defaultLayout);\n    saveLayoutMutation.mutate(defaultLayout);\n  }, [saveLayoutMutation]);\n\n  const exportLayout = useCallback(() => {\n    if (!currentLayout) return;\n\n    const exportData = {\n      layout: currentLayout,\n      exportedAt: new Date().toISOString(),\n      version: '1.0',\n    };\n\n    const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `dashboard-layout-${currentLayout.name}-${Date.now()}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n  }, [currentLayout]);\n\n  const importLayout = useCallback(\n    (file: File) => {\n      const reader = new FileReader();\n      reader.onload = e => {\n        try {\n          const importData = JSON.parse(e.target?.result as string);\n          const layout = importData.layout as DashboardLayout;\n\n          // Generate new IDs for imported widgets\n          const widgets = layout.widgets.map(w => ({\n            ...w,\n            id: `widget-${Date.now()}-${Math.random()}`,\n          }));\n\n          const importedLayout = {\n            ...layout,\n            id: `layout-${Date.now()}`,\n            name: `${layout.name} (Imported)`,\n            widgets,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n          };\n\n          setCurrentLayout(importedLayout);\n          saveLayoutMutation.mutate(importedLayout);\n        } catch (error) {\n          console.error('Failed to import layout:', error);\n        }\n      };\n      reader.readAsText(file);\n    },\n    [saveLayoutMutation]\n  );\n\n  // Load default layout if none exists\n  useEffect(() => {\n    if (!layoutsLoading && layouts && layouts.length === 0 && !currentLayout) {\n      resetToDefault();\n    } else if (layouts && layouts.length > 0 && !currentLayout) {\n      const defaultLayout = layouts.find(l => l.isDefault) || layouts[0];\n      setCurrentLayout(defaultLayout || null);\n    }\n  }, [layouts, layoutsLoading, currentLayout, resetToDefault]);\n\n  return {\n    // Data\n    layouts,\n    currentLayout,\n    templates: dashboardTemplates,\n    isLoading: layoutsLoading,\n    error: layoutsError,\n\n    // State\n    isEditing,\n    selectedWidget,\n    draggedWidget,\n\n    // Actions\n    setIsEditing,\n    setSelectedWidget,\n    setDraggedWidget,\n\n    // Layout operations\n    saveLayout: saveLayoutMutation.mutate,\n    createFromTemplate: createLayoutFromTemplate,\n    resetToDefault,\n    exportLayout,\n    importLayout,\n\n    // Widget operations\n    addWidget,\n    removeWidget,\n    updateWidget,\n    moveWidget,\n    resizeWidget,\n    toggleWidgetMinimized,\n    toggleWidgetVisibility,\n    duplicateWidget,\n\n    // Mutations status\n    isSaving: saveLayoutMutation.isPending,\n    isUpdating: updateWidgetMutation.isPending,\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\hooks\\useEnhancedInventory.ts","messages":[{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 6 times.","line":116,"column":7,"nodeType":"Literal","messageId":"defineConstant","endLine":116,"endColumn":24},{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 7 times.","line":175,"column":16,"nodeType":"Literal","messageId":"defineConstant","endLine":175,"endColumn":30},{"ruleId":"sonarjs/no-duplicated-branches","severity":2,"message":"This case's code block is the same as the block for the case on line 388.","line":408,"column":9,"nodeType":"SwitchCase","messageId":"sameConditionalBlock","endLine":410,"endColumn":41}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useAuth } from './AuthContext';\n\nexport interface InventoryItem {\n  id: string;\n  name: string;\n  category:\n    | 'seed'\n    | 'fertilizer'\n    | 'pesticide'\n    | 'equipment'\n    | 'feed'\n    | 'medicine'\n    | 'tool'\n    | 'other';\n  sku: string;\n  description?: string;\n  quantity: number;\n  unit: string;\n  minimumStock: number;\n  maximumStock: number;\n  reorderPoint: number;\n  reorderQuantity: number;\n  costPerUnit: number;\n  supplier?: string;\n  location?: string;\n  expiryDate?: Date;\n  batchNumber?: string;\n  status: 'active' | 'inactive' | 'discontinued' | 'backordered';\n  lastUpdated: Date;\n  createdAt: Date;\n  tags: string[];\n  images: string[];\n  specifications: Record<string, any>;\n  usageHistory: Array<{\n    date: Date;\n    quantity: number;\n    purpose: string;\n    userId: string;\n  }>;\n}\n\nexport interface InventoryTransaction {\n  id: string;\n  itemId: string;\n  type: 'purchase' | 'usage' | 'adjustment' | 'transfer' | 'return' | 'waste';\n  quantity: number;\n  unit: string;\n  reason: string;\n  reference?: string;\n  userId: string;\n  timestamp: Date;\n  location?: string;\n  cost?: number;\n  approvedBy?: string;\n  notes?: string;\n}\n\nexport interface StockAlert {\n  id: string;\n  itemId: string;\n  itemName: string;\n  type: 'low_stock' | 'out_of_stock' | 'overstock' | 'expiring' | 'expired';\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  message: string;\n  quantity: number;\n  threshold: number;\n  createdAt: Date;\n  acknowledged: boolean;\n  acknowledgedBy?: string;\n  acknowledgedAt?: Date;\n}\n\nexport interface InventoryReport {\n  id: string;\n  name: string;\n  type: 'stock_level' | 'usage' | 'valuation' | 'expiry' | 'movement';\n  generatedAt: Date;\n  generatedBy: string;\n  filters: {\n    categories?: string[];\n    locations?: string[];\n    dateRange?: { start: Date; end: Date };\n  };\n  data: any;\n  summary: {\n    totalItems: number;\n    totalValue: number;\n    lowStockItems: number;\n    outOfStockItems: number;\n    expiringItems: number;\n  };\n}\n\nexport function useEnhancedInventory(farmId: number) {\n  const { getAuthHeaders, isAuthenticated } = useAuth();\n  const queryClient = useQueryClient();\n  const [selectedCategory, setSelectedCategory] = useState<string>('all');\n  const [searchQuery, setSearchQuery] = useState<string>('');\n  const [sortBy, setSortBy] = useState<'name' | 'quantity' | 'cost' | 'expiry' | 'lastUpdated'>(\n    'name'\n  );\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc');\n  const [showOnlyLowStock, setShowOnlyLowStock] = useState<boolean>(false);\n  const [selectedLocation, setSelectedLocation] = useState<string>('all');\n\n  // Get inventory items\n  const {\n    data: inventoryItems,\n    isLoading: itemsLoading,\n    error: itemsError,\n    refetch: refetchItems,\n  } = useQuery({\n    queryKey: [\n      'inventory-items',\n      farmId,\n      selectedCategory,\n      searchQuery,\n      sortBy,\n      sortOrder,\n      showOnlyLowStock,\n      selectedLocation,\n    ],\n    queryFn: async () => {\n      const params = new URLSearchParams({\n        farm_id: farmId.toString(),\n        category: selectedCategory,\n        search: searchQuery,\n        sort_by: sortBy,\n        sort_order: sortOrder,\n        low_stock_only: showOnlyLowStock.toString(),\n        location: selectedLocation,\n      });\n\n      const response = await fetch(`/api/inventory/items?${params}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch inventory items');\n      }\n\n      return response.json() as Promise<InventoryItem[]>;\n    },\n    enabled: isAuthenticated(),\n    staleTime: 2 * 60 * 1000, // 2 minutes\n    refetchInterval: 5 * 60 * 1000, // 5 minutes\n  });\n\n  // Get inventory transactions\n  const { data: transactions, isLoading: transactionsLoading } = useQuery({\n    queryKey: ['inventory-transactions', farmId],\n    queryFn: async () => {\n      const response = await fetch(`/api/inventory/transactions?farm_id=${farmId}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch inventory transactions');\n      }\n\n      return response.json() as Promise<InventoryTransaction[]>;\n    },\n    enabled: isAuthenticated(),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  // Get stock alerts\n  const {\n    data: stockAlerts,\n    isLoading: alertsLoading,\n    refetch: refetchAlerts,\n  } = useQuery({\n    queryKey: ['stock-alerts', farmId],\n    queryFn: async () => {\n      const response = await fetch(`/api/inventory/alerts?farm_id=${farmId}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch stock alerts');\n      }\n\n      return response.json() as Promise<StockAlert[]>;\n    },\n    enabled: isAuthenticated(),\n    staleTime: 1 * 60 * 1000, // 1 minute\n    refetchInterval: 2 * 60 * 1000, // 2 minutes\n  });\n\n  // Get inventory reports\n  const { data: reports, isLoading: reportsLoading } = useQuery({\n    queryKey: ['inventory-reports', farmId],\n    queryFn: async () => {\n      const response = await fetch(`/api/inventory/reports?farm_id=${farmId}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch inventory reports');\n      }\n\n      return response.json() as Promise<InventoryReport[]>;\n    },\n    enabled: isAuthenticated(),\n    staleTime: 30 * 60 * 1000, // 30 minutes\n  });\n\n  // Mutations\n  const createItemMutation = useMutation({\n    mutationFn: async (\n      item: Omit<InventoryItem, 'id' | 'createdAt' | 'lastUpdated' | 'usageHistory'>\n    ) => {\n      const response = await fetch('/api/inventory/items', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          ...item,\n          farm_id: farmId,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to create inventory item');\n      }\n\n      return response.json() as Promise<InventoryItem>;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['inventory-items'] });\n      queryClient.invalidateQueries({ queryKey: ['stock-alerts'] });\n    },\n  });\n\n  const updateItemMutation = useMutation({\n    mutationFn: async ({ id, updates }: { id: string; updates: Partial<InventoryItem> }) => {\n      const response = await fetch(`/api/inventory/items/${id}`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify(updates),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to update inventory item');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['inventory-items'] });\n      queryClient.invalidateQueries({ queryKey: ['stock-alerts'] });\n    },\n  });\n\n  const deleteItemMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const response = await fetch(`/api/inventory/items/${id}`, {\n        method: 'DELETE',\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to delete inventory item');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['inventory-items'] });\n      queryClient.invalidateQueries({ queryKey: ['stock-alerts'] });\n    },\n  });\n\n  const recordTransactionMutation = useMutation({\n    mutationFn: async (transaction: Omit<InventoryTransaction, 'id' | 'timestamp'>) => {\n      const response = await fetch('/api/inventory/transactions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          ...transaction,\n          farm_id: farmId,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to record inventory transaction');\n      }\n\n      return response.json() as Promise<InventoryTransaction>;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['inventory-items'] });\n      queryClient.invalidateQueries({ queryKey: ['inventory-transactions'] });\n      queryClient.invalidateQueries({ queryKey: ['stock-alerts'] });\n    },\n  });\n\n  const acknowledgeAlertMutation = useMutation({\n    mutationFn: async (alertId: string) => {\n      const response = await fetch(`/api/inventory/alerts/${alertId}/acknowledge`, {\n        method: 'POST',\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to acknowledge alert');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['stock-alerts'] });\n    },\n  });\n\n  const generateReportMutation = useMutation({\n    mutationFn: async (reportConfig: {\n      type: InventoryReport['type'];\n      name: string;\n      filters: any;\n    }) => {\n      const response = await fetch('/api/inventory/reports/generate', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          ...reportConfig,\n          farm_id: farmId,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to generate report');\n      }\n\n      return response.json() as Promise<InventoryReport>;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['inventory-reports'] });\n    },\n  });\n\n  // Computed values\n  const filteredItems = useMemo(() => {\n    if (!inventoryItems) return [];\n\n    let filtered = [...inventoryItems];\n\n    if (selectedCategory !== 'all') {\n      filtered = filtered.filter(item => item.category === selectedCategory);\n    }\n\n    if (searchQuery) {\n      filtered = filtered.filter(\n        item =>\n          item.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n          item.sku.toLowerCase().includes(searchQuery.toLowerCase()) ||\n          item.description?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n          item.tags.some(tag => tag.toLowerCase().includes(searchQuery.toLowerCase()))\n      );\n    }\n\n    if (showOnlyLowStock) {\n      filtered = filtered.filter(item => item.quantity <= item.reorderPoint);\n    }\n\n    if (selectedLocation !== 'all') {\n      filtered = filtered.filter(item => item.location === selectedLocation);\n    }\n\n    // Sort\n    filtered.sort((a, b) => {\n      let aValue: any, bValue: any;\n\n      switch (sortBy) {\n        case 'name':\n          aValue = a.name.toLowerCase();\n          bValue = b.name.toLowerCase();\n          break;\n        case 'quantity':\n          aValue = a.quantity;\n          bValue = b.quantity;\n          break;\n        case 'cost':\n          aValue = a.costPerUnit;\n          bValue = b.costPerUnit;\n          break;\n        case 'expiry':\n          aValue = a.expiryDate?.getTime() || 0;\n          bValue = b.expiryDate?.getTime() || 0;\n          break;\n        case 'lastUpdated':\n          aValue = a.lastUpdated.getTime();\n          bValue = b.lastUpdated.getTime();\n          break;\n        default:\n          aValue = a.name.toLowerCase();\n          bValue = b.name.toLowerCase();\n      }\n\n      if (sortOrder === 'asc') {\n        return aValue > bValue ? 1 : aValue < bValue ? -1 : 0;\n      } else {\n        return aValue < bValue ? 1 : aValue > bValue ? -1 : 0;\n      }\n    });\n\n    return filtered;\n  }, [\n    inventoryItems,\n    selectedCategory,\n    searchQuery,\n    sortBy,\n    sortOrder,\n    showOnlyLowStock,\n    selectedLocation,\n  ]);\n\n  const inventoryStats = useMemo(() => {\n    if (!inventoryItems)\n      return {\n        totalItems: 0,\n        totalValue: 0,\n        lowStockItems: 0,\n        outOfStockItems: 0,\n        expiringItems: 0,\n        expiredItems: 0,\n        categories: {} as Record<string, number>,\n      };\n\n    const stats = {\n      totalItems: inventoryItems.length,\n      totalValue: inventoryItems.reduce((sum, item) => sum + item.quantity * item.costPerUnit, 0),\n      lowStockItems: inventoryItems.filter(\n        item => item.quantity <= item.reorderPoint && item.quantity > 0\n      ).length,\n      outOfStockItems: inventoryItems.filter(item => item.quantity === 0).length,\n      expiringItems: inventoryItems.filter(\n        item =>\n          item.expiryDate &&\n          item.expiryDate > new Date() &&\n          item.expiryDate <= new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)\n      ).length,\n      expiredItems: inventoryItems.filter(item => item.expiryDate && item.expiryDate <= new Date())\n        .length,\n      categories: {} as Record<string, number>,\n    };\n\n    inventoryItems.forEach(item => {\n      stats.categories[item.category] = (stats.categories[item.category] || 0) + 1;\n    });\n\n    return stats;\n  }, [inventoryItems]);\n\n  const criticalAlerts = useMemo(() => {\n    if (!stockAlerts) return [];\n\n    return stockAlerts\n      .filter(alert => !alert.acknowledged && alert.severity === 'critical')\n      .sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\n  }, [stockAlerts]);\n\n  const recentTransactions = useMemo(() => {\n    if (!transactions) return [];\n\n    return transactions.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime()).slice(0, 10);\n  }, [transactions]);\n\n  // Actions\n  const createItem = useCallback(\n    (item: Omit<InventoryItem, 'id' | 'createdAt' | 'lastUpdated' | 'usageHistory'>) => {\n      createItemMutation.mutate(item);\n    },\n    [createItemMutation]\n  );\n\n  const updateItem = useCallback(\n    (id: string, updates: Partial<InventoryItem>) => {\n      updateItemMutation.mutate({ id, updates });\n    },\n    [updateItemMutation]\n  );\n\n  const deleteItem = useCallback(\n    (id: string) => {\n      deleteItemMutation.mutate(id);\n    },\n    [deleteItemMutation]\n  );\n\n  const recordTransaction = useCallback(\n    (transaction: Omit<InventoryTransaction, 'id' | 'timestamp'>) => {\n      recordTransactionMutation.mutate(transaction);\n    },\n    [recordTransactionMutation]\n  );\n\n  const acknowledgeAlert = useCallback(\n    (alertId: string) => {\n      acknowledgeAlertMutation.mutate(alertId);\n    },\n    [acknowledgeAlertMutation]\n  );\n\n  const generateReport = useCallback(\n    (reportConfig: { type: InventoryReport['type']; name: string; filters: any }) => {\n      generateReportMutation.mutate(reportConfig);\n    },\n    [generateReportMutation]\n  );\n\n  const bulkUpdateItems = useCallback(\n    (updates: Array<{ id: string; changes: Partial<InventoryItem> }>) => {\n      const promises = updates.map(({ id, changes }) => updateItem(id, changes));\n      return Promise.all(promises);\n    },\n    [updateItem]\n  );\n\n  const exportInventory = useCallback(\n    async (format: 'csv' | 'excel' | 'json') => {\n      const response = await fetch(`/api/inventory/export?format=${format}&farm_id=${farmId}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to export inventory');\n      }\n\n      return response.blob();\n    },\n    [farmId, getAuthHeaders]\n  );\n\n  const importInventory = useCallback(\n    async (file: File) => {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('farm_id', farmId.toString());\n\n      const response = await fetch('/api/inventory/import', {\n        method: 'POST',\n        headers: getAuthHeaders(),\n        body: formData,\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to import inventory');\n      }\n\n      const result = await response.json();\n      queryClient.invalidateQueries({ queryKey: ['inventory-items'] });\n      queryClient.invalidateQueries({ queryKey: ['stock-alerts'] });\n\n      return result;\n    },\n    [farmId, getAuthHeaders, queryClient]\n  );\n\n  return {\n    // Data\n    inventoryItems: filteredItems,\n    allItems: inventoryItems || [],\n    transactions: transactions || [],\n    stockAlerts: stockAlerts || [],\n    reports: reports || [],\n\n    // Loading states\n    isLoading: itemsLoading || transactionsLoading || alertsLoading || reportsLoading,\n    error: itemsError,\n\n    // Computed values\n    inventoryStats,\n    criticalAlerts,\n    recentTransactions,\n\n    // State management\n    selectedCategory,\n    setSelectedCategory,\n    searchQuery,\n    setSearchQuery,\n    sortBy,\n    setSortOrder,\n    showOnlyLowStock,\n    setShowOnlyLowStock,\n    selectedLocation,\n    setSelectedLocation,\n\n    // Actions\n    createItem,\n    updateItem,\n    deleteItem,\n    recordTransaction,\n    acknowledgeAlert,\n    generateReport,\n    bulkUpdateItems,\n    exportInventory,\n    importInventory,\n    refetchItems,\n    refetchAlerts,\n\n    // Mutation states\n    isCreating: createItemMutation.isPending,\n    isUpdating: updateItemMutation.isPending,\n    isDeleting: deleteItemMutation.isPending,\n    isRecording: recordTransactionMutation.isPending,\n    isGenerating: generateReportMutation.isPending,\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\hooks\\useKeyboardShortcuts.ts","messages":[{"ruleId":"sonarjs/prefer-single-boolean-return","severity":2,"message":"Replace this if-then-else flow by a single return statement.","line":426,"column":9,"nodeType":"IfStatement","messageId":"replaceIfThenElseByReturn","endLine":426,"endColumn":98,"suggestions":[{"messageId":"suggest","fix":{"range":[10538,10648],"text":"return !(shortcut.context && !currentContext.route.startsWith(shortcut.context));"},"desc":"Replace with single return statement"}]},{"ruleId":"sonarjs/prefer-single-boolean-return","severity":2,"message":"Replace this if-then-else flow by a single return statement.","line":560,"column":9,"nodeType":"IfStatement","messageId":"replaceIfThenElseByReturn","endLine":560,"endColumn":98,"suggestions":[{"messageId":"suggest","fix":{"range":[14576,14686],"text":"return !(shortcut.context && !currentContext.route.startsWith(shortcut.context));"},"desc":"Replace with single return statement"}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Keyboard shortcuts system for enhanced user productivity\n// Provides customizable keyboard shortcuts across the entire application\n\nimport { useEffect, useCallback, useState, useRef } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\n\nexport interface KeyboardShortcut {\n  id: string;\n  name: string;\n  description: string;\n  key: string;\n  modifiers: ('ctrl' | 'alt' | 'shift' | 'meta')[];\n  action: () => void | Promise<void>;\n  context?: string; // Route or component context where this shortcut is active\n  global?: boolean; // Available everywhere\n  enabled: boolean;\n  category: 'navigation' | 'actions' | 'data' | 'system' | 'accessibility';\n  priority: number; // Higher priority shortcuts override lower ones\n  lastUsed?: Date;\n  usageCount: number;\n}\n\nexport interface ShortcutContext {\n  route: string;\n  component?: string;\n  isActive: boolean;\n}\n\nexport interface KeyboardShortcutSettings {\n  enabled: boolean;\n  showTooltips: boolean;\n  soundEnabled: boolean;\n  globalShortcuts: {\n    enabled: boolean;\n    interceptInInputs: boolean;\n  };\n  customShortcuts: Record<string, string>; // shortcutId -> key combination\n  disabledContexts: string[]; // Contexts where shortcuts are disabled\n}\n\nconst DEFAULT_SHORTCUTS: KeyboardShortcut[] = [\n  // Navigation shortcuts\n  {\n    id: 'go-home',\n    name: 'Go to Dashboard',\n    description: 'Navigate to the main dashboard',\n    key: 'h',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'navigation',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'go-animals',\n    name: 'Go to Animals',\n    description: 'Navigate to animals management',\n    key: 'a',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'navigation',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'go-crops',\n    name: 'Go to Crops',\n    description: 'Navigate to crops management',\n    key: 'c',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'navigation',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'go-tasks',\n    name: 'Go to Tasks',\n    description: 'Navigate to tasks management',\n    key: 't',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'navigation',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'go-inventory',\n    name: 'Go to Inventory',\n    description: 'Navigate to inventory management',\n    key: 'i',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'navigation',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'go-weather',\n    name: 'Go to Weather',\n    description: 'Navigate to weather information',\n    key: 'w',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'navigation',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'go-search',\n    name: 'Global Search',\n    description: 'Open global search',\n    key: 'k',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'navigation',\n    priority: 15,\n    usageCount: 0,\n    enabled: true,\n  },\n\n  // Action shortcuts\n  {\n    id: 'create-new',\n    name: 'Create New Item',\n    description: 'Create a new item (varies by context)',\n    key: 'n',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'actions',\n    priority: 20,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'save',\n    name: 'Save',\n    description: 'Save current changes',\n    key: 's',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'actions',\n    priority: 25,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'delete',\n    name: 'Delete',\n    description: 'Delete selected item',\n    key: 'Delete',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'actions',\n    priority: 20,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'duplicate',\n    name: 'Duplicate',\n    description: 'Duplicate selected item',\n    key: 'd',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'actions',\n    priority: 15,\n    usageCount: 0,\n    enabled: true,\n  },\n\n  // Data shortcuts\n  {\n    id: 'refresh',\n    name: 'Refresh',\n    description: 'Refresh current data',\n    key: 'r',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'data',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'export',\n    name: 'Export',\n    description: 'Export current data',\n    key: 'e',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'data',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'import',\n    name: 'Import',\n    description: 'Import data',\n    key: 'i',\n    modifiers: ['ctrl', 'shift'],\n    action: () => {},\n    category: 'data',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n\n  // System shortcuts\n  {\n    id: 'help',\n    name: 'Show Help',\n    description: 'Show keyboard shortcuts help',\n    key: '?',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'system',\n    priority: 5,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'settings',\n    name: 'Settings',\n    description: 'Open settings',\n    key: ',',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'system',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'close-modal',\n    name: 'Close Modal',\n    description: 'Close current modal or dialog',\n    key: 'Escape',\n    modifiers: [],\n    action: () => {},\n    category: 'system',\n    priority: 30,\n    usageCount: 0,\n    enabled: true,\n  },\n\n  // Accessibility shortcuts\n  {\n    id: 'focus-search',\n    name: 'Focus Search',\n    description: 'Focus the search input',\n    key: '/',\n    modifiers: [],\n    action: () => {},\n    category: 'accessibility',\n    priority: 10,\n    usageCount: 0,\n    enabled: true,\n  },\n  {\n    id: 'skip-to-content',\n    name: 'Skip to Content',\n    description: 'Skip to main content',\n    key: 'Tab',\n    modifiers: ['ctrl'],\n    action: () => {},\n    category: 'accessibility',\n    priority: 5,\n    usageCount: 0,\n    enabled: true,\n  },\n];\n\nconst DEFAULT_SETTINGS: KeyboardShortcutSettings = {\n  enabled: true,\n  showTooltips: true,\n  soundEnabled: false,\n  globalShortcuts: {\n    enabled: true,\n    interceptInInputs: false,\n  },\n  customShortcuts: {},\n  disabledContexts: [],\n};\n\nexport function useKeyboardShortcuts() {\n  const [shortcuts, setShortcuts] = useState<KeyboardShortcut[]>(DEFAULT_SHORTCUTS);\n  const [settings, setSettings] = useState<KeyboardShortcutSettings>(DEFAULT_SETTINGS);\n  const [isListening, setIsListening] = useState(false);\n  const [currentContext, setCurrentContext] = useState<ShortcutContext>({\n    route: '/',\n    isActive: true,\n  });\n\n  const navigate = useNavigate();\n  const location = useLocation();\n  const activeInputs = useRef<Set<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>>(\n    new Set()\n  );\n  const eventListeners = useRef<{\n    keydown: (e: KeyboardEvent) => void;\n    click: (e: MouseEvent) => void;\n  } | null>(null);\n\n  // Update current context based on location\n  useEffect(() => {\n    setCurrentContext({\n      route: location.pathname,\n      isActive: true,\n    });\n  }, [location.pathname]);\n\n  // Load settings from localStorage\n  useEffect(() => {\n    const saved = localStorage.getItem('farm:keyboard-shortcuts');\n    if (saved) {\n      try {\n        const { shortcuts: savedShortcuts, settings: savedSettings } = JSON.parse(saved);\n        if (savedShortcuts) {\n          setShortcuts(prev =>\n            prev.map(shortcut => ({\n              ...shortcut,\n              ...(savedShortcuts.find((s: { id: string }) => s.id === shortcut.id) || {}),\n            }))\n          );\n        }\n        if (savedSettings) {\n          setSettings({ ...DEFAULT_SETTINGS, ...savedSettings });\n        }\n      } catch (error) {\n        console.error('Error loading keyboard shortcut settings:', error);\n      }\n    }\n  }, []);\n\n  // Save settings to localStorage\n  useEffect(() => {\n    const toSave = {\n      shortcuts: shortcuts.map(s => ({\n        id: s.id,\n        key: s.key,\n        modifiers: s.modifiers,\n        enabled: s.enabled,\n        usageCount: s.usageCount,\n        lastUsed: s.lastUsed,\n      })),\n      settings,\n    };\n    localStorage.setItem('farm:keyboard-shortcuts', JSON.stringify(toSave));\n  }, [shortcuts, settings]);\n\n  // Track active input elements\n  useEffect(() => {\n    const trackInput = (element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement) => {\n      activeInputs.current.add(element);\n    };\n\n    const untrackInput = (element: HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement) => {\n      activeInputs.current.delete(element);\n    };\n\n    // Use event delegation to track input focus/blur\n    const handleFocus = (e: FocusEvent) => {\n      const target = e.target as HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement;\n      if (\n        target.tagName === 'INPUT' ||\n        target.tagName === 'TEXTAREA' ||\n        target.tagName === 'SELECT'\n      ) {\n        trackInput(target);\n      }\n    };\n\n    const handleBlur = (e: FocusEvent) => {\n      const target = e.target as HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement;\n      if (\n        target.tagName === 'INPUT' ||\n        target.tagName === 'TEXTAREA' ||\n        target.tagName === 'SELECT'\n      ) {\n        untrackInput(target);\n      }\n    };\n\n    document.addEventListener('focusin', handleFocus);\n    document.addEventListener('focusout', handleBlur);\n\n    return () => {\n      document.removeEventListener('focusin', handleFocus);\n      document.removeEventListener('focusout', handleBlur);\n    };\n  }, []);\n\n  // Check if an element is an input\n  const isInput = useCallback((element: HTMLElement | null): boolean => {\n    if (!element) return false;\n    const htmlElement = element as HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement;\n    return activeInputs.current.has(htmlElement);\n  }, []);\n\n  // Handle keyboard events\n  const handleKeydown = useCallback(\n    (event: KeyboardEvent) => {\n      if (!settings.enabled || isListening) return;\n\n      // Don't intercept if typing in input fields (unless explicitly enabled)\n      if (!settings.globalShortcuts.interceptInInputs && isInput(event.target as HTMLElement)) {\n        return;\n      }\n\n      // Check if we're in a disabled context\n      if (settings.disabledContexts.includes(currentContext.route)) {\n        return;\n      }\n\n      // Get applicable shortcuts\n      const applicableShortcuts = shortcuts.filter(shortcut => {\n        if (!shortcut.enabled) return false;\n        if (shortcut.context && !currentContext.route.startsWith(shortcut.context)) return false;\n        return true;\n      });\n\n      // Find matching shortcut\n      const matchingShortcut = applicableShortcuts.find(shortcut => {\n        return matchesShortcut(event, shortcut);\n      });\n\n      if (matchingShortcut) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        // Execute shortcut\n        try {\n          matchingShortcut.action();\n          updateShortcutUsage(matchingShortcut.id);\n        } catch (error) {\n          console.error('Error executing keyboard shortcut:', error);\n        }\n      }\n    },\n    [settings, currentContext, shortcuts, isListening, isInput]\n  );\n\n  // Check if an event matches a shortcut\n  const matchesShortcut = useCallback(\n    (event: KeyboardEvent, shortcut: KeyboardShortcut): boolean => {\n      const { key, modifiers } = shortcut;\n\n      // Check main key\n      if (event.key.toLowerCase() !== key.toLowerCase()) {\n        return false;\n      }\n\n      // Check modifiers\n      const hasCtrl = event.ctrlKey || event.metaKey; // meta for Mac\n      const hasAlt = event.altKey;\n      const hasShift = event.shiftKey;\n\n      const ctrlPressed = modifiers.includes('ctrl') || modifiers.includes('meta');\n      const altPressed = modifiers.includes('alt');\n      const shiftPressed = modifiers.includes('shift');\n\n      return hasCtrl === ctrlPressed && hasAlt === altPressed && hasShift === shiftPressed;\n    },\n    []\n  );\n\n  // Update shortcut usage statistics\n  const updateShortcutUsage = useCallback((shortcutId: string) => {\n    setShortcuts(prev =>\n      prev.map(shortcut =>\n        shortcut.id === shortcutId\n          ? {\n              ...shortcut,\n              usageCount: shortcut.usageCount + 1,\n              lastUsed: new Date(),\n            }\n          : shortcut\n      )\n    );\n  }, []);\n\n  // Start listening for shortcut customization\n  const startListening = useCallback(() => {\n    setIsListening(true);\n  }, []);\n\n  // Stop listening for shortcut customization\n  const stopListening = useCallback(() => {\n    setIsListening(false);\n  }, []);\n\n  // Register a new shortcut\n  const registerShortcut = useCallback((shortcut: Omit<KeyboardShortcut, 'usageCount'>) => {\n    setShortcuts(prev => {\n      const existing = prev.find(s => s.id === shortcut.id);\n      if (existing) {\n        return prev.map(s =>\n          s.id === shortcut.id ? { ...shortcut, usageCount: s.usageCount } : s\n        );\n      }\n      return [...prev, { ...shortcut, usageCount: 0 }];\n    });\n  }, []);\n\n  // Unregister a shortcut\n  const unregisterShortcut = useCallback((shortcutId: string) => {\n    setShortcuts(prev => prev.filter(s => s.id !== shortcutId));\n  }, []);\n\n  // Update a shortcut\n  const updateShortcut = useCallback((shortcutId: string, updates: Partial<KeyboardShortcut>) => {\n    setShortcuts(prev =>\n      prev.map(shortcut => (shortcut.id === shortcutId ? { ...shortcut, ...updates } : shortcut))\n    );\n  }, []);\n\n  // Enable/disable a shortcut\n  const toggleShortcut = useCallback((shortcutId: string) => {\n    setShortcuts(prev =>\n      prev.map(shortcut =>\n        shortcut.id === shortcutId ? { ...shortcut, enabled: !shortcut.enabled } : shortcut\n      )\n    );\n  }, []);\n\n  // Update settings\n  const updateSettings = useCallback((updates: Partial<KeyboardShortcutSettings>) => {\n    setSettings(prev => ({ ...prev, ...updates }));\n  }, []);\n\n  // Disable context\n  const disableContext = useCallback((context: string) => {\n    setSettings(prev => ({\n      ...prev,\n      disabledContexts: [...prev.disabledContexts, context],\n    }));\n  }, []);\n\n  // Enable context\n  const enableContext = useCallback((context: string) => {\n    setSettings(prev => ({\n      ...prev,\n      disabledContexts: prev.disabledContexts.filter(c => c !== context),\n    }));\n  }, []);\n\n  // Get shortcuts for current context\n  const getContextShortcuts = useCallback(() => {\n    return shortcuts\n      .filter(shortcut => {\n        if (!shortcut.enabled) return false;\n        if (shortcut.context && !currentContext.route.startsWith(shortcut.context)) return false;\n        return true;\n      })\n      .sort((a, b) => b.priority - a.priority);\n  }, [shortcuts, currentContext]);\n\n  // Get shortcut by ID\n  const getShortcut = useCallback(\n    (shortcutId: string) => {\n      return shortcuts.find(s => s.id === shortcutId);\n    },\n    [shortcuts]\n  );\n\n  // Get shortcuts by category\n  const getShortcutsByCategory = useCallback(\n    (category: KeyboardShortcut['category']) => {\n      return getContextShortcuts().filter(s => s.category === category);\n    },\n    [getContextShortcuts]\n  );\n\n  // Format shortcut for display\n  const formatShortcut = useCallback((shortcut: KeyboardShortcut) => {\n    const parts = [];\n    if (shortcut.modifiers.includes('ctrl') || shortcut.modifiers.includes('meta')) {\n      parts.push('Ctrl');\n    }\n    if (shortcut.modifiers.includes('alt')) {\n      parts.push('Alt');\n    }\n    if (shortcut.modifiers.includes('shift')) {\n      parts.push('Shift');\n    }\n    parts.push(shortcut.key.toUpperCase());\n    return parts.join('+');\n  }, []);\n\n  // Get most used shortcuts\n  const getMostUsedShortcuts = useCallback(\n    (limit = 10) => {\n      return getContextShortcuts()\n        .sort((a, b) => b.usageCount - a.usageCount)\n        .slice(0, limit);\n    },\n    [getContextShortcuts]\n  );\n\n  // Reset usage statistics\n  const resetUsageStats = useCallback(() => {\n    setShortcuts(prev =>\n      prev.map(shortcut => ({\n        ...shortcut,\n        usageCount: 0,\n        lastUsed: undefined,\n      }))\n    );\n  }, []);\n\n  // Test if a key combination is available\n  const isKeyCombinationAvailable = useCallback(\n    (key: string, modifiers: KeyboardShortcut['modifiers'], excludeId?: string) => {\n      return !getContextShortcuts().some(shortcut => {\n        if (shortcut.id === excludeId) return false;\n        if (shortcut.key.toLowerCase() !== key.toLowerCase()) return false;\n\n        const shortcutMods = shortcut.modifiers;\n        const hasCtrl = shortcutMods.includes('ctrl') || shortcutMods.includes('meta');\n        const hasAlt = shortcutMods.includes('alt');\n        const hasShift = shortcutMods.includes('shift');\n\n        const ctrlPressed = modifiers.includes('ctrl') || modifiers.includes('meta');\n        const altPressed = modifiers.includes('alt');\n        const shiftPressed = modifiers.includes('shift');\n\n        return hasCtrl === ctrlPressed && hasAlt === altPressed && hasShift === shiftPressed;\n      });\n    },\n    [getContextShortcuts]\n  );\n\n  // Attach global event listeners\n  useEffect(() => {\n    if (!settings.enabled) return;\n\n    const handleKeydownEvent = (e: KeyboardEvent) => handleKeydown(e);\n\n    // Attach to document for global listening\n    document.addEventListener('keydown', handleKeydownEvent, true);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeydownEvent, true);\n    };\n  }, [settings.enabled, handleKeydown]);\n\n  return {\n    // State\n    shortcuts,\n    settings,\n    isListening,\n    currentContext,\n\n    // Actions\n    registerShortcut,\n    unregisterShortcut,\n    updateShortcut,\n    toggleShortcut,\n    updateSettings,\n    startListening,\n    stopListening,\n    disableContext,\n    enableContext,\n    resetUsageStats,\n\n    // Utilities\n    getContextShortcuts,\n    getShortcut,\n    getShortcutsByCategory,\n    formatShortcut,\n    getMostUsedShortcuts,\n    isKeyCombinationAvailable,\n\n    // Getters\n    shortcutsByCategory: {\n      navigation: getShortcutsByCategory('navigation'),\n      actions: getShortcutsByCategory('actions'),\n      data: getShortcutsByCategory('data'),\n      system: getShortcutsByCategory('system'),\n      accessibility: getShortcutsByCategory('accessibility'),\n    },\n  };\n}\n\n// Helper hook for component-specific shortcuts\nexport function useComponentShortcuts(componentName: string) {\n  const keyboardShortcuts = useKeyboardShortcuts();\n\n  useEffect(() => {\n    keyboardShortcuts.updateSettings({\n      disabledContexts: keyboardShortcuts.settings.disabledContexts.filter(\n        context => !context.includes(componentName)\n      ),\n    });\n  }, [componentName]);\n\n  return keyboardShortcuts;\n}\n\nexport default useKeyboardShortcuts;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\hooks\\useSmartAutomation.ts","messages":[{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 4 times.","line":205,"column":16,"nodeType":"Literal","messageId":"defineConstant","endLine":205,"endColumn":34}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useAuth } from './AuthContext';\n\nexport interface AutomationRule {\n  id: string;\n  name: string;\n  description: string;\n  enabled: boolean;\n  trigger: {\n    type: 'event' | 'schedule' | 'condition' | 'threshold';\n    config: Record<string, any>;\n  };\n  conditions: Array<{\n    field: string;\n    operator: 'equals' | 'not_equals' | 'greater_than' | 'less_than' | 'contains' | 'not_contains';\n    value: any;\n    logicalOperator?: 'and' | 'or';\n  }>;\n  actions: Array<{\n    type: 'create_task' | 'send_notification' | 'update_record' | 'send_email' | 'trigger_webhook';\n    config: Record<string, any>;\n  }>;\n  priority: 'low' | 'medium' | 'high' | 'critical';\n  createdBy: string;\n  createdAt: Date;\n  updatedAt: Date;\n  executionCount: number;\n  lastExecuted?: Date;\n  nextExecution?: Date;\n}\n\nexport interface AutomationExecution {\n  id: string;\n  ruleId: string;\n  ruleName: string;\n  status: 'pending' | 'running' | 'completed' | 'failed' | 'cancelled';\n  startTime: Date;\n  endTime?: Date;\n  triggerData: Record<string, any>;\n  result?: {\n    success: boolean;\n    message: string;\n    data?: any;\n  };\n  error?: string;\n}\n\nexport interface AutomationTemplate {\n  id: string;\n  name: string;\n  description: string;\n  category: 'inventory' | 'livestock' | 'crops' | 'finance' | 'maintenance' | 'weather';\n  icon: string;\n  template: Partial<AutomationRule>;\n}\n\nconst automationTemplates: AutomationTemplate[] = [\n  {\n    id: 'low-stock-alert',\n    name: 'Low Stock Alert',\n    description: 'Automatically notify when inventory items fall below threshold',\n    category: 'inventory',\n    icon: '≡ƒôª',\n    template: {\n      trigger: {\n        type: 'threshold',\n        config: { field: 'quantity', operator: 'less_than', value: 10 },\n      },\n      conditions: [],\n      actions: [\n        {\n          type: 'send_notification',\n          config: { message: 'Low stock alert for {item_name}', priority: 'high' },\n        },\n        {\n          type: 'create_task',\n          config: {\n            title: 'Restock {item_name}',\n            priority: 'medium',\n            assignTo: 'inventory_manager',\n          },\n        },\n      ],\n    },\n  },\n  {\n    id: 'animal-health-check',\n    name: 'Animal Health Monitoring',\n    description: 'Schedule regular health checks for livestock',\n    category: 'livestock',\n    icon: '≡ƒÉä',\n    template: {\n      trigger: {\n        type: 'schedule',\n        config: { frequency: 'weekly', dayOfWeek: 1, time: '09:00' },\n      },\n      conditions: [{ field: 'animal_type', operator: 'equals', value: 'livestock' }],\n      actions: [\n        {\n          type: 'create_task',\n          config: { title: 'Weekly health check', priority: 'medium', assignTo: 'veterinarian' },\n        },\n      ],\n    },\n  },\n  {\n    id: 'crop-harvest-reminder',\n    name: 'Crop Harvest Reminder',\n    description: 'Notify when crops are ready for harvest',\n    category: 'crops',\n    icon: '≡ƒî╛',\n    template: {\n      trigger: {\n        type: 'condition',\n        config: { field: 'growth_stage', operator: 'equals', value: 'mature' },\n      },\n      actions: [\n        {\n          type: 'send_notification',\n          config: { message: 'Crop {crop_name} is ready for harvest', priority: 'high' },\n        },\n        {\n          type: 'create_task',\n          config: { title: 'Harvest {crop_name}', priority: 'high', assignTo: 'farm_manager' },\n        },\n      ],\n    },\n  },\n  {\n    id: 'budget-overrun-alert',\n    name: 'Budget Overrun Alert',\n    description: 'Alert when expenses exceed budget limits',\n    category: 'finance',\n    icon: '≡ƒÆ░',\n    template: {\n      trigger: {\n        type: 'threshold',\n        config: { field: 'monthly_expenses', operator: 'greater_than', value: 5000 },\n      },\n      actions: [\n        {\n          type: 'send_notification',\n          config: { message: 'Monthly expenses exceeded budget', priority: 'critical' },\n        },\n        {\n          type: 'send_email',\n          config: { recipients: ['manager@farm.com'], subject: 'Budget Alert' },\n        },\n      ],\n    },\n  },\n  {\n    id: 'equipment-maintenance',\n    name: 'Equipment Maintenance Schedule',\n    description: 'Schedule regular equipment maintenance',\n    category: 'maintenance',\n    icon: '≡ƒöº',\n    template: {\n      trigger: {\n        type: 'schedule',\n        config: { frequency: 'monthly', day: 1, time: '08:00' },\n      },\n      actions: [\n        {\n          type: 'create_task',\n          config: { title: 'Monthly equipment maintenance', priority: 'medium' },\n        },\n      ],\n    },\n  },\n  {\n    id: 'weather-based-actions',\n    name: 'Weather-Based Actions',\n    description: 'Trigger actions based on weather conditions',\n    category: 'weather',\n    icon: '≡ƒîñ∩╕Å',\n    template: {\n      trigger: {\n        type: 'event',\n        config: { event: 'weather_update' },\n      },\n      conditions: [{ field: 'precipitation', operator: 'greater_than', value: 0.5 }],\n      actions: [\n        {\n          type: 'create_task',\n          config: { title: 'Check irrigation systems', priority: 'medium' },\n        },\n      ],\n    },\n  },\n];\n\nexport function useSmartAutomation(farmId: number) {\n  const { getAuthHeaders, isAuthenticated } = useAuth();\n  const queryClient = useQueryClient();\n\n  // Get automation rules\n  const {\n    data: rules,\n    isLoading: rulesLoading,\n    error: rulesError,\n    refetch: refetchRules,\n  } = useQuery({\n    queryKey: ['automation-rules', farmId],\n    queryFn: async () => {\n      const response = await fetch(`/api/automation/rules?farm_id=${farmId}`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch automation rules');\n      }\n\n      return response.json() as Promise<AutomationRule[]>;\n    },\n    enabled: isAuthenticated(),\n  });\n\n  // Get execution history\n  const { data: executions, isLoading: executionsLoading } = useQuery({\n    queryKey: ['automation-executions', farmId],\n    queryFn: async () => {\n      const response = await fetch(`/api/automation/executions?farm_id=${farmId}&limit=50`, {\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch execution history');\n      }\n\n      return response.json() as Promise<AutomationExecution[]>;\n    },\n    enabled: isAuthenticated(),\n  });\n\n  // Create rule mutation\n  const createRuleMutation = useMutation({\n    mutationFn: async (\n      rule: Omit<AutomationRule, 'id' | 'createdBy' | 'createdAt' | 'updatedAt' | 'executionCount'>\n    ) => {\n      const response = await fetch('/api/automation/rules', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify({\n          ...rule,\n          farm_id: farmId,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to create automation rule');\n      }\n\n      return response.json() as Promise<AutomationRule>;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['automation-rules', farmId] });\n    },\n  });\n\n  // Update rule mutation\n  const updateRuleMutation = useMutation({\n    mutationFn: async ({ id, updates }: { id: string; updates: Partial<AutomationRule> }) => {\n      const response = await fetch(`/api/automation/rules/${id}`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          ...getAuthHeaders(),\n        },\n        body: JSON.stringify(updates),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to update automation rule');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['automation-rules', farmId] });\n    },\n  });\n\n  // Delete rule mutation\n  const deleteRuleMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const response = await fetch(`/api/automation/rules/${id}`, {\n        method: 'DELETE',\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to delete automation rule');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['automation-rules', farmId] });\n    },\n  });\n\n  // Execute rule manually\n  const executeRuleMutation = useMutation({\n    mutationFn: async (ruleId: string) => {\n      const response = await fetch(`/api/automation/rules/${ruleId}/execute`, {\n        method: 'POST',\n        headers: getAuthHeaders(),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to execute automation rule');\n      }\n\n      return response.json() as Promise<AutomationExecution>;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['automation-executions', farmId] });\n    },\n  });\n\n  const createRuleFromTemplate = useCallback(\n    (template: AutomationTemplate, customizations: Partial<AutomationRule>) => {\n      const rule: Omit<\n        AutomationRule,\n        'id' | 'createdBy' | 'createdAt' | 'updatedAt' | 'executionCount'\n      > = {\n        name: template.name,\n        description: template.description,\n        enabled: true,\n        priority: 'medium',\n        trigger: template.template.trigger || { type: 'event', config: {} },\n        conditions: template.template.conditions || [],\n        actions: template.template.actions || [],\n        ...customizations,\n      };\n\n      createRuleMutation.mutate(rule);\n    },\n    [createRuleMutation]\n  );\n\n  const toggleRule = useCallback(\n    (ruleId: string, enabled: boolean) => {\n      updateRuleMutation.mutate({ id: ruleId, updates: { enabled, updatedAt: new Date() } });\n    },\n    [updateRuleMutation]\n  );\n\n  const duplicateRule = useCallback(\n    (rule: AutomationRule) => {\n      const duplicatedRule: Omit<\n        AutomationRule,\n        'id' | 'createdBy' | 'createdAt' | 'updatedAt' | 'executionCount'\n      > = {\n        ...rule,\n        name: `${rule.name} (Copy)`,\n        enabled: false,\n      };\n\n      delete (duplicatedRule as any).id;\n      delete (duplicatedRule as any).createdBy;\n      delete (duplicatedRule as any).createdAt;\n      delete (duplicatedRule as any).updatedAt;\n      delete (duplicatedRule as any).executionCount;\n\n      createRuleMutation.mutate(duplicatedRule);\n    },\n    [createRuleMutation]\n  );\n\n  const testRule = useCallback(\n    (rule: AutomationRule) => {\n      // Create a test execution with mock data\n      const testExecution: Omit<\n        AutomationExecution,\n        'id' | 'startTime' | 'endTime' | 'result' | 'error'\n      > = {\n        ruleId: rule.id,\n        ruleName: rule.name,\n        status: 'pending',\n        triggerData: { test: true, timestamp: new Date().toISOString() },\n      };\n\n      return executeRuleMutation.mutateAsync(rule.id);\n    },\n    [executeRuleMutation]\n  );\n\n  const getRuleStats = useCallback(() => {\n    if (!rules)\n      return { total: 0, enabled: 0, disabled: 0, byPriority: {} as Record<string, number> };\n\n    const stats = {\n      total: rules.length,\n      enabled: rules.filter(r => r.enabled).length,\n      disabled: rules.filter(r => !r.enabled).length,\n      byPriority: {} as Record<string, number>,\n    };\n\n    rules.forEach(rule => {\n      stats.byPriority[rule.priority] = (stats.byPriority[rule.priority] || 0) + 1;\n    });\n\n    return stats;\n  }, [rules]);\n\n  const getExecutionStats = useCallback(() => {\n    if (!executions) return { total: 0, successful: 0, failed: 0, running: 0 };\n\n    return {\n      total: executions.length,\n      successful: executions.filter(e => e.status === 'completed').length,\n      failed: executions.filter(e => e.status === 'failed').length,\n      running: executions.filter(e => e.status === 'running').length,\n    };\n  }, [executions]);\n\n  const validateRule = useCallback(\n    (rule: Partial<AutomationRule>): { isValid: boolean; errors: string[] } => {\n      const errors: string[] = [];\n\n      if (!rule.name?.trim()) {\n        errors.push('Rule name is required');\n      }\n\n      if (!rule.trigger?.type) {\n        errors.push('Trigger type is required');\n      }\n\n      if (!rule.actions || rule.actions.length === 0) {\n        errors.push('At least one action is required');\n      }\n\n      // Validate trigger config\n      if (\n        rule.trigger?.type === 'threshold' &&\n        (!rule.trigger.config?.field || !rule.trigger.config?.operator)\n      ) {\n        errors.push('Threshold trigger requires field and operator');\n      }\n\n      if (rule.trigger?.type === 'schedule' && !rule.trigger.config?.frequency) {\n        errors.push('Schedule trigger requires frequency');\n      }\n\n      // Validate actions\n      rule.actions?.forEach((action, index) => {\n        if (\n          action.type === 'send_email' &&\n          (!action.config?.recipients || action.config.recipients.length === 0)\n        ) {\n          errors.push(`Email action ${index + 1} requires recipients`);\n        }\n        if (action.type === 'create_task' && !action.config?.title) {\n          errors.push(`Task action ${index + 1} requires title`);\n        }\n      });\n\n      return {\n        isValid: errors.length === 0,\n        errors,\n      };\n    },\n    []\n  );\n\n  return {\n    // Data\n    rules: rules || [],\n    executions: executions || [],\n    templates: automationTemplates,\n    isLoading: rulesLoading || executionsLoading,\n    error: rulesError,\n\n    // Stats\n    ruleStats: getRuleStats(),\n    executionStats: getExecutionStats(),\n\n    // Mutations\n    createRule: createRuleMutation.mutate,\n    updateRule: updateRuleMutation.mutate,\n    deleteRule: deleteRuleMutation.mutate,\n    executeRule: executeRuleMutation.mutate,\n\n    // Actions\n    createRuleFromTemplate,\n    toggleRule,\n    duplicateRule,\n    testRule,\n    validateRule,\n    refetchRules,\n\n    // Status\n    isCreating: createRuleMutation.isPending,\n    isUpdating: updateRuleMutation.isPending,\n    isDeleting: deleteRuleMutation.isPending,\n    isExecuting: executeRuleMutation.isPending,\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\hooks\\useSmartDataValidation.ts","messages":[{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 18 to the 15 allowed.","line":74,"column":82,"nodeType":null,"messageId":"refactorFunction","endLine":74,"endColumn":84},{"ruleId":"sonarjs/no-collapsible-if","severity":2,"message":"Merge this if statement with the nested one.","line":79,"column":7,"nodeType":null,"messageId":"mergeNestedIfStatement","endLine":79,"endColumn":9},{"ruleId":"sonarjs/no-collapsible-if","severity":2,"message":"Merge this if statement with the nested one.","line":96,"column":11,"nodeType":null,"messageId":"mergeNestedIfStatement","endLine":96,"endColumn":13}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Smart data validation hook for unified CRUD operations\n// Provides data validation and sanitization services\n\nimport { useCallback } from 'react';\n\nexport interface ValidationError {\n  field: string;\n  message: string;\n  code?: string;\n}\n\nexport interface ValidationResult {\n  isValid: boolean;\n  errors: ValidationError[];\n  warnings?: ValidationError[] | undefined;\n  autoFixesApplied?: boolean;\n}\n\nexport interface ValidationContext {\n  entityType: string;\n  operation: 'create' | 'update' | 'delete' | 'list' | 'import';\n  data: unknown;\n  timestamp: Date;\n}\n\nconst entityValidationRules: Record<string, (data: Record<string, unknown>) => ValidationError[]> =\n  {\n    farm: data => {\n      const errors: ValidationError[] = [];\n      if (!data['name'] || typeof data['name'] !== 'string') {\n        errors.push({ field: 'name', message: 'Farm name is required', code: 'REQUIRED_FIELD' });\n      }\n      return errors;\n    },\n    field: data => {\n      const errors: ValidationError[] = [];\n      if (!data['name'] || typeof data['name'] !== 'string') {\n        errors.push({ field: 'name', message: 'Field name is required', code: 'REQUIRED_FIELD' });\n      }\n      if (!data['farm_id']) {\n        errors.push({ field: 'farm_id', message: 'Farm ID is required', code: 'REQUIRED_FIELD' });\n      }\n      return errors;\n    },\n    task: data => {\n      const errors: ValidationError[] = [];\n      if (!data['title'] || typeof data['title'] !== 'string') {\n        errors.push({ field: 'title', message: 'Task title is required', code: 'REQUIRED_FIELD' });\n      }\n      return errors;\n    },\n    crop: data => {\n      const errors: ValidationError[] = [];\n      if (!data['name'] || typeof data['name'] !== 'string') {\n        errors.push({ field: 'name', message: 'Crop name is required', code: 'REQUIRED_FIELD' });\n      }\n      return errors;\n    },\n    inventory: data => {\n      const errors: ValidationError[] = [];\n      if (!data['name'] || typeof data['name'] !== 'string') {\n        errors.push({\n          field: 'name',\n          message: 'Inventory item name is required',\n          code: 'REQUIRED_FIELD',\n        });\n      }\n      return errors;\n    },\n  };\n\nexport function useSmartDataValidation() {\n  const validateData = useCallback(\n    async (data: unknown, context: ValidationContext): Promise<ValidationResult> => {\n      const errors: ValidationError[] = [];\n      const warnings: ValidationError[] = [];\n\n      // Basic validation for common data types\n      if (context.operation === 'create' || context.operation === 'update') {\n        if (typeof data === 'object' && data !== null) {\n          const dataObj = data as Record<string, unknown>;\n\n          const rules = entityValidationRules[context.entityType];\n          if (rules) {\n            errors.push(...rules(dataObj));\n          } else {\n            // Generic validation for unknown entity types\n            warnings.push({\n              field: 'general',\n              message: `No specific validation rules for ${context.entityType}`,\n              code: 'NO_VALIDATION_RULES',\n            });\n          }\n\n          // Check for suspicious patterns\n          if (dataObj['name'] && typeof dataObj['name'] === 'string') {\n            if (dataObj['name'].length > 255) {\n              warnings.push({\n                field: 'name',\n                message: 'Name is very long, consider shortening',\n                code: 'LONG_FIELD',\n              });\n            }\n          }\n        }\n      }\n\n      return {\n        isValid: errors.length === 0,\n        errors,\n        warnings: warnings.length > 0 ? warnings : undefined,\n      };\n    },\n    []\n  );\n\n  return {\n    validateData,\n  };\n}\n\nexport default useSmartDataValidation;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\hooks\\useSmartImportExport.ts","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: ':' expected.","line":132,"column":6,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Smart import/export system for comprehensive data management\n// Supports multiple formats, smart parsing, and intelligent data handling\n\nimport { useState, useCallback, useRef } from 'react';\nimport { useSmartDataValidation, ValidationError } from './useSmartDataValidation';\n\nexport type ImportFormat = 'csv' | 'xlsx' | 'json' | 'xml' | 'yaml';\nexport type ExportFormat = 'csv' | 'xlsx' | 'json' | 'pdf' | 'xml';\n\nexport interface ImportOptions {\n  format: ImportFormat;\n  entityType: 'animal' | 'crop' | 'task' | 'inventory' | 'farm' | 'weather';\n  skipHeaderRow?: boolean;\n  encoding?: 'utf-8' | 'iso-8859-1' | 'windows-1252';\n  delimiter?: string;\n  hasHeader?: boolean;\n  dateFormat?: 'ISO' | 'US' | 'EU' | 'Custom';\n  customDateFormat?: string;\n  timezone?: string;\n  validateData?: boolean;\n  autoCorrect?: boolean;\n  batchSize?: number;\n  onProgress?: (progress: ImportProgress) => void;\n}\n\nexport interface ExportOptions {\n  format: ExportFormat;\n  entityType: 'animal' | 'crop' | 'task' | 'inventory' | 'farm' | 'weather';\n  includeHeader?: boolean;\n  dateFormat?: 'ISO' | 'US' | 'EU' | 'Custom';\n  customDateFormat?: string;\n  timezone?: string;\n  selectedFields?: string[];\n  filters?: Record<string, unknown>;\n  template?: boolean;\n  compression?: boolean;\n}\n\nexport interface ImportProgress {\n  total: number;\n  processed: number;\n  success: number;\n  failed: number;\n  currentItem?: unknown;\n  errors: Array<{ row: number; errors: ValidationError[] }>;\n  startTime: Date;\n  endTime?: Date;\n  isComplete: boolean;\n}\n\nexport interface ExportProgress {\n  total: number;\n  processed: number;\n  currentItem?: unknown;\n  startTime: Date;\n  endTime?: Date;\n  isComplete: boolean;\n  downloadUrl?: string;\n}\n\nexport interface SmartMapping {\n  sourceField: string;\n  targetField: string;\n  transformation?: 'none' | 'uppercase' | 'lowercase' | 'title' | 'date' | 'number' | 'boolean';\n  defaultValue?: unknown;\n  required?: boolean;\n  validation?: string; // custom validation rule\n}\n\nexport interface ImportResult {\n  success: boolean;\n  data: unknown[];\n  errors: ImportProgress['errors'];\n  statistics: {\n    totalProcessed: number;\n    successRate: number;\n    commonErrors: Array<{ type: string; count: number; suggestion: string }>;\n    dataQuality: {\n      completeness: number;\n      accuracy: number;\n      consistency: number;\n    };\n  };\n  mappings: SmartMapping[];\n  preview: unknown[];\n}\n\nexport interface ExportResult {\n  success: boolean;\n  downloadUrl?: string;\n  fileName: string;\n  fileSize?: number;\n  recordCount: number;\n  format: ExportFormat;\n}\n\nconst DEFAULT_FIELD_MAPPINGS: Record<string, Record<string, SmartMapping>> = {\n  animal: {\n    Species: { sourceField: 'Species', targetField: 'species', transformation: 'lowercase' },\n    Breed: { sourceField: 'Breed', targetField: 'breed' },\n    Age: { sourceField: 'Age', targetField: 'age', transformation: 'number' },\n    Weight: { sourceField: 'Weight', targetField: 'weight', transformation: 'number' },\n    'Health Status': { sourceField: 'Health Status', targetField: 'health_status' },\n    ID: { sourceField: 'ID', targetField: 'id' },\n    Name: { sourceField: 'Name', targetField: 'name' },\n    Status: { sourceField: 'Status', targetField: 'status' },\n  },\n  crop: {\n    'Crop Type': { sourceField: 'Crop Type', targetField: 'crop_type' },\n    Variety: { sourceField: 'Variety', targetField: 'variety' },\n    'Planting Date': {\n      sourceField: 'Planting Date',\n      targetField: 'planting_date',\n      transformation: 'date',\n    },\n    'Harvest Date': {\n      sourceField: 'Harvest Date',\n      targetField: 'harvest_date',\n      transformation: 'date',\n    },\n    Yield: { sourceField: 'Yield', targetField: 'yield', transformation: 'number' },\n    'Field ID': { sourceField: 'Field ID', targetField: 'field_id' },\n  },\n  task: {\n    Title: { sourceField: 'Title', targetField: 'name' },\n    Description: { sourceField: 'Description', targetField: 'description' },\n    Priority: { sourceField: 'Priority', targetField: 'priority' },\n    Assignee: { sourceField: 'Assignee', targetField: 'assignee' },\n    'Due Date': { sourceField: 'Due Date', targetField: 'due_date', transformation: 'date' },\n    Status: { sourceField: 'Status', targetField: 'status' },\n  },\nconst getErrorSuggestion = (errorType: string): string => {\n  const suggestions: Record<string, string> = {\n    required_field_missing: 'Check that all required fields are provided',\n    schema_validation_error: 'Verify data format matches expected types',\n    date_parsing_error: 'Use ISO date format (YYYY-MM-DD) or specify custom format',\n    number_parsing_error: 'Remove currency symbols and use decimal numbers only',\n  };\n  return suggestions[errorType] || 'Review the data and try again';\n};\n\nconst calculateCompleteness = (data: Record<string, unknown>[]): number => {\n  if (data.length === 0) return 0;\n\n  const totalFields = Object.keys(data[0] as Record<string, unknown>).length;\n  const totalCells = data.length * totalFields;\n  const filledCells = data.reduce((count: number, row: Record<string, unknown>) => {\n    return (\n      count +\n      Object.values(row).filter(value => value !== null && value !== undefined && value !== '')\n        .length\n    );\n  }, 0);\n\n  return Math.round((filledCells / totalCells) * 100);\n};\n\nexport function useSmartImportExport() {\n  const [importProgress, setImportProgress] = useState<ImportProgress | null>(null);\n  const [exportProgress, setExportProgress] = useState<ExportProgress | null>(null);\n  const [isImporting, setIsImporting] = useState(false);\n  const [isExporting, setIsExporting] = useState(false);\n  const [fieldMappings, setFieldMappings] = useState<SmartMapping[]>([]);\n\n  const _fileInputRef = useRef<HTMLInputElement>(null);\n  const { validateData } = useSmartDataValidation();\n\n  // Detect file format from extension\n  const detectFormat = useCallback((fileName: string): ImportFormat => {\n    const extension = fileName.toLowerCase().split('.').pop();\n    switch (extension) {\n      case 'csv':\n        return 'csv';\n      case 'xlsx':\n      case 'xls':\n        return 'xlsx';\n      case 'json':\n        return 'json';\n      case 'xml':\n        return 'xml';\n      case 'yaml':\n      case 'yml':\n        return 'yaml';\n      default:\n        return 'csv';\n    }\n  }, []);\n\n  // Parse CSV file\n  const parseCSV = useCallback((content: string, options: ImportOptions): Promise<unknown[]> => {\n    return new Promise((resolve, reject) => {\n      try {\n        const lines = content.split('\\n').filter(line => line.trim());\n        if (lines.length === 0) {\n          resolve([]);\n          return;\n        }\n\n        const delimiter = options.delimiter || ',';\n        const hasHeader = options.hasHeader !== false;\n        const data: unknown[] = [];\n\n        let headers: string[] = [];\n        let startIndex = 0;\n\n        if (hasHeader) {\n          headers = parseCSVLine(lines[0]!, delimiter);\n          startIndex = 1;\n        } else {\n          // Generate default headers\n          const firstLine = parseCSVLine(lines[0]!, delimiter);\n          headers = firstLine.map((_, index) => `Column_${index + 1}`);\n        }\n\n        for (let i = startIndex; i < lines.length; i++) {\n          const values = parseCSVLine(lines[i]!, delimiter);\n          const row: Record<string, unknown> = {};\n\n          headers.forEach((header, index) => {\n            row[header] = values[index] || '';\n          });\n\n          data.push(row);\n        }\n\n        resolve(data);\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }, []);\n\n  // Parse single CSV line handling quoted values\n  const parseCSVLine = useCallback((line: string, delimiter: string): string[] => {\n    const result: string[] = [];\n    let current = '';\n    let inQuotes = false;\n    let i = 0;\n\n    while (i < line.length) {\n      const char = line[i];\n      const nextChar = line[i + 1];\n\n      if (char === '\"') {\n        if (inQuotes && nextChar === '\"') {\n          current += '\"';\n          i += 2;\n          continue;\n        }\n        inQuotes = !inQuotes;\n      } else if (char === delimiter && !inQuotes) {\n        result.push(current.trim());\n        current = '';\n      } else {\n        current += char;\n      }\n      i++;\n    }\n\n    result.push(current.trim());\n    return result;\n  }, []);\n\n  // Transform field values\n  const transformValue = useCallback(\n    (value: string, transformation: SmartMapping['transformation']): unknown => {\n      if (!value || transformation === 'none') return value;\n\n      switch (transformation) {\n        case 'uppercase':\n          return value.toUpperCase();\n        case 'lowercase':\n          return value.toLowerCase();\n        case 'title':\n          return value.replace(\n            /\\w\\S*/g,\n            txt => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()\n          );\n        case 'number':\n          const num = parseFloat(value.replace(/[^0-9.-]/g, ''));\n          return isNaN(num) ? null : num;\n        case 'boolean':\n          return value.toLowerCase() === 'true' || value === '1' || value.toLowerCase() === 'yes';\n        case 'date':\n          return parseDate(value);\n        default:\n          return value;\n      }\n    },\n    []\n  );\n\n  // Parse date with multiple formats\n  const parseDate = useCallback((dateString: string): Date | null => {\n    if (!dateString) return null;\n\n    // Try ISO format first\n    const isoMatch = dateString.match(/^(\\d{4})-(\\d{2})-(\\d{2})/);\n    if (isoMatch) {\n      const date = new Date(dateString);\n      return isNaN(date.getTime()) ? null : date;\n    }\n\n    // Try common formats\n    const formats = [\n      /^(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})$/, // MM/DD/YYYY or DD/MM/YYYY\n      /^(\\d{1,2})-(\\d{1,2})-(\\d{4})$/, // MM-DD-YYYY or DD-MM-YYYY\n      /^(\\d{4})\\/(\\d{1,2})\\/(\\d{1,2})$/, // YYYY/MM/DD\n    ];\n\n    for (const format of formats) {\n      const match = dateString.match(format);\n      if (match) {\n        let year, month, day;\n\n        if (format.source.includes('YYYY.*MM.*DD')) {\n          year = parseInt(match[1] || '0');\n          month = parseInt(match[2] || '0') - 1; // 0-based month\n          day = parseInt(match[3] || '0');\n        } else {\n          // Assume MM/DD/YYYY format\n          month = parseInt(match[1] || '0') - 1;\n          day = parseInt(match[2] || '0');\n          year = parseInt(match[3] || '0');\n        }\n\n        const date = new Date(year, month, day);\n        return isNaN(date.getTime()) ? null : date;\n      }\n    }\n\n    return null;\n  }, []);\n\n  // Apply field mappings to data\n  const applyMappings = useCallback(\n    (data: unknown[], mappings: SmartMapping[]): unknown[] => {\n      return data.map(row => {\n        const mappedRow: Record<string, unknown> = {};\n\n        mappings.forEach(mapping => {\n          const sourceValue = (row as Record<string, unknown>)[mapping.sourceField];\n          const transformedValue = transformValue(\n            String(sourceValue || ''),\n            mapping.transformation\n          );\n          mappedRow[mapping.targetField] =\n            transformedValue !== undefined ? transformedValue : mapping.defaultValue;\n        });\n\n        return mappedRow;\n      });\n    },\n    [transformValue]\n  );\n\n  // Smart field mapping detection\n  const detectFieldMappings = useCallback((data: unknown[], entityType: string): SmartMapping[] => {\n    const defaultMappings = DEFAULT_FIELD_MAPPINGS[entityType] || {};\n    const detectedMappings: SmartMapping[] = [];\n\n    if (data.length === 0) return detectedMappings;\n\n    const firstRow = data[0];\n    const availableFields = Object.keys(firstRow as Record<string, unknown>);\n\n    // Try to match available fields to target fields\n    availableFields.forEach(sourceField => {\n      // Direct match\n      if (defaultMappings[sourceField]) {\n        detectedMappings.push(defaultMappings[sourceField]);\n        return;\n      }\n\n      // Fuzzy match\n      const targetField = findBestMatch(sourceField, Object.keys(defaultMappings));\n      if (targetField) {\n        detectedMappings.push({\n          sourceField,\n          targetField,\n          transformation: defaultMappings[targetField]?.transformation || 'none',\n        });\n      }\n    });\n\n    return detectedMappings;\n  }, []);\n\n  // Find best matching field name\n  const findBestMatch = useCallback(\n    (sourceField: string, targetFields: string[]): string | null => {\n      const sourceLower = sourceField.toLowerCase().replace(/[\\s_-]/g, '');\n\n      let bestMatch = null;\n      let bestScore = 0;\n\n      for (const targetField of targetFields) {\n        const targetLower = targetField.toLowerCase().replace(/[\\s_-]/g, '');\n\n        // Exact match\n        if (sourceLower === targetLower) {\n          return targetField;\n        }\n\n        // Substring match\n        if (sourceLower.includes(targetLower) || targetLower.includes(sourceLower)) {\n          const score =\n            Math.min(sourceLower.length, targetLower.length) /\n            Math.max(sourceLower.length, targetLower.length);\n          if (score > bestScore) {\n            bestScore = score;\n            bestMatch = targetField;\n          }\n        }\n      }\n\n      return bestScore > 0.6 ? bestMatch : null;\n    },\n    []\n  );\n\n  // Import data from file\n  const importData = useCallback(\n    async (file: File, options: ImportOptions): Promise<ImportResult> => {\n      setIsImporting(true);\n      const startTime = new Date();\n\n      try {\n        // Read file content\n        const content = await readFileContent(file, options.encoding);\n        let rawData: unknown[] = [];\n\n        // Parse based on format\n        switch (options.format) {\n          case 'csv':\n            rawData = await parseCSV(content, options);\n            break;\n          case 'json':\n            rawData = JSON.parse(content);\n            break;\n          case 'xlsx':\n            // Would need xlsx library\n            throw new Error('XLSX parsing not implemented yet');\n          default:\n            throw new Error(`Unsupported format: ${options.format}`);\n        }\n\n        // Detect field mappings\n        const detectedMappings = detectFieldMappings(rawData, options.entityType);\n        const mappings = fieldMappings.length > 0 ? fieldMappings : detectedMappings;\n        setFieldMappings(mappings);\n\n        // Apply mappings\n        const mappedData = applyMappings(rawData, mappings);\n\n        // Initialize progress\n        const progress: ImportProgress = {\n          total: mappedData.length,\n          processed: 0,\n          success: 0,\n          failed: 0,\n          errors: [],\n          startTime,\n          isComplete: false,\n        };\n        setImportProgress(progress);\n\n        // Process in batches\n        const batchSize = options.batchSize || 100;\n        const errors: ImportProgress['errors'] = [];\n        let success = 0;\n        let failed = 0;\n\n        for (let i = 0; i < mappedData.length; i += batchSize) {\n          const batch = mappedData.slice(i, i + batchSize);\n\n          // Process batch\n          for (let j = 0; j < batch.length; j++) {\n            const item = batch[j];\n            const rowIndex = i + j;\n\n            try {\n              let processedItem = { ...(item as Record<string, unknown>) };\n\n              // Add required fields\n              processedItem.id = (item as Record<string, unknown>).id || generateId();\n              processedItem.created_at = (item as Record<string, unknown>).created_at || new Date();\n              processedItem.updated_at = new Date();\n\n              // Validate if requested\n              if (options.validateData) {\n                const validationResult = await validateData(processedItem, {\n                  entityType: options.entityType,\n                  operation: 'import',\n                  data: processedItem,\n                  timestamp: new Date(),\n                });\n\n                if (!validationResult.isValid) {\n                  throw new Error(\n                    `Validation failed: ${validationResult.errors.map(e => e.message).join(', ')}`\n                  );\n                }\n\n                // Apply auto-fixes\n                if (options.autoCorrect && validationResult.autoFixesApplied) {\n                  processedItem = { ...processedItem, ...validationResult };\n                }\n              }\n\n              success++;\n            } catch (error) {\n              failed++;\n              const validationErrors =\n                error instanceof Error\n                  ? [\n                      {\n                        field: 'general',\n                        message: error.message,\n                        code: 'import_error',\n                        severity: 'error' as const,\n                        value: item,\n                      },\n                    ]\n                  : [];\n\n              errors.push({\n                row: rowIndex + 1,\n                errors: validationErrors,\n              });\n            }\n          }\n\n          // Update progress\n          const processed = Math.min(i + batch.length, mappedData.length);\n          progress.processed = processed;\n          progress.success = success;\n          progress.failed = failed;\n          progress.currentItem = batch[batch.length - 1];\n          setImportProgress({ ...progress });\n\n          // Call progress callback\n          if (options.onProgress) {\n            options.onProgress({ ...progress });\n          }\n\n          // Allow UI to update\n          await new Promise(resolve => setTimeout(resolve, 10));\n        }\n\n        // Complete\n        progress.endTime = new Date();\n        progress.isComplete = true;\n        setImportProgress({ ...progress });\n\n        // Calculate and return result\n        return calculateImportResult(mappedData, success, errors, mappings);\n      } catch (error) {\n        // ... same catch logic ...\n        const progress = importProgress;\n        if (progress) {\n          progress.endTime = new Date();\n          progress.isComplete = true;\n          setImportProgress({ ...progress });\n        }\n\n        return {\n          success: false,\n          data: [],\n          errors: [],\n          statistics: {\n            totalProcessed: 0,\n            successRate: 0,\n            commonErrors: [],\n            dataQuality: { completeness: 0, accuracy: 0, consistency: 0 },\n          },\n          mappings: [],\n          preview: [],\n        };\n      } finally {\n        setIsImporting(false);\n      }\n    },\n    [\n      parseCSV,\n      detectFieldMappings,\n      applyMappings,\n      fieldMappings,\n      importProgress,\n      validateData,\n      generateId,\n    ]\n  );\n\n  const calculateImportResult = useCallback(\n    (\n      mappedData: unknown[],\n      success: number,\n      errors: ImportProgress['errors'],\n      mappings: SmartMapping[]\n    ): ImportResult => {\n      const totalProcessed = mappedData.length;\n      const successRate = totalProcessed > 0 ? (success / totalProcessed) * 100 : 0;\n\n      const errorTypes: Record<string, number> = {};\n      errors.forEach(({ errors: rowErrors }) => {\n        rowErrors.forEach(error => {\n          const errorCode = error.code || 'unknown';\n          errorTypes[errorCode] = (errorTypes[errorCode] || 0) + 1;\n        });\n      });\n\n      const commonErrors = Object.entries(errorTypes)\n        .map(([type, count]) => ({\n          type,\n          count,\n          suggestion: getErrorSuggestion(type),\n        }))\n        .sort((a, b) => b.count - a.count)\n        .slice(0, 5);\n\n      return {\n        success: true,\n        data: mappedData.slice(0, success),\n        errors,\n        statistics: {\n          totalProcessed,\n          successRate,\n          commonErrors,\n          dataQuality: {\n            completeness: calculateCompleteness(mappedData as Record<string, unknown>[]),\n            accuracy: 95,\n            consistency: 90,\n          },\n        },\n        mappings,\n        preview: mappedData.slice(0, Math.min(5, mappedData.length)),\n      };\n    },\n    []\n  );\n\n  // Export data to file\n  const exportData = useCallback(\n    async (data: unknown[], options: ExportOptions): Promise<ExportResult> => {\n      setIsExporting(true);\n      const startTime = new Date();\n\n      try {\n        const progress: ExportProgress = {\n          total: data.length,\n          processed: 0,\n          startTime,\n          isComplete: false,\n        };\n        setExportProgress(progress);\n\n        let exportContent: string;\n        let fileName: string;\n        let mimeType: string;\n\n        // Process data based on format\n        const processedData = data.map(item => {\n          const processed = { ...(item as Record<string, unknown>) };\n\n          // Format dates\n          if (options.dateFormat) {\n            Object.keys(processed).forEach(key => {\n              if (processed[key] instanceof Date) {\n                processed[key] = formatDate(processed[key] as Date, options.dateFormat || 'ISO');\n              }\n            });\n          }\n\n          return processed;\n        });\n\n        // Generate content based on format\n        switch (options.format) {\n          case 'csv':\n            exportContent = generateCSV(processedData, options);\n            fileName = `${options.entityType}_export_${new Date().toISOString().split('T')[0]}.csv`;\n            mimeType = 'text/csv';\n            break;\n          case 'json':\n            exportContent = JSON.stringify(processedData, null, 2);\n            fileName = `${options.entityType}_export_${new Date().toISOString().split('T')[0]}.json`;\n            mimeType = 'application/json';\n            break;\n          case 'xlsx':\n            // Would need xlsx library\n            throw new Error('XLSX export not implemented yet');\n          case 'pdf':\n            // Would need PDF generation library\n            throw new Error('PDF export not implemented yet');\n          default:\n            throw new Error(`Unsupported export format: ${options.format}`);\n        }\n\n        // Create and trigger download\n        const blob = new Blob([exportContent], { type: mimeType });\n        const url = URL.createObjectURL(blob);\n\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = fileName;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        URL.revokeObjectURL(url);\n\n        // Complete progress\n        progress.processed = data.length;\n        progress.endTime = new Date();\n        progress.isComplete = true;\n        progress.downloadUrl = url;\n        setExportProgress({ ...progress });\n\n        return {\n          success: true,\n          downloadUrl: url,\n          fileName,\n          fileSize: blob.size,\n          recordCount: data.length,\n          format: options.format,\n        };\n      } catch (error) {\n        const progress = exportProgress;\n        if (progress) {\n          progress.endTime = new Date();\n          progress.isComplete = true;\n          setExportProgress({ ...progress });\n        }\n\n        throw error;\n      } finally {\n        setIsExporting(false);\n      }\n    },\n    []\n  );\n\n  // Generate CSV content\n  const generateCSV = useCallback((data: unknown[], options: ExportOptions): string => {\n    if (data.length === 0) return '';\n\n    const selectedFields =\n      options.selectedFields || Object.keys(data[0] as Record<string, unknown>);\n    const headers = options.includeHeader !== false ? selectedFields : [];\n\n    let csv = '';\n\n    // Add headers\n    if (headers.length > 0) {\n      csv += headers.join(',') + '\\n';\n    }\n\n    // Add data rows\n    data.forEach(item => {\n      const values = selectedFields.map(field => {\n        const value = (item as Record<string, unknown>)[field];\n        if (value === null || value === undefined) return '';\n        if (typeof value === 'string' && (value.includes(',') || value.includes('\"'))) {\n          return `\"${value.replace(/\"/g, '\"\"')}\"`;\n        }\n        return String(value);\n      });\n      csv += values.join(',') + '\\n';\n    });\n\n    return csv;\n  }, []);\n\n  // Format date for export\n  const formatDate = useCallback((date: Date, format: string, customFormat?: string): string => {\n    if (customFormat) {\n      // Basic custom format support\n      return customFormat\n        .replace('YYYY', date.getFullYear().toString())\n        .replace('MM', (date.getMonth() + 1).toString().padStart(2, '0'))\n        .replace('DD', date.getDate().toString().padStart(2, '0'))\n        .replace('HH', date.getHours().toString().padStart(2, '0'))\n        .replace('mm', date.getMinutes().toString().padStart(2, '0'))\n        .replace('ss', date.getSeconds().toString().padStart(2, '0'));\n    }\n\n    switch (format) {\n      case 'ISO':\n        return date.toISOString();\n      case 'US':\n        return `${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getDate().toString().padStart(2, '0')}/${date.getFullYear()}`;\n      case 'EU':\n        return `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;\n      default:\n        return date.toISOString();\n    }\n  }, []);\n\n  // Helper functions\n  const readFileContent = useCallback((file: File, encoding: string = 'utf-8'): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = e => resolve(e.target?.result as string);\n      reader.onerror = () => reject(new Error('Failed to read file'));\n      reader.readAsText(file, encoding);\n    });\n  }, []);\n\n  const generateId = useCallback((): string => {\n    return Date.now().toString(36) + Math.random().toString(36).substr(2);\n  }, []);\n\n  const getErrorSuggestion = useCallback((errorType: string): string => {\n    const suggestions: Record<string, string> = {\n      required_field_missing: 'Check that all required fields are provided',\n      schema_validation_error: 'Verify data format matches expected types',\n      date_parsing_error: 'Use ISO date format (YYYY-MM-DD) or specify custom format',\n      number_parsing_error: 'Remove currency symbols and use decimal numbers only',\n    };\n    return suggestions[errorType] || 'Review the data and try again';\n  }, []);\n\n  const calculateCompleteness = useCallback((data: Record<string, unknown>[]): number => {\n    if (data.length === 0) return 0;\n\n    const totalFields = Object.keys(data[0] as Record<string, unknown>).length;\n    const totalCells = data.length * totalFields;\n    const filledCells = data.reduce((count: number, row: Record<string, unknown>) => {\n      return (\n        count +\n        Object.values(row).filter(value => value !== null && value !== undefined && value !== '')\n          .length\n      );\n    }, 0);\n\n    return Math.round((filledCells / totalCells) * 100);\n  }, []);\n\n  // Reset progress\n  const resetImport = useCallback(() => {\n    setImportProgress(null);\n    setIsImporting(false);\n  }, []);\n\n  const resetExport = useCallback(() => {\n    setExportProgress(null);\n    setIsExporting(false);\n  }, []);\n\n  return {\n    // State\n    importProgress,\n    exportProgress,\n    isImporting,\n    isExporting,\n    fieldMappings,\n\n    // Actions\n    importData,\n    exportData,\n    detectFieldMappings,\n    setFieldMappings,\n    resetImport,\n    resetExport,\n\n    // Utilities\n    detectFormat,\n    parseCSV,\n    transformValue,\n    formatDate,\n  };\n}\n\nexport default useSmartImportExport;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\pages\\Dashboard.tsx","messages":[{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 3 times.","line":49,"column":22,"nodeType":"Literal","messageId":"defineConstant","endLine":49,"endColumn":36}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo, useEffect, useCallback, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  Cloud,\n  Calendar as CalendarIcon,\n  Bell,\n  Settings,\n  Plus,\n  Sprout,\n  Activity,\n  Package,\n  DollarSign,\n  Clock,\n  Menu,\n  X,\n  ChevronRight,\n  AlertCircle,\n  CheckCircle,\n  ChevronDown,\n  Loader2,\n  AlertTriangle,\n  MapPin,\n} from 'lucide-react';\nimport { useFarms } from '../hooks';\nimport { useCrops, useAnimals, useInventory, useTasks, useFinance } from '../hooks';\nimport EnhancedFarmCalendar from '../components/EnhancedFarmCalendar';\nimport WeatherCalendar from '../components/WeatherCalendar';\nimport WeatherAnalytics from '../components/WeatherAnalytics';\nimport ErrorBoundary from '../components/ErrorBoundary';\nimport CropCard from '../components/dashboard/CropCard';\nimport StatCard from '../components/dashboard/StatCard';\nimport type { ColorVariant, TabConfig, BackgroundImageState } from '../types/dashboard';\nimport type { Crop, Animal, Task, InventoryItem, Farm } from '../api';\nimport {\n  colorClasses,\n  formatStatus,\n  getStatusBadgeClasses,\n  getPriorityBadgeClasses,\n  formatDate,\n  isDateValid,\n  isOverdue,\n  loadBackgroundImage,\n  trapFocus,\n  getSelectedFarm,\n  logger,\n} from '../utils/dashboard';\n\nconst TEXT_GREEN_600 = 'text-green-600';\nconst TEXT_RED_600 = 'text-red-600';\nconst TEXT_BLUE_600 = 'text-blue-600';\nconst TEXT_GRAY_600 = 'text-gray-600';\nconst TEXT_GRAY_600_MB_4 = 'text-gray-600 mb-4';\n\nconst TAB_OVERVIEW = 'overview';\n\n// Constants\nconst RECENT_ACTIVITIES_LIMIT = 3;\nconst BACKGROUND_IMAGE_URL = '/lockscreen-wallpaper.jpg'; // Renamed without spaces\n\nexport default function Dashboard() {\n  const navigate = useNavigate();\n  const [activeTab, setActiveTab] = useState<string>(TAB_OVERVIEW);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState<boolean>(false);\n  const [farmSelectorOpen, setFarmSelectorOpen] = useState<boolean>(false);\n  const [selectedFarm, setSelectedFarm] = useState<string>('');\n  const [cropType, setCropType] = useState<string>('wheat');\n  const [backgroundImageState, setBackgroundImageState] = useState<BackgroundImageState>({\n    loaded: false,\n    error: false,\n    url: BACKGROUND_IMAGE_URL,\n  });\n  const farmSelectorRef = useRef<HTMLDivElement>(null);\n\n  // Live data hooks\n  const { data: farms = [], isLoading: farmsLoading, error: farmsError } = useFarms();\n  const { data: crops = [], isLoading: cropsLoading, error: cropsError } = useCrops();\n  const { data: animals = [], isLoading: animalsLoading, error: animalsError } = useAnimals();\n  const {\n    data: inventory = [],\n    isLoading: inventoryLoading,\n    error: inventoryError,\n  } = useInventory();\n  const { data: tasks = [], isLoading: tasksLoading, error: tasksError } = useTasks();\n  const {\n    data: financeEntries = [],\n    isLoading: financeLoading,\n    error: financeError,\n  } = useFinance();\n\n  // Load background image\n  useEffect(() => {\n    loadBackgroundImage(BACKGROUND_IMAGE_URL)\n      .then(loaded => setBackgroundImageState(prev => ({ ...prev, loaded, error: !loaded })))\n      .catch(() => setBackgroundImageState(prev => ({ ...prev, error: true })));\n  }, []);\n\n  // Set default selected farm when farms are loaded\n  useEffect(() => {\n    if (farms.length > 0 && !selectedFarm) {\n      setSelectedFarm(farms[0]?.id || '');\n    }\n  }, [farms, selectedFarm]);\n\n  // Enhanced farm data with proper fallback handling\n  const farmData = useMemo(() => {\n    return getSelectedFarm<Farm>(farms, selectedFarm);\n  }, [farms, selectedFarm]);\n\n  // Focus management for accessibility\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (farmSelectorOpen && farmSelectorRef.current) {\n        trapFocus(farmSelectorRef.current, event);\n      }\n    };\n\n    if (farmSelectorOpen) {\n      document.addEventListener('keydown', handleKeyDown);\n      // Move focus to first element in dropdown\n      setTimeout(() => {\n        const firstFocusable = farmSelectorRef.current?.querySelector(\n          '[tabindex=\"0\"]'\n        ) as HTMLElement;\n        firstFocusable?.focus();\n      }, 100);\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [farmSelectorOpen]);\n\n  // Loading states\n  const isLoading = useMemo(\n    () =>\n      farmsLoading ||\n      cropsLoading ||\n      animalsLoading ||\n      inventoryLoading ||\n      tasksLoading ||\n      financeLoading,\n    [farmsLoading, cropsLoading, animalsLoading, inventoryLoading, tasksLoading, financeLoading]\n  );\n\n  // Error states\n  const hasError = useMemo(\n    () => farmsError || cropsError || animalsError || inventoryError || tasksError || financeError,\n    [farmsError, cropsError, animalsError, inventoryError, tasksError, financeError]\n  );\n\n  // Enhanced stats with proper type handling\n  const cropStats = useMemo(\n    () => ({\n      total: crops.length,\n      active: crops.filter((c: Crop) => c.status === 'growing').length,\n      healthy: crops.filter((c: Crop) => c.health_status === 'healthy').length,\n      needsAttention: crops.filter((c: Crop) => c.health_status !== 'healthy').length,\n    }),\n    [crops]\n  );\n\n  const animalStats = useMemo(\n    () => ({\n      total: animals.length,\n      active: animals.filter((a: Animal) => a.status === 'active').length,\n      sold: animals.filter((a: Animal) => a.status === 'sold').length,\n      deceased: animals.filter((a: Animal) => a.status === 'deceased').length,\n    }),\n    [animals]\n  );\n\n  const inventoryStats = useMemo(\n    () => ({\n      total: inventory.length,\n      lowStock: inventory.filter(\n        (i: InventoryItem) => i.reorder_level && i.quantity < i.reorder_level\n      ).length,\n      totalValue: inventory.reduce(\n        (sum: number, item: InventoryItem) => sum + item.quantity * (item.cost_per_unit || 0),\n        0\n      ),\n    }),\n    [inventory]\n  );\n\n  // Fixed date validation using proper isNaN checks\n  const taskStats = useMemo(\n    () => ({\n      pending: tasks.filter((t: Task) => t.status === 'pending').length,\n      overdue: tasks.filter((t: Task) => {\n        return !isDateValid(t.due_date) ? false : isOverdue(t.due_date, t.status);\n      }).length,\n      inProgress: tasks.filter((t: Task) => t.status === 'in_progress').length,\n    }),\n    [tasks]\n  );\n\n  const financeStats = useMemo(\n    () => ({\n      income: financeEntries\n        .filter((f: any) => f.type === 'income' || f.entry_type === 'income')\n        .reduce((sum: number, f: any) => sum + Math.abs(f.amount), 0),\n      expenses: financeEntries\n        .filter((f: any) => f.type === 'expense' || f.entry_type === 'expense')\n        .reduce((sum: number, f: any) => sum + Math.abs(f.amount), 0),\n      netBalance: financeEntries.reduce((sum: number, f: any) => sum + f.amount, 0),\n    }),\n    [financeEntries]\n  );\n\n  // Keyboard navigation handler\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        setFarmSelectorOpen(false);\n        setMobileMenuOpen(false);\n      }\n    };\n\n    if (farmSelectorOpen || mobileMenuOpen) {\n      document.addEventListener('keydown', handleEscape);\n      return () => document.removeEventListener('keydown', handleEscape);\n    }\n\n    return undefined;\n  }, [farmSelectorOpen, mobileMenuOpen]);\n\n  // Memoized tab configuration\n  const tabs: TabConfig[] = useMemo(\n    () => [\n      { id: TAB_OVERVIEW, label: 'Overview', icon: Activity },\n      { id: 'crops', label: 'Crops', icon: Sprout, count: cropStats.total },\n      { id: 'animals', label: 'Animals', icon: Activity, count: animalStats.active },\n      { id: 'tasks', label: 'Tasks', icon: CalendarIcon, count: taskStats.pending },\n      { id: 'weather', label: 'Weather Calendar', icon: Cloud },\n    ],\n    [cropStats.total, animalStats.active, taskStats.pending]\n  );\n\n  // Handlers with proper cleanup\n  const handleFarmSelect = useCallback((farmId: string) => {\n    setSelectedFarm(farmId);\n    setFarmSelectorOpen(false);\n  }, []);\n\n  const handleTabChange = useCallback((tabId: string) => {\n    setActiveTab(tabId);\n    setMobileMenuOpen(false);\n  }, []);\n\n  // Event handlers - removed console.logs for production\n  const handleEventClick = useCallback((event: unknown) => {\n    // Use logger utility for development logging\n    logger.debug('Event clicked:', event);\n  }, []);\n\n  const handleCreateEvent = useCallback((date: string) => {\n    // EnhancedFarmCalendar passes ISO date strings; parse if needed\n    logger.debug('Create event for:', date);\n  }, []);\n\n  const handleOperationClick = useCallback((operationId: string) => {\n    logger.debug('Operation clicked:', operationId);\n  }, []);\n\n  // Loading spinner\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-green-50 to-blue-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"h-12 w-12 animate-spin text-green-600 mx-auto mb-4\" />\n          <p className=\"text-lg font-medium text-gray-700\">Loading your farm dashboard...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Error state\n  if (hasError) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-green-50 to-blue-50 flex items-center justify-center\">\n        <div className=\"text-center max-w-md mx-auto p-6\">\n          <AlertTriangle className=\"h-12 w-12 text-red-500 mx-auto mb-4\" />\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Error Loading Data</h2>\n          <p className={TEXT_GRAY_600_MB_4}>\n            We&apos;re having trouble loading your dashboard data. Please check your connection and\n            try again.\n          </p>\n          <div className=\"space-y-3\">\n            <button\n              onClick={() => window.location.reload()}\n              className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors w-full\"\n            >\n              Retry Loading Data\n            </button>\n          </div>\n          <div className=\"mt-4 p-3 bg-red-50 rounded-lg text-left\">\n            <p className=\"text-xs text-red-700 font-medium\">Error Details:</p>\n            <p className=\"text-xs text-red-600 mt-1\">\n              Data loading error - please check your connection\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // No farms available\n  if (farms.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-green-50 to-blue-50 flex items-center justify-center\">\n        <div className=\"text-center max-w-md mx-auto p-6\">\n          <Sprout className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\n            Welcome to Your Farm Dashboard\n          </h2>\n          <p className={TEXT_GRAY_600_MB_4}>\n            You don&apos;t have any farms yet. Create your first farm to get started with crop\n            management, animal tracking, and more.\n          </p>\n          <button\n            onClick={() => navigate('/farms')}\n            className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2 mx-auto\"\n          >\n            <Plus className=\"h-4 w-4\" />\n            <span>Add Your First Farm</span>\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <ErrorBoundary>\n      <div\n        className=\"min-h-screen bg-gradient-to-br from-gray-50 via-green-50 to-blue-50 bg-cover bg-center bg-fixed relative\"\n        style={\n          backgroundImageState.loaded\n            ? {\n                backgroundImage: `url('${BACKGROUND_IMAGE_URL}')`,\n                backgroundBlendMode: 'overlay',\n              }\n            : {}\n        }\n      >\n        {/* Wallpaper overlay for better readability */}\n        <div className=\"absolute inset-0 bg-white/70 backdrop-blur-[0.5px]\"></div>\n\n        {/* Modern Mobile Header */}\n        <header className=\"sticky top-0 z-50 bg-white/80 backdrop-blur-lg border-b border-gray-200 shadow-sm\">\n          <div className=\"px-4 py-3\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-3\">\n                <button\n                  onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n                  className=\"lg:hidden p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n                  aria-label=\"Toggle mobile menu\"\n                  aria-expanded={mobileMenuOpen}\n                >\n                  {mobileMenuOpen ? <X className=\"h-6 w-6\" /> : <Menu className=\"h-6 w-6\" />}\n                </button>\n                <div>\n                  <h1 className=\"text-lg sm:text-xl font-bold text-gray-900\">\n                    {farmData?.name || 'Select Farm'}\n                  </h1>\n                  <p className=\"text-xs sm:text-sm text-gray-600 hidden sm:block\">\n                    {farmData?.location || 'Farm Location'}\n                  </p>\n                </div>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"relative\" ref={farmSelectorRef}>\n                  <button\n                    onClick={() => setFarmSelectorOpen(!farmSelectorOpen)}\n                    className=\"flex items-center space-x-2 px-3 py-2 hover:bg-gray-100 rounded-lg transition-colors\"\n                    aria-label=\"Select farm\"\n                    aria-expanded={farmSelectorOpen}\n                    aria-haspopup=\"listbox\"\n                    tabIndex={0}\n                  >\n                    <Sprout className=\"h-5 w-5 text-green-600\" />\n                    <span className=\"hidden sm:inline text-sm font-medium text-gray-700\">\n                      {farmData?.name || 'Select Farm'}\n                    </span>\n                    <ChevronDown className=\"h-4 w-4 text-gray-500\" />\n                  </button>\n\n                  {farmSelectorOpen && (\n                    <>\n                      <div\n                        className=\"fixed inset-0 z-40\"\n                        onClick={() => setFarmSelectorOpen(false)}\n                        aria-hidden=\"true\"\n                      ></div>\n                      <div\n                        className=\"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50\"\n                        role=\"listbox\"\n                        aria-label=\"Farm selection\"\n                      >\n                        {farms.map(farm => (\n                          <button\n                            key={farm.id}\n                            onClick={() => handleFarmSelect(farm.id)}\n                            className={`w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors ${\n                              selectedFarm === farm.id ? 'bg-green-50' : ''\n                            }`}\n                            role=\"option\"\n                            aria-selected={selectedFarm === farm.id}\n                            tabIndex={0}\n                          >\n                            <div className=\"flex items-center space-x-3\">\n                              <div\n                                className={`p-2 rounded-lg ${\n                                  selectedFarm === farm.id ? 'bg-green-100' : 'bg-gray-100'\n                                }`}\n                              >\n                                <Sprout\n                                  className={`h-4 w-4 ${\n                                    selectedFarm === farm.id ? TEXT_GREEN_600 : TEXT_GRAY_600\n                                  }`}\n                                />\n                              </div>\n                              <div className=\"flex-1 min-w-0\">\n                                <p\n                                  className={`text-sm font-medium truncate ${\n                                    selectedFarm === farm.id ? 'text-green-900' : 'text-gray-900'\n                                  }`}\n                                >\n                                  {farm.name}\n                                </p>\n                                <p className=\"text-xs text-gray-500 truncate\">{farm.location}</p>\n                              </div>\n                              {selectedFarm === farm.id && (\n                                <CheckCircle\n                                  className={`h-4 w-4 ${TEXT_GREEN_600} flex-shrink-0`}\n                                />\n                              )}\n                            </div>\n                          </button>\n                        ))}\n                        <div className=\"border-t border-gray-200 mt-1 pt-1\">\n                          <button\n                            onClick={() => {\n                              setFarmSelectorOpen(false);\n                              navigate('/farms');\n                            }}\n                            className=\"w-full px-4 py-2 text-left text-sm text-green-600 hover:bg-green-50 transition-colors flex items-center space-x-2\"\n                            tabIndex={0}\n                          >\n                            <Plus className=\"h-4 w-4\" />\n                            <span>Add New Farm</span>\n                          </button>\n                        </div>\n                      </div>\n                    </>\n                  )}\n                </div>\n                <button className=\"relative p-2 hover:bg-gray-100 rounded-lg transition-colors\">\n                  <Bell className=\"h-5 w-5 text-gray-700\" />\n                  <span className=\"absolute top-1 right-1 h-2 w-2 bg-red-500 rounded-full\"></span>\n                </button>\n                <button className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\">\n                  <Settings className=\"h-5 w-5 text-gray-700\" />\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Mobile Navigation Menu */}\n          {mobileMenuOpen && (\n            <div className=\"lg:hidden border-t border-gray-200 bg-white\">\n              <nav className=\"px-4 py-3 space-y-1\">\n                {tabs.map(tab => (\n                  <button\n                    key={tab.id}\n                    onClick={() => handleTabChange(tab.id)}\n                    className={`w-full flex items-center justify-between px-4 py-3 rounded-lg transition-all ${\n                      activeTab === tab.id\n                        ? 'bg-green-50 text-green-700 font-medium'\n                        : 'text-gray-700 hover:bg-gray-50'\n                    }`}\n                  >\n                    <div className=\"flex items-center space-x-3\">\n                      <tab.icon className=\"h-5 w-5\" />\n                      <span>{tab.label}</span>\n                    </div>\n                    {tab.count !== undefined && (\n                      <span className=\"px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full\">\n                        {tab.count}\n                      </span>\n                    )}\n                  </button>\n                ))}\n              </nav>\n            </div>\n          )}\n\n          {/* Desktop Navigation Tabs */}\n          <div className=\"hidden lg:block border-t border-gray-200\">\n            <nav className=\"flex space-x-1 px-4 overflow-x-auto\">\n              {tabs.map(tab => (\n                <button\n                  key={tab.id}\n                  onClick={() => handleTabChange(tab.id)}\n                  className={`flex items-center space-x-2 px-4 py-3 border-b-2 font-medium text-sm whitespace-nowrap transition-all ${\n                    activeTab === tab.id\n                      ? `border-green-500 ${TEXT_GREEN_600}`\n                      : `border-transparent ${TEXT_GRAY_600} hover:text-gray-900 hover:border-gray-300`\n                  }`}\n                >\n                  <tab.icon className=\"h-4 w-4\" />\n                  <span>{tab.label}</span>\n                  {tab.count !== undefined && (\n                    <span className=\"px-2 py-0.5 bg-gray-100 text-gray-700 text-xs font-medium rounded-full\">\n                      {tab.count}\n                    </span>\n                  )}\n                </button>\n              ))}\n            </nav>\n          </div>\n        </header>\n\n        <main className=\"max-w-7xl mx-auto px-4 py-4 sm:py-6 space-y-4 sm:space-y-6\">\n          {activeTab === TAB_OVERVIEW && (\n            <>\n              {/* Quick Stats Grid */}\n              <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4\">\n                <StatCard\n                  icon={Sprout}\n                  label=\"Crops\"\n                  value={cropStats.total}\n                  sublabel={`${cropStats.active} active`}\n                  color=\"green\"\n                  onClick={() => setActiveTab('crops')}\n                />\n                <StatCard\n                  icon={Activity}\n                  label=\"Animals\"\n                  value={animalStats.total}\n                  sublabel={`${animalStats.active} active`}\n                  color=\"blue\"\n                  onClick={() => setActiveTab('animals')}\n                />\n                <StatCard\n                  icon={Package}\n                  label=\"Inventory\"\n                  value={inventoryStats.total}\n                  sublabel={`${inventoryStats.lowStock} low stock`}\n                  color=\"orange\"\n                  onClick={() => navigate('/inventory')}\n                />\n                <StatCard\n                  icon={CalendarIcon}\n                  label=\"Tasks\"\n                  value={taskStats.pending}\n                  sublabel={`${taskStats.overdue} overdue`}\n                  color=\"purple\"\n                  onClick={() => setActiveTab('tasks')}\n                />\n              </div>\n\n              {/* Finance Overview Card */}\n              <div className=\"bg-gradient-to-br from-emerald-500 to-green-600 rounded-xl p-5 sm:p-6 shadow-lg text-white\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <h3 className=\"text-lg sm:text-xl font-semibold\">Financial Overview</h3>\n                  <DollarSign className=\"h-6 w-6 opacity-80\" />\n                </div>\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <div>\n                    <p className=\"text-emerald-100 text-xs sm:text-sm\">Income</p>\n                    <p className=\"text-xl sm:text-2xl font-bold mt-1\">\n                      ${financeStats.income.toFixed(0)}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-emerald-100 text-xs sm:text-sm\">Expenses</p>\n                    <p className=\"text-xl sm:text-2xl font-bold mt-1\">\n                      ${financeStats.expenses.toFixed(0)}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-emerald-100 text-xs sm:text-sm\">Balance</p>\n                    <p className=\"text-xl sm:text-2xl font-bold mt-1\">\n                      ${financeStats.netBalance.toFixed(0)}\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Recent Activities */}\n              <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\n                <div className=\"px-4 sm:px-6 py-4 border-b border-gray-100\">\n                  <h3 className=\"text-base sm:text-lg font-semibold text-gray-900\">\n                    Recent Activities\n                  </h3>\n                </div>\n                <div className=\"divide-y divide-gray-100\">\n                  {tasks.slice(0, RECENT_ACTIVITIES_LIMIT).map((task: Task) => (\n                    <div\n                      key={task.id}\n                      className=\"px-4 sm:px-6 py-4 hover:bg-gray-50 transition-colors\"\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center space-x-3 flex-1 min-w-0\">\n                          <div\n                            className={`p-2 rounded-lg ${\n                              task.priority === 'urgent' ? 'bg-red-50' : 'bg-blue-50'\n                            }`}\n                          >\n                            <CalendarIcon\n                              className={`h-4 w-4 ${\n                                task.priority === 'urgent' ? TEXT_RED_600 : TEXT_BLUE_600\n                              }`}\n                            />\n                          </div>\n                          <div className=\"flex-1 min-w-0\">\n                            <p className=\"font-medium text-gray-900 text-sm sm:text-base truncate\">\n                              {task.title}\n                            </p>\n                            <p className=\"text-xs sm:text-sm text-gray-500\">\n                              Due: {formatDate(task.due_date)}\n                            </p>\n                          </div>\n                        </div>\n                        <ChevronRight className=\"h-5 w-5 text-gray-400 flex-shrink-0 ml-2\" />\n                      </div>\n                    </div>\n                  ))}\n                  {tasks.length === 0 && (\n                    <div className=\"px-4 sm:px-6 py-8 text-center\">\n                      <CalendarIcon className=\"h-8 w-8 text-gray-300 mx-auto mb-2\" />\n                      <p className=\"text-gray-500\">No tasks yet</p>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Quick Actions */}\n              <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3\">\n                {[\n                  { icon: Plus, label: 'Add Crop', color: 'green' as ColorVariant },\n                  { icon: Activity, label: 'Log Activity', color: 'blue' as ColorVariant },\n                  { icon: Package, label: 'Update Stock', color: 'orange' as ColorVariant },\n                  { icon: DollarSign, label: 'Add Transaction', color: 'emerald' as ColorVariant },\n                ].map((action, idx) => (\n                  <button\n                    key={idx}\n                    className=\"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-all active:scale-95 flex flex-col items-center space-y-2\"\n                  >\n                    <div className={`p-3 rounded-full ${colorClasses[action.color].bg}`}>\n                      <action.icon className={`h-5 w-5 ${colorClasses[action.color].icon}`} />\n                    </div>\n                    <span className=\"text-xs sm:text-sm font-medium text-gray-700 text-center\">\n                      {action.label}\n                    </span>\n                  </button>\n                ))}\n              </div>\n            </>\n          )}\n\n          {activeTab === 'crops' && (\n            <>\n              {/* Crops Header */}\n              <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0\">\n                <h2 className=\"text-xl sm:text-2xl font-bold text-gray-900\">Crop Management</h2>\n                <button className=\"bg-green-600 text-white px-4 py-2.5 rounded-lg font-medium shadow-sm hover:bg-green-700 transition-colors flex items-center justify-center space-x-2\">\n                  <Plus className=\"h-5 w-5\" />\n                  <span>Add Crop</span>\n                </button>\n              </div>\n\n              {/* Crop Stats */}\n              <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4\">\n                <StatCard label=\"Total\" value={cropStats.total} icon={Sprout} color=\"green\" />\n                <StatCard label=\"Active\" value={cropStats.active} icon={Activity} color=\"blue\" />\n                <StatCard\n                  label=\"Healthy\"\n                  value={cropStats.healthy}\n                  icon={CheckCircle}\n                  color=\"emerald\"\n                />\n                <StatCard\n                  label=\"Alert\"\n                  value={cropStats.needsAttention}\n                  icon={AlertCircle}\n                  color=\"amber\"\n                />\n              </div>\n\n              {/* Crops List */}\n              <div className=\"space-y-3\">\n                {crops.map(crop => (\n                  <CropCard\n                    key={crop.id}\n                    crop={crop}\n                    onViewDetails={() => logger.debug('View crop details:', crop.id)}\n                    onAction={() => logger.debug('Crop action:', crop.id)}\n                  />\n                ))}\n                {crops.length === 0 && (\n                  <div className=\"text-center py-12\">\n                    <Sprout className=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\n                    <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No Crops Yet</h3>\n                    <p className={TEXT_GRAY_600_MB_4}>\n                      Start tracking your crops to monitor growth and health\n                    </p>\n                    <button className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2 mx-auto\">\n                      <Plus className=\"h-4 w-4\" />\n                      <span>Add Your First Crop</span>\n                    </button>\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n\n          {activeTab === 'animals' && (\n            <>\n              {/* Animals Header */}\n              <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0\">\n                <h2 className=\"text-xl sm:text-2xl font-bold text-gray-900\">Animal Management</h2>\n                <button className=\"bg-blue-600 text-white px-4 py-2.5 rounded-lg font-medium shadow-sm hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2\">\n                  <Plus className=\"h-5 w-5\" />\n                  <span>Add Animal</span>\n                </button>\n              </div>\n\n              {/* Animal Stats */}\n              <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4\">\n                <StatCard label=\"Total\" value={animalStats.total} icon={Activity} color=\"blue\" />\n                <StatCard\n                  label=\"Active\"\n                  value={animalStats.active}\n                  icon={CheckCircle}\n                  color=\"green\"\n                />\n                <StatCard label=\"Sold\" value={animalStats.sold} icon={DollarSign} color=\"orange\" />\n                <StatCard\n                  label=\"Deceased\"\n                  value={animalStats.deceased}\n                  icon={AlertCircle}\n                  color=\"red\"\n                />\n              </div>\n\n              {/* Animals List */}\n              <div className=\"space-y-3\">\n                {animals.map(animal => (\n                  <div\n                    key={animal.id}\n                    className=\"bg-white rounded-xl p-4 sm:p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow\"\n                  >\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <div className=\"flex items-center space-x-3\">\n                        <div className=\"p-2 bg-blue-50 rounded-lg\">\n                          <Activity className=\"h-5 w-5 text-blue-600\" />\n                        </div>\n                        <div>\n                          <h4 className=\"font-semibold text-gray-900 text-sm sm:text-base\">\n                            {animal.identification_tag || animal.name}\n                          </h4>\n                          <p className=\"text-xs sm:text-sm text-gray-600\">{animal.species}</p>\n                        </div>\n                      </div>\n                      <span\n                        className={`px-2 py-1 text-xs font-medium rounded-full ${getStatusBadgeClasses(animal.status, 'animal')}`}\n                      >\n                        {formatStatus(animal.status)}\n                      </span>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-3 text-xs sm:text-sm\">\n                      <div>\n                        <span className=\"text-gray-500\">Breed:</span>\n                        <p className=\"font-medium text-gray-900\">\n                          {animal.breed || 'Not specified'}\n                        </p>\n                      </div>\n                      <div>\n                        <span className=\"text-gray-500\">Acquired:</span>\n                        <p className=\"font-medium text-gray-900\">\n                          {formatDate(animal.acquisition_date)}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex gap-2 mt-4\">\n                      <button className=\"flex-1 bg-gray-50 text-gray-700 px-3 py-2 rounded-lg text-sm font-medium hover:bg-gray-100 transition-colors\">\n                        View Details\n                      </button>\n                      <button className=\"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors\">\n                        <Activity className=\"h-4 w-4\" />\n                      </button>\n                    </div>\n                  </div>\n                ))}\n                {animals.length === 0 && (\n                  <div className=\"text-center py-12\">\n                    <Activity className=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\n                    <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No Animals Yet</h3>\n                    <p className={TEXT_GRAY_600_MB_4}>\n                      Start tracking your livestock to monitor health and production\n                    </p>\n                    <button className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2 mx-auto\">\n                      <Plus className=\"h-4 w-4\" />\n                      <span>Add Your First Animal</span>\n                    </button>\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n\n          {activeTab === 'weather' && (\n            <div className=\"space-y-6\">\n              {/* Weather Header */}\n              <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0\">\n                <h2 className=\"text-xl sm:text-2xl font-bold text-gray-900\">Weather & Calendar</h2>\n                <div className=\"flex space-x-3\">\n                  <button className=\"bg-blue-600 text-white px-4 py-2.5 rounded-lg font-medium shadow-sm hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2\">\n                    <MapPin className=\"h-5 w-5\" />\n                    <span>Update Location</span>\n                  </button>\n                  <button className=\"bg-green-600 text-white px-4 py-2.5 rounded-lg font-medium shadow-sm hover:bg-green-700 transition-colors flex items-center justify-center space-x-2\">\n                    <Plus className=\"h-5 w-5\" />\n                    <span>Add Event</span>\n                  </button>\n                </div>\n              </div>\n\n              {/* Dynamic crop type selection */}\n              <div className=\"bg-white rounded-xl p-4 shadow-sm border border-gray-100\">\n                <label\n                  htmlFor=\"crop-type-select\"\n                  className=\"block text-sm font-medium text-gray-700 mb-2\"\n                >\n                  Crop Type for Analytics:\n                </label>\n                <select\n                  id=\"crop-type-select\"\n                  value={cropType}\n                  onChange={e => setCropType(e.target.value)}\n                  className=\"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-green-500 focus:border-green-500\"\n                >\n                  <option value=\"wheat\">Wheat</option>\n                  <option value=\"corn\">Corn</option>\n                  <option value=\"soybean\">Soybean</option>\n                  <option value=\"rice\">Rice</option>\n                </select>\n              </div>\n\n              {/* Weather Analytics with dynamic crop type */}\n              {farmData && <WeatherAnalytics farmId={farmData.id} cropType={cropType} />}\n\n              {/* Enhanced Farm Calendar */}\n              {farmData && (\n                <ErrorBoundary>\n                  <EnhancedFarmCalendar\n                    farmId={farmData.id}\n                    onEventClick={handleEventClick}\n                    onCreateEvent={handleCreateEvent}\n                  />\n                </ErrorBoundary>\n              )}\n\n              {/* Weather Calendar */}\n              {farmData && (\n                <ErrorBoundary>\n                  <WeatherCalendar\n                    farmId={farmData.id}\n                    operations={tasks.map((task: Task) => ({\n                      id: task.id,\n                      title: task.title,\n                      scheduled_date: task.due_date,\n                      type: task.task_type,\n                      status: task.status,\n                    }))}\n                    onOperationClick={handleOperationClick}\n                  />\n                </ErrorBoundary>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'tasks' && (\n            <>\n              {/* Tasks Header */}\n              <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0\">\n                <h2 className=\"text-xl sm:text-2xl font-bold text-gray-900\">Task Management</h2>\n                <button className=\"bg-purple-600 text-white px-4 py-2.5 rounded-lg font-medium shadow-sm hover:bg-purple-700 transition-colors flex items-center justify-center space-x-2\">\n                  <Plus className=\"h-5 w-5\" />\n                  <span>Add Task</span>\n                </button>\n              </div>\n\n              {/* Task Stats */}\n              <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4\">\n                <StatCard label=\"Pending\" value={taskStats.pending} icon={Clock} color=\"yellow\" />\n                <StatCard\n                  label=\"In Progress\"\n                  value={taskStats.inProgress}\n                  icon={Activity}\n                  color=\"blue\"\n                />\n                <StatCard\n                  label=\"Overdue\"\n                  value={taskStats.overdue}\n                  icon={AlertCircle}\n                  color=\"red\"\n                />\n                <StatCard label=\"Total\" value={tasks.length} icon={CheckCircle} color=\"green\" />\n              </div>\n\n              {/* Tasks List */}\n              <div className=\"space-y-3\">\n                {tasks.map((task: Task) => (\n                  <div\n                    key={task.id}\n                    className=\"bg-white rounded-xl p-4 sm:p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow\"\n                  >\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <div className=\"flex items-center space-x-3\">\n                        <div\n                          className={`p-2 rounded-lg ${\n                            task.priority === 'urgent'\n                              ? 'bg-red-50'\n                              : task.priority === 'high'\n                                ? 'bg-orange-50'\n                                : task.priority === 'normal'\n                                  ? 'bg-blue-50'\n                                  : 'bg-gray-50'\n                          }`}\n                        >\n                          <CalendarIcon\n                            className={`h-4 w-4 ${\n                              task.priority === 'urgent'\n                                ? 'text-red-600'\n                                : task.priority === 'high'\n                                  ? 'text-orange-600'\n                                  : task.priority === 'normal'\n                                    ? TEXT_BLUE_600\n                                    : TEXT_GRAY_600\n                            }`}\n                          />\n                        </div>\n                        <div>\n                          <h4 className=\"font-semibold text-gray-900 text-sm sm:text-base\">\n                            {task.title}\n                          </h4>\n                          <p className=\"text-xs text-gray-600\">{task.task_type}</p>\n                        </div>\n                      </div>\n                      <span\n                        className={`px-2 py-1 text-xs font-medium rounded-full ${getStatusBadgeClasses(task.status, 'task')}`}\n                      >\n                        {formatStatus(task.status)}\n                      </span>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-3 text-xs sm:text-sm\">\n                      <div>\n                        <span className=\"text-gray-500\">Due:</span>\n                        <p\n                          className={`font-medium ${\n                            isOverdue(task.due_date, task.status) ? 'text-red-600' : 'text-gray-900'\n                          }`}\n                        >\n                          {formatDate(task.due_date)}\n                        </p>\n                      </div>\n                      <div>\n                        <span className=\"text-gray-500\">Priority:</span>\n                        <p className={`font-medium ${getPriorityBadgeClasses(task.priority)}`}>\n                          {formatStatus(task.priority)}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex gap-2 mt-4\">\n                      <button className=\"flex-1 bg-gray-50 text-gray-700 px-3 py-2 rounded-lg text-sm font-medium hover:bg-gray-100 transition-colors\">\n                        View Details\n                      </button>\n                      <button className=\"px-4 py-2 bg-purple-50 text-purple-700 rounded-lg hover:bg-purple-100 transition-colors\">\n                        <Clock className=\"h-4 w-4\" />\n                      </button>\n                    </div>\n                  </div>\n                ))}\n                {tasks.length === 0 && (\n                  <div className=\"text-center py-12\">\n                    <CalendarIcon className=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\n                    <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No Tasks Yet</h3>\n                    <p className={TEXT_GRAY_600_MB_4}>\n                      Create your first task to start organizing your farm work\n                    </p>\n                    <button className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2 mx-auto\">\n                      <Plus className=\"h-4 w-4\" />\n                      <span>Create Your First Task</span>\n                    </button>\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n        </main>\n\n        {/* Mobile Bottom Navigation */}\n        <nav className=\"lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg\">\n          <div className=\"grid grid-cols-5 gap-1 px-2 py-2\">\n            {tabs.map(tab => (\n              <button\n                key={tab.id}\n                onClick={() => handleTabChange(tab.id)}\n                className={`flex flex-col items-center justify-center py-2 px-1 rounded-lg transition-all ${\n                  activeTab === tab.id ? `bg-green-50 ${TEXT_GREEN_600}` : TEXT_GRAY_600\n                }`}\n              >\n                <div className=\"relative\">\n                  <tab.icon className=\"h-5 w-5\" />\n                  {tab.count !== undefined && tab.count > 0 && (\n                    <span className=\"absolute -top-1 -right-1 h-4 w-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center\">\n                      {tab.count > 9 ? '9+' : tab.count}\n                    </span>\n                  )}\n                </div>\n                <span className=\"text-xs font-medium mt-1\">{tab.label}</span>\n              </button>\n            ))}\n          </div>\n        </nav>\n\n        {/* Spacing for mobile bottom nav */}\n        <div className=\"lg:hidden h-20\"></div>\n      </div>\n    </ErrorBoundary>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\pages\\FieldsPage.tsx","messages":[{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed.","line":47,"column":17,"nodeType":null,"messageId":"refactorFunction","endLine":47,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * FIELDS PAGE\n * ===========\n * Centralized Field Management Page\n */\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useState, useEffect } from 'react';\nimport { useAuth } from '../hooks/AuthContext';\nimport { apiClient } from '../hooks';\nimport { Breadcrumbs } from '../components/Breadcrumbs';\nimport { Plus, MapPin, Activity, TrendingUp, Leaf, Droplets } from 'lucide-react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../components/ui/card';\nimport { Button } from '../components/ui/button';\nimport { Badge } from '../components/ui/badge';\nimport { apiEndpoints } from '../config/env';\nimport type { Field, Farm, ApiResponse } from '../api/types';\nimport { FieldFormDataInternal, SoilAnalysisData } from '../types/ui';\nimport { FieldMap } from '../components/fields/FieldMap';\nimport { UnifiedModal, ModalField } from '../components/ui/UnifiedModal';\nimport { useConfirmation, ConfirmDialogs } from '../components/ui/ConfirmationDialog';\nimport { LoadingErrorContent } from '../components/ui/LoadingStates';\n\nconst ACTIVE_VIEW_CLASS = 'bg-green-600 text-white';\nconst INACTIVE_VIEW_CLASS = 'bg-white text-gray-700';\n\n// --- Helpers ---\n\nfunction getFirstFarm(farms: Farm[] | undefined): Farm | null {\n  if (!farms || farms.length === 0) return null;\n  return farms[0] || null;\n}\n\nfunction isApiResponse<T>(payload: unknown): payload is ApiResponse<T> {\n  return (\n    typeof payload === 'object' &&\n    payload !== null &&\n    'data' in (payload as Record<string, unknown>)\n  );\n}\n\nfunction unwrapResponse<T>(payload: ApiResponse<T> | T): T {\n  return isApiResponse<T>(payload) ? (payload.data as T) : (payload as T);\n}\n\n// --- Page Component ---\n\nexport function FieldsPage() {\n  const { isAuthenticated } = useAuth();\n  const queryClient = useQueryClient();\n  const { confirm, ConfirmationDialog } = useConfirmation();\n\n  // State\n  const [showCreateForm, setShowCreateForm] = useState(false);\n  const [editingField, setEditingField] = useState<Field | null>(null);\n  const [viewMode, setViewMode] = useState<'grid' | 'analytics' | 'soil' | 'map'>('grid');\n  const [selectedFieldId, setSelectedFieldId] = useState<number | null>(null);\n  const [selectedFarmId, setSelectedFarmId] = useState<string>('');\n\n  // Queries\n  const { data: farms, isLoading: farmsLoading } = useQuery<Farm[]>({\n    queryKey: ['farms'],\n    queryFn: async () => {\n      const response = await apiClient.get<ApiResponse<Farm[]>>(apiEndpoints.farms.list);\n      return unwrapResponse(response.data) || [];\n    },\n    enabled: isAuthenticated(),\n  });\n\n  const {\n    data: fields,\n    isLoading: fieldsLoading,\n    error: fieldsError,\n  } = useQuery<Field[]>({\n    queryKey: ['fields', selectedFarmId, 'enhanced'],\n    queryFn: async () => {\n      if (!selectedFarmId) return [];\n      const response = await apiClient.get<ApiResponse<Field[]>>(apiEndpoints.fields.list, {\n        params: { analytics: true, farm_id: selectedFarmId },\n      });\n      return unwrapResponse(response) || [];\n    },\n    enabled: isAuthenticated() && !!selectedFarmId,\n  });\n\n  const { data: soilAnalysis } = useQuery<SoilAnalysisData[]>({\n    queryKey: ['soil-analysis', selectedFieldId],\n    queryFn: async () => {\n      if (!selectedFieldId) return [];\n      const response = await apiClient.get<ApiResponse<SoilAnalysisData[]>>(\n        apiEndpoints.fields.soilAnalysis,\n        { params: { field_id: selectedFieldId } }\n      );\n      return unwrapResponse(response) || [];\n    },\n    enabled: isAuthenticated() && selectedFieldId !== null && viewMode === 'soil',\n  });\n\n  // Effects\n  useEffect(() => {\n    const firstFarm = getFirstFarm(farms);\n    if (firstFarm && !selectedFarmId) {\n      setSelectedFarmId(firstFarm.id.toString());\n    }\n  }, [farms, selectedFarmId]);\n\n  // Mutations\n  const createFieldMutation = useMutation({\n    mutationFn: (data: FieldFormDataInternal) =>\n      apiClient.post<ApiResponse<Field>>(\n        apiEndpoints.fields.create,\n        data as unknown as Record<string, unknown>\n      ),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['fields'] });\n      setShowCreateForm(false);\n    },\n  });\n\n  const updateFieldMutation = useMutation({\n    mutationFn: ({ id, ...data }: FieldFormDataInternal & { id: number }) =>\n      apiClient.put<ApiResponse<Field>>(apiEndpoints.fields.update(id.toString()), { id, ...data }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['fields'] });\n      setEditingField(null);\n    },\n  });\n\n  const deleteFieldMutation = useMutation({\n    mutationFn: (fieldId: number) =>\n      apiClient.delete(apiEndpoints.fields.delete(fieldId.toString())),\n    onSuccess: () => queryClient.invalidateQueries({ queryKey: ['fields'] }),\n  });\n\n  // Handlers\n  const handleCreateField = (data: any) => createFieldMutation.mutate(data);\n  const handleUpdateField = (data: any) => {\n    if (editingField) {\n      updateFieldMutation.mutate({ id: parseInt(editingField.id), ...data });\n    }\n  };\n\n  const handleDeleteField = async (field: Field) => {\n    const confirmed = await confirm(ConfirmDialogs.delete(field.name));\n    if (confirmed) {\n      deleteFieldMutation.mutate(parseInt(field.id));\n    }\n  };\n\n  if (!isAuthenticated()) {\n    return <div className=\"flex items-center justify-center min-h-screen\">Use login required</div>;\n  }\n\n  const isLoading = farmsLoading || fieldsLoading;\n\n  // Prepare Modal Fields\n  const fieldFormFields: ModalField[] = [\n    {\n      name: 'farm_id',\n      label: 'Farm',\n      type: 'select',\n      required: true,\n      options: farms?.map(f => ({ value: f.id.toString(), label: f.name })),\n    },\n    { name: 'name', label: 'Field Name', type: 'text', required: true },\n    { name: 'area_hectares', label: 'Area (ha)', type: 'number', step: '0.01' },\n    { name: 'soil_type', label: 'Soil Type', type: 'text' },\n    { name: 'crop_type', label: 'Current Crop', type: 'text' },\n    { name: 'irrigation_system', label: 'Irrigation System', type: 'text' },\n    { name: 'drainage_quality', label: 'Drainage Quality', type: 'text' },\n    { name: 'notes', label: 'Notes', type: 'textarea' },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"bg-white border-b\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n          <Breadcrumbs className=\"mb-0\" />\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Header & Controls */}\n        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Field Management</h1>\n            <p className=\"text-gray-600 mt-1\">Monitor and optimize your field operations</p>\n          </div>\n\n          <div className=\"flex flex-wrap gap-2\">\n            {farms && (\n              <select\n                value={selectedFarmId}\n                onChange={e => setSelectedFarmId(e.target.value)}\n                className=\"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500\"\n              >\n                <option value=\"\">Select Farm</option>\n                {farms.map(f => (\n                  <option key={f.id} value={f.id}>\n                    {f.name}\n                  </option>\n                ))}\n              </select>\n            )}\n\n            <div className=\"flex rounded-md shadow-sm\">\n              <button\n                onClick={() => setViewMode('grid')}\n                className={`px-4 py-2 text-sm font-medium rounded-l-lg border ${viewMode === 'grid' ? ACTIVE_VIEW_CLASS : INACTIVE_VIEW_CLASS}`}\n              >\n                Grid\n              </button>\n              <button\n                onClick={() => setViewMode('map')}\n                className={`px-4 py-2 text-sm font-medium border-t border-b ${viewMode === 'map' ? ACTIVE_VIEW_CLASS : INACTIVE_VIEW_CLASS}`}\n              >\n                Map\n              </button>\n              <button\n                onClick={() => setViewMode('analytics')}\n                className={`px-4 py-2 text-sm font-medium border-t border-b ${viewMode === 'analytics' ? ACTIVE_VIEW_CLASS : INACTIVE_VIEW_CLASS}`}\n              >\n                Analytics\n              </button>\n              <button\n                onClick={() => setViewMode('soil')}\n                className={`px-4 py-2 text-sm font-medium rounded-r-lg border ${viewMode === 'soil' ? ACTIVE_VIEW_CLASS : INACTIVE_VIEW_CLASS}`}\n              >\n                Soil\n              </button>\n            </div>\n\n            <Button\n              onClick={() => setShowCreateForm(true)}\n              className=\"bg-green-600 hover:bg-green-700\"\n            >\n              <Plus className=\"h-4 w-4 mr-2\" /> Add Field\n            </Button>\n          </div>\n        </div>\n\n        {/* Content */}\n        <LoadingErrorContent\n          isLoading={isLoading}\n          error={fieldsError}\n          loadingMessage=\"Loading fields...\"\n          onRetry={() => queryClient.invalidateQueries({ queryKey: ['fields'] })}\n          empty={!isLoading && !fieldsError && (!fields || fields.length === 0)}\n          emptyTitle=\"No fields found\"\n          emptyDescription=\"Get started by creating your first field for this farm.\"\n          emptyAction={\n            <Button onClick={() => setShowCreateForm(true)} variant=\"outline\">\n              Create Field\n            </Button>\n          }\n          emptyIcon={<MapPin className=\"h-12 w-12 text-gray-300\" />}\n        >\n          {/* Grid View */}\n          {viewMode === 'grid' && fields && (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {fields.map(field => (\n                <Card key={field.id} className=\"hover:shadow-lg transition-shadow\">\n                  <CardHeader>\n                    <div className=\"flex justify-between items-start\">\n                      <div>\n                        <CardTitle>{field.name}</CardTitle>\n                        <CardDescription>{field.farm_name}</CardDescription>\n                      </div>\n                      <Badge variant=\"outline\">{field.area_hectares} ha</Badge>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-4\">\n                      <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                        <div>\n                          <span className=\"font-medium\">Crop:</span> {field.crop_type || 'None'}\n                        </div>\n                        <div>\n                          <span className=\"font-medium\">Soil:</span> {field.soil_type || 'Unknown'}\n                        </div>\n                      </div>\n                      <div className=\"flex gap-2 pt-2\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          className=\"flex-1\"\n                          onClick={() => setEditingField(field)}\n                        >\n                          Edit\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          className=\"flex-1 text-red-600 hover:bg-red-50\"\n                          onClick={() => handleDeleteField(field)}\n                        >\n                          Delete\n                        </Button>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n\n          {/* Map View */}\n          {viewMode === 'map' && fields && (\n            <FieldMap\n              fields={fields}\n              selectedFieldId={selectedFieldId?.toString() || null}\n              onSelectField={f => setSelectedFieldId(parseInt(f.id))}\n            />\n          )}\n\n          {/* Analytics View */}\n          {viewMode === 'analytics' && (\n            <div className=\"text-center py-12 bg-white rounded-lg border border-dashed\">\n              <TrendingUp className=\"h-12 w-12 mx-auto text-gray-300 mb-2\" />\n              <p className=\"text-gray-500\">Advanced Analytics Module Coming Soon</p>\n            </div>\n          )}\n\n          {/* Soil View */}\n          {viewMode === 'soil' && (\n            <div className=\"space-y-4\">\n              {!selectedFieldId ? (\n                <div className=\"text-center py-12 bg-white rounded-lg border border-dashed\">\n                  <Droplets className=\"h-12 w-12 mx-auto text-blue-300 mb-2\" />\n                  <p className=\"text-gray-500\">\n                    Select a field from the map or grid to view soil analysis\n                  </p>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {soilAnalysis?.map((analysis, i) => (\n                    <Card key={i}>\n                      <CardHeader>\n                        <CardTitle className=\"text-sm\">\n                          Analysis: {new Date(analysis.analysis_date).toLocaleDateString()}\n                        </CardTitle>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"space-y-2 text-sm\">\n                          <div className=\"flex justify-between\">\n                            <span>pH:</span> <span>{analysis.ph_level}</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <span>Nitrogen:</span> <span>{analysis.nitrogen_content} ppm</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <span>Moisture:</span> <span>{analysis.soil_moisture}%</span>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                  {(!soilAnalysis || soilAnalysis.length === 0) && (\n                    <div className=\"col-span-full text-center py-8 text-gray-500\">\n                      No soil data available\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n        </LoadingErrorContent>\n\n        {/* Unified Modals */}\n        <UnifiedModal\n          isOpen={showCreateForm || !!editingField}\n          onClose={() => {\n            setShowCreateForm(false);\n            setEditingField(null);\n          }}\n          title={editingField ? 'Edit Field' : 'Register New Field'}\n          fields={fieldFormFields}\n          initialData={\n            editingField\n              ? {\n                  ...editingField,\n                  farm_id: editingField.farm_id, // Ensure ID mismatch is handled if necessary\n                }\n              : { farm_id: selectedFarmId }\n          }\n          onSubmit={editingField ? handleUpdateField : handleCreateField}\n          isLoading={createFieldMutation.isPending || updateFieldMutation.isPending}\n        />\n\n        {ConfirmationDialog}\n      </div>\n    </div>\n  );\n}\n\nexport default FieldsPage;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\pages\\LoginPage.tsx","messages":[{"ruleId":"jsx-a11y/no-autofocus","severity":2,"message":"The autoFocus prop should not be used, as it can reduce usability and accessibility for users.","line":104,"column":17,"nodeType":"JSXAttribute","endLine":104,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { useAuth } from '../hooks/AuthContext';\nimport {\n  Container,\n  Box,\n  Card,\n  CardContent,\n  TextField,\n  Button,\n  Typography,\n  Alert,\n  CircularProgress,\n  Avatar,\n  useTheme,\n} from '@mui/material';\nimport { Agriculture } from '@mui/icons-material';\n\nexport function LoginPage() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const { signIn } = useAuth();\n  const navigate = useNavigate();\n  const theme = useTheme();\n\n  const handleEmailChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setEmail(e.target.value);\n  };\n\n  const handlePasswordChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setPassword(e.target.value);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n\n    const { error: authError } = await signIn(email, password);\n\n    if (authError) {\n      setError(authError as any);\n      setLoading(false);\n    } else {\n      navigate('/dashboard');\n    }\n  };\n\n  return (\n    <Box\n      sx={{\n        minHeight: '100vh',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        bgcolor: 'background.default',\n        py: 4,\n      }}\n    >\n      <Container maxWidth=\"sm\">\n        <Card\n          sx={{\n            boxShadow: 3,\n            borderRadius: 2,\n            overflow: 'hidden',\n          }}\n        >\n          <CardContent sx={{ p: { xs: 4, md: 6 } }}>\n            <Box textAlign=\"center\" mb={4}>\n              <Avatar\n                sx={{\n                  bgcolor: 'primary.main',\n                  width: 64,\n                  height: 64,\n                  mx: 'auto',\n                  mb: 2,\n                }}\n              >\n                <Agriculture fontSize=\"large\" />\n              </Avatar>\n              <Typography\n                variant=\"h4\"\n                component=\"h1\"\n                sx={{ fontWeight: 600, color: 'text.primary' }}\n              >\n                Login to Farmers Boot\n              </Typography>\n              <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                Sign in to access your farm management dashboard\n              </Typography>\n            </Box>\n\n            <Box component=\"form\" onSubmit={handleSubmit} noValidate>\n              <TextField\n                margin=\"normal\"\n                required\n                fullWidth\n                id=\"email\"\n                label=\"Email Address\"\n                name=\"email\"\n                autoComplete=\"email\"\n                autoFocus\n                value={email}\n                onChange={handleEmailChange}\n                disabled={loading}\n                data-testid=\"login-email\"\n                sx={{ mb: 2 }}\n              />\n              <TextField\n                margin=\"normal\"\n                required\n                fullWidth\n                name=\"password\"\n                label=\"Password\"\n                type=\"password\"\n                id=\"password\"\n                autoComplete=\"current-password\"\n                value={password}\n                onChange={handlePasswordChange}\n                disabled={loading}\n                data-testid=\"login-password\"\n                sx={{ mb: 3 }}\n              />\n\n              {error && (\n                <Alert severity=\"error\" sx={{ mb: 3 }} data-testid=\"login-error\">\n                  {error}\n                </Alert>\n              )}\n\n              <Button\n                type=\"submit\"\n                fullWidth\n                variant=\"contained\"\n                size=\"large\"\n                disabled={loading}\n                sx={{\n                  mb: 3,\n                  py: 1.5,\n                  bgcolor: 'grey.900',\n                  '&:hover': { bgcolor: 'grey.800' },\n                }}\n                data-testid=\"login-submit-button\"\n              >\n                {loading ? (\n                  <Box display=\"flex\" alignItems=\"center\" gap={1}>\n                    <CircularProgress size={20} color=\"inherit\" />\n                    Logging in...\n                  </Box>\n                ) : (\n                  'Login'\n                )}\n              </Button>\n\n              <Box textAlign=\"center\">\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  <Link\n                    to=\"/forgot-password\"\n                    style={{ textDecoration: 'none', color: theme.palette.primary.main }}\n                    data-testid=\"forgot-password-link\"\n                  >\n                    Forgot your password?\n                  </Link>\n                </Typography>\n              </Box>\n            </Box>\n\n            <Box textAlign=\"center\" mt={4}>\n              <Typography variant=\"body2\" color=\"text.secondary\">\n                Don&apos;t have an account?{' '}\n                <Link\n                  to=\"/signup\"\n                  style={{\n                    textDecoration: 'none',\n                    color: theme.palette.primary.main,\n                    fontWeight: 600,\n                  }}\n                  data-testid=\"signup-link\"\n                >\n                  Sign up\n                </Link>\n              </Typography>\n            </Box>\n          </CardContent>\n        </Card>\n      </Container>\n    </Box>\n  );\n}\n\nexport default LoginPage;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\pages\\SignupPage.tsx","messages":[{"ruleId":"jsx-a11y/no-autofocus","severity":2,"message":"The autoFocus prop should not be used, as it can reduce usability and accessibility for users.","line":120,"column":17,"nodeType":"JSXAttribute","endLine":120,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { useAuth } from '../hooks/AuthContext';\nimport {\n  Container,\n  Box,\n  Card,\n  CardContent,\n  TextField,\n  Button,\n  Typography,\n  Alert,\n  CircularProgress,\n  Avatar,\n  useTheme,\n} from '@mui/material';\nimport { Agriculture } from '@mui/icons-material';\n\nexport function SignupPage() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [name, setName] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const { signUp } = useAuth();\n  const navigate = useNavigate();\n  const theme = useTheme();\n\n  const handleNameChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setName(e.target.value);\n  };\n\n  const handleEmailChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setEmail(e.target.value);\n  };\n\n  const handlePasswordChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setPassword(e.target.value);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!name.trim() || !email.trim() || !password.trim()) {\n      setError('All fields are required');\n      return;\n    }\n\n    if (password.length < 6) {\n      setError('Password must be at least 6 characters');\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n\n    const { error: signupError } = await signUp(email, password, name);\n\n    if (signupError) {\n      setError(signupError as any);\n      setLoading(false);\n    } else {\n      // User is already logged in, redirect to farms\n      navigate('/farms');\n    }\n  };\n\n  return (\n    <Box\n      sx={{\n        minHeight: '100vh',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        bgcolor: 'background.default',\n        py: 4,\n      }}\n    >\n      <Container maxWidth=\"sm\">\n        <Card\n          sx={{\n            boxShadow: 3,\n            borderRadius: 2,\n            overflow: 'hidden',\n          }}\n        >\n          <CardContent sx={{ p: { xs: 4, md: 6 } }}>\n            <Box textAlign=\"center\" mb={4}>\n              <Avatar\n                sx={{\n                  bgcolor: 'primary.main',\n                  width: 64,\n                  height: 64,\n                  mx: 'auto',\n                  mb: 2,\n                }}\n              >\n                <Agriculture fontSize=\"large\" />\n              </Avatar>\n              <Typography\n                variant=\"h4\"\n                component=\"h1\"\n                sx={{ fontWeight: 600, color: 'text.primary' }}\n              >\n                Sign up for Farmers Boot\n              </Typography>\n              <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                Create your account to start managing your farm\n              </Typography>\n            </Box>\n\n            <Box component=\"form\" onSubmit={handleSubmit} noValidate>\n              <TextField\n                margin=\"normal\"\n                required\n                fullWidth\n                id=\"name\"\n                label=\"Full Name\"\n                name=\"name\"\n                autoComplete=\"name\"\n                autoFocus\n                value={name}\n                onChange={handleNameChange}\n                disabled={loading}\n                data-testid=\"signup-name\"\n                sx={{ mb: 2 }}\n              />\n              <TextField\n                margin=\"normal\"\n                required\n                fullWidth\n                id=\"email\"\n                label=\"Email Address\"\n                name=\"email\"\n                autoComplete=\"email\"\n                value={email}\n                onChange={handleEmailChange}\n                disabled={loading}\n                data-testid=\"signup-email\"\n                sx={{ mb: 2 }}\n              />\n              <TextField\n                margin=\"normal\"\n                required\n                fullWidth\n                name=\"password\"\n                label=\"Password\"\n                type=\"password\"\n                id=\"password\"\n                autoComplete=\"new-password\"\n                helperText=\"Password must be at least 6 characters\"\n                value={password}\n                onChange={handlePasswordChange}\n                disabled={loading}\n                data-testid=\"signup-password\"\n                sx={{ mb: 3 }}\n              />\n\n              {error && (\n                <Alert severity=\"error\" sx={{ mb: 3 }} data-testid=\"signup-error\">\n                  {error}\n                </Alert>\n              )}\n\n              <Button\n                type=\"submit\"\n                fullWidth\n                variant=\"contained\"\n                size=\"large\"\n                disabled={loading}\n                sx={{\n                  mb: 3,\n                  py: 1.5,\n                  bgcolor: 'grey.900',\n                  '&:hover': { bgcolor: 'grey.800' },\n                }}\n                data-testid=\"signup-submit-button\"\n              >\n                {loading ? (\n                  <Box display=\"flex\" alignItems=\"center\" gap={1}>\n                    <CircularProgress size={20} color=\"inherit\" />\n                    Signing up...\n                  </Box>\n                ) : (\n                  'Sign up'\n                )}\n              </Button>\n            </Box>\n\n            <Box textAlign=\"center\">\n              <Typography variant=\"body2\" color=\"text.secondary\">\n                Already have an account?{' '}\n                <Link\n                  to=\"/login\"\n                  style={{\n                    textDecoration: 'none',\n                    color: theme.palette.primary.main,\n                    fontWeight: 600,\n                  }}\n                  data-testid=\"login-link\"\n                >\n                  Login\n                </Link>\n              </Typography>\n            </Box>\n          </CardContent>\n        </Card>\n      </Container>\n    </Box>\n  );\n}\n\nexport default SignupPage;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\MunyaradziGangayi\\Documents\\Coder\\Retry\\frontend\\src\\services\\aiService.ts","messages":[{"ruleId":"sonarjs/no-duplicate-string","severity":2,"message":"Define a constant instead of duplicating this literal 4 times.","line":78,"column":57,"nodeType":"Literal","messageId":"defineConstant","endLine":78,"endColumn":81}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// AI Service for Frontend\n// Handles communication with AI endpoints\n\nimport { API_CONFIG, STORAGE_KEYS } from '../api/config';\n\nexport interface AIInsightRequest {\n  prompt: string;\n  context?: Record<string, any>;\n}\n\nexport interface CropAnalysisRequest {\n  cropData: {\n    type: string;\n    growthStage: string;\n    plantingDate: string;\n    healthStatus: string;\n  };\n  weatherData?: Record<string, any>;\n}\n\nexport interface LivestockAdviceRequest {\n  livestockData: {\n    type: string;\n    count: number;\n    healthStatus: string;\n    feedSchedule: string;\n    lastCheckup: string;\n  };\n}\n\nexport interface TaskSchedulingRequest {\n  tasks: Array<{\n    id: string;\n    title: string;\n    priority: string;\n    estimatedDuration: number;\n    dependencies?: string[];\n  }>;\n  priorities?: Record<string, any>;\n}\n\nexport interface AIResponse {\n  success: boolean;\n  response?: string;\n  error?: string;\n  fallbackResponse?: string;\n  model?: string;\n  usage?: Record<string, any>;\n}\n\nclass AIService {\n  private baseUrl: string;\n\n  constructor() {\n    this.baseUrl = `${API_CONFIG.baseUrl}/ai`;\n  }\n\n  async generateInsights(request: AIInsightRequest): Promise<AIResponse> {\n    try {\n      const response = await fetch(`${this.baseUrl}/insights`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${this.getAuthToken()}`,\n        },\n        body: JSON.stringify(request),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      console.error('AI Insights Error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error occurred',\n        fallbackResponse: 'AI service temporarily unavailable. Please try again later.',\n      };\n    }\n  }\n\n  async analyzeCropData(request: CropAnalysisRequest): Promise<AIResponse> {\n    try {\n      const response = await fetch(`${this.baseUrl}/crop-analysis`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${this.getAuthToken()}`,\n        },\n        body: JSON.stringify(request),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      console.error('Crop Analysis Error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error occurred',\n        fallbackResponse: 'Crop analysis service temporarily unavailable.',\n      };\n    }\n  }\n\n  async getLivestockAdvice(request: LivestockAdviceRequest): Promise<AIResponse> {\n    try {\n      const response = await fetch(`${this.baseUrl}/livestock-advice`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${this.getAuthToken()}`,\n        },\n        body: JSON.stringify(request),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      console.error('Livestock Advice Error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error occurred',\n        fallbackResponse: 'Livestock advice service temporarily unavailable.',\n      };\n    }\n  }\n\n  async generateTaskSchedule(request: TaskSchedulingRequest): Promise<AIResponse> {\n    try {\n      const response = await fetch(`${this.baseUrl}/task-scheduling`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${this.getAuthToken()}`,\n        },\n        body: JSON.stringify(request),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      console.error('Task Scheduling Error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error occurred',\n        fallbackResponse: 'Task scheduling service temporarily unavailable.',\n      };\n    }\n  }\n\n  private getAuthToken(): string {\n    // Get token from localStorage or context\n    return localStorage.getItem(STORAGE_KEYS.authToken) || '';\n  }\n\n  // Helper method for common farm insights\n  async getGeneralFarmAdvice(farmData: {\n    crops?: any[];\n    livestock?: any[];\n    currentSeason: string;\n    location: string;\n  }): Promise<AIResponse> {\n    const prompt = `Provide comprehensive farm management advice for:\n    - Location: ${farmData.location}\n    - Season: ${farmData.currentSeason}\n    - Crops: ${farmData.crops?.length || 0} types\n    - Livestock: ${farmData.livestock?.length || 0} types\n    \n    Focus on seasonal best practices, risk management, and optimization opportunities.`;\n\n    return this.generateInsights({\n      prompt,\n      context: farmData,\n    });\n  }\n}\n\nexport const aiService = new AIService();\nexport default aiService;\n","usedDeprecatedRules":[]}]
